IEEE TRANSACTIONS ON WIRELESS COMMUNICATIONS, VOL. 20, NO. 8, AUGUST 2021 4843 Ultra-Dense LEO Satellite Constellations: How Many LEO Satellites Do We Need? Ruoqi Deng , Graduate Student Member, IEEE, Boya Di , Member, IEEE, Hongliang Zhang , Member, IEEE, Linling Kuang , Member, IEEE, and Lingyang Song , Fellow, IEEE

satellite constellation over high-frequency band has served as a potential solution for high-capacity backhaul data services. In this paper, we consider an ultra-dense LEO-based terrestrialsatellite network where terrestrial users can access the network through the LEO-assisted backhaul. We aim to minimize the number of satellites in the constellation while satisfying the backhaul requirement of each user terminal (UT). We Ô¨Årst derive the average total backhaul capacity of each UT, based on which a three-dimensional constellation optimization algorithm is proposed to minimize the number of satellites in the constellation.

show that for any given coverage ratio requirement, the corresponding optimized LEO satellite constellation can be obtained by the proposed three-dimensional constellation optimization algorithm. Given the same number of deployed LEO satellites, the average coverage ratio of the proposed LEO satellite constellation is at least 10 percentage points higher than that of Telesat constellation. Index Terms‚ÄîUltra-dense LEO satellite network, LEO satellite constellations, number minimization.

ity analysis and reveal the inÔ¨Çuence of the backhaul requirement and global coverage ratio requirement on the minimum number of LEO satellites. The stability of the proposed optimized LEO satellite constellation has also been veriÔ¨Åed. Moreover, it shows that compared with the Telesat constellation and the OneWeb constellation, the proposed LEO satellite constellation can meet the backhaul requirement with a lower cost of LEO satellite deployment. The rest of this paper is organized as follows. In Section II, the ultra-dense LEO satellite constellation topology is presented. In Section III, we introduce the communication model for LEO-based backhaul and analyze the interference of the UT-satellite link, based on which the average total backhaul capacity of each UT is derived. In Section IV, we formulate a seamless global coverage problem while considering the backhaul capacity requirement of each UT to minimize the number of LEO satellites. A three-dimensional constellation optimization algorithm to solve such a problem is designed.

coordinate of each satellite can be given by ‚éõ ‚éù xs ys zs ‚éû ‚é†=(h+Re) ‚éõ ‚éù cos(œâ+ŒΩ) cosŒ©‚àísin(œâ+ŒΩ) cosi sin Œ© cos(œâ+ŒΩ) sin Œ©+sin(œâ+ŒΩ) cos i cosŒ© sin(œâ + ŒΩ) sin i ‚éû ‚é†, (1) where Re is the radius of the Earth. B. Orbital Period For convenience, we divide the timeline into multiple time slots with length ŒîT , during each of which the position of a

in , the orbital period, i.e., the time during which the mean anomaly changes by 2œÄ, is 2œÄ(h+Re) 3 2 ‚àöGMe , where G is the gravitational constant and Me is the value of the Earth‚Äôs mass. Therefore, the number of time slots required for each revolution can be given by T = 2œÄ(h + Re) 3 2 ŒîT ‚àöGMe . (2) Since T indicates how many time slots are required for each revolution, T is an integer.6 6Since the value of ŒîT is artiÔ¨Åcially set, we can choose a proper value for ŒîT to guarantee that T is an integer. Authorized licensed use limited to: Tsinghua University. Downloaded on August 29,2024 at 22:13:35 UTC from IEEE Xplore.  Restrictions apply. 4846 IEEE TRANSACTIONS ON WIRELESS COMMUNICATIONS, VOL. 20, NO. 8, AUGUST 2021 Fig. 3. The coverage area of a satellite. Note that all the satellites will be in the same positions after T time slots. We only need to consider the time window containing T time slots, denoted by T = {0, . . . , T ‚àí1}. In time slot t, we can derive the position of satellite m in orbit n from (1) by setting Œ© = Œ©n, i = in, and œâ = œâm n + 2œÄt/T, t ‚ààT . C. Satellite Coverage The coverage area served by a satellite is dependent on the line-of-sight (LoS) propagation and the minimum elevation angle Œ∏min at the UT. As shown in Fig. 3, the satellite is operating on the orbit with altitude h. The coverage of the satellite decreases with the minimum elevation angle. Assuming that the surface of the Earth is an ideal sphere, the included angle œï from the point with the minimum elevation to the projection point of the satellite, i.e., the angular radius of the coverage circle can be calculated by œï = arccos  Re Re + h cos Œ∏min  ‚àíŒ∏min, (3) and the coverage area S is S = 2œÄR2 e(1 ‚àícos œï). (4) Therefore, a higher altitude can provide larger coverage. Besides, a larger value of Œ∏min implies the decrease in the coverage. III. LEO-BASED BACKHAUL CAPACITY ANALYSIS In this section, we Ô¨Årst introduce the communication models for LEO-based backhaul. We then present the interference analysis of UT-satellite links, based on which the average data rate of each UT-satellite link is derived. Finally, we give the average backhaul capacity of each UT. A. Communication Model for LEO-Based Backhaul In the ultra-dense LEO-based terrestrial-satellite network, each terrestrial user can access the UT with a large backhaul capacity supported by the satellite transmission over Ka-band. Each UT uploads the users‚Äô data to the LEO satellite, and then the satellite forwards it to a terrestrial base station equipped with a communication interface over Ka-band (connected to the core network). The backhaul capacity of each UT is related to the transmission model of the LEO satellite over Ka-band, as given below. In the following, we give the backhaul capacity over time slot t. For notation brevity, we omit index t. DeÔ¨Åne P as the transmit power for a UT associating with one LEO satellite, and gm,q as the channel gains of the UT q - satellite m link with only the large-scale fading taken into consideration.7 Therefore, the channel gain can be expressed as gm,q = Gd‚àíŒ± m,q, (5) where dm,q is the distance between UT q and satellite m, Œ± is the path loss exponent, G is the constant power gains factor

in , the distance dm,q can be given by dm,q = ‚àíRe sin Œ∏m,q +  (Re sin Œ∏m,q)2 + h2 + 2hRe, (6) where Œ∏m,q is the elevation angle of UT q with respect to satellite m. Without loss of generality, we assume that all satellites share the same frequency resource pool, which can be divided into J orthogonal channels. Each satellite allocates orthogonal frequency resources to UTs within its coverage for backhaul. Denote the number of UTs in the coverage of satellite m as xm, the data rate for the link from UT q to satellite m can then be given by Rm,q = B xm log2  1 + Pgm,q œÉ2 + Im,q  , (7) where œÉ2 is the additive white Gaussian noise (AWGN) variance at each LEO satellite and Im,q is the interference of UT q - satellite m link. DeÔ¨Åne the set of satellites which can provide service to UT q as Sq = {m|Œ∏m ‚â•Œ∏min}, where Œ∏m is the elevation angle of satellite m. The total backhaul capacity of UT q can then be given by Cq =

m‚ààSq Rm,q. (8) 7It is common to consider large-scale fading in LEO satellite networks , . On the one hand, the distance between the UT and LEO satellite is long enough such that the inÔ¨Çuence of the motion of LEO satellites on the distance can be neglected in a short time. On the other hand, since the channel state information outdates frequently due to the long propagation delay of the UT-satellite link, the large-scale fading has a major impact on the change in signal strength, while the inÔ¨Çuence of the small-scale fading can be neglected. Besides, we consider LEO satellite constellation design satisfying the backhaul requirement of the UT and providing seamless global coverage over a very long period, which has low real-time requirements. The inÔ¨Çuence of smallscale fading is averaged out, and thus, the small-scale fading is not taken into account. Authorized licensed use limited to: Tsinghua University. Downloaded on August 29,2024 at 22:13:35 UTC from IEEE Xplore.  Restrictions apply. DENG et al.: ULTRA-DENSE LEO SATELLITE CONSTELLATIONS: HOW MANY LEO SATELLITES DO WE NEED? 4847 Fig. 4. Initial LEO satellite constellation deployment. B. Interference Analysis Without loss of generality, we assume that the UTs are distributed according to a homogeneous Poisson point process (HPPP) Œ¶ with density Œª UTs/km2. Since the LEO satellites allocate subchannels to UTs randomly, the possibility that other UTs occupy the same subchannel of UT q is 1 J . Therefore, the interference of UT q - satellite m link can be given by Im,q = P

q‚Ä≤‚ààŒ¶‚Ä≤ gm,q‚Ä≤ = PG

q‚Ä≤‚ààŒ¶‚Ä≤ d‚àíŒ± m,q‚Ä≤, (9) where Œ¶‚Ä≤ is a thinning homogeneous PPP of Œ¶ with density Œª J . Denote dm as the maximum communication distance of satellite m. According to eq. (6) and the deÔ¨Ånition of Sq, dm can be given by dm = ‚àíRe sin Œ∏min +

(Re sin Œ∏min)2 + h2 + 2hRe. (10) Based on this, we can have the following proposition. Proposition 1: The average interference of UT q - satellite m link can be given by E(Im,q) = 2œÄReŒªPG J(Œ± ‚àí2)(Re + h). (11) Proof: See Appendix A. C. Average Data Rate and Backhaul Capacity According to the property of HPPP, the number of UTs in the coverage of a satellite is a random variable following the Poisson distribution. The probability of existing k UTs in the coverage can then be expressed as f(xm = k) = (ŒªS)k e‚àíŒªS k! , (12) where S is given in eq. (4). Therefore, based on the Poisson probability, the average data rate for the UT q - satellite m link can be given by E(Rm,q)= ‚àû

k=1 (ŒªS)k¬∑ e‚àíŒªS k! ¬∑ B k ¬∑ E

log2  1+ Pgm,q œÉ2+E(Im,q)  . (13) Lemma 1: The expectation of log2

1 + P gm,q œÉ2+E(Im,q)  can be given by eq. (14), shown at the bottom of the page, where E(Im,q) can be calculated by eq. (11) and 2F1(¬∑) is the generalized hypergeometric function . Proof: See Appendix B. The following proposition can be derived from Lemma 1. Proposition 2: The average data rate for the UT q - satellite m link can be given by E(Rm,q) = (Ei(ŒªS) ‚àíln(ŒªS) ‚àíŒ≥) e‚àíŒªSBŒ•, (15) Œ• = E

log2  1 + Pgm,q œÉ2 + E(Im,q)  = 1 2 ln 2 ¬∑ Re(Re + h)(1 ‚àícos œï) ¬∑  d2 m

‚àíŒ± 2 2F1  1, ‚àí2 Œ±; 1 ‚àí2 Œ±; ‚àí PGd‚àíŒ± m œÉ2 + E(Im,q)  + ln  1 + PGd‚àíŒ± m œÉ2 + E(Im,q)  + Œ± 2

‚àíh2

‚àíŒ± 2 2F1  1, ‚àí2 Œ±; 1 ‚àí2 Œ±; ‚àí PGh‚àíŒ± œÉ2 + E(Im,q)  + ln  1 + PGh‚àíŒ± œÉ2 + E(Im,q)  + Œ± 2  (14) œÅ = kmin 2œÄ(Re + h)2(1 ‚àícos œï) = Cth 2œÄ(Re + h)2(1 ‚àícosœï)  e‚àíŒªSBŒ• (18) Authorized licensed use limited to: Tsinghua University. Downloaded on August 29,2024 at 22:13:35 UTC from IEEE Xplore.  Restrictions apply. 4848 IEEE TRANSACTIONS ON WIRELESS COMMUNICATIONS, VOL. 20, NO. 8, AUGUST 2021 where Ei(x) =  x ‚àí‚àû et t dt is the exponential integral function (Chapter 5, ), Œ≥ is the Euler constant, and Œ• can be obtained by eq. (14). Proof: See Appendix C. We assume that the average number of satellites in Sq is k, and the average total backhaul capacity of each UT can be given by E( ÀúCq)=

m‚ààSq E(Rm,q)=k (Ei(ŒªS) ‚àíln(ŒªS)‚àíŒ≥) e‚àíŒªSBŒ•. (16) Remark 1: The average total backhaul capacity of each UT decreases as the density of UTs grows. Proof: See Appendix D. IV. ULTRA-DENSE LEO SATELLITE CONSTELLATION DESIGN In this section, we Ô¨Årst formulate the global kmin-coverage problem of LEO satellite constellation deployment to satisfy the backhaul requirement of Poisson-distributed UTs. We then propose three LEO satellite constellation design criteria, based on which a three-dimensional constellation optimization algorithm to minimize the number of LEO satellites while guaranteeing seamless global coverage and satisfying the backhaul requirement of each UT is Ô¨Ånally given.

satellite constellation with a minimum number of satellites based on the proposed three-dimensional constellation optimization algorithm. Major simulation parameters are set up based on the 3GPP speciÔ¨Åcations  as given in Table I. A. The Average Total Backhaul Capacity of Each UT Fig. 5 illustrates the average total backhaul capacity of each UT versus the density of UTs Œª. It shows that the average total backhaul capacity of each UT decreases as Œª grows, which veriÔ¨Åes the statement in Remark 1. The main reason is that the available bandwidth for each UT decreases and more UTs result in more interference links. We also observe that the average total backhaul capacity of each UT increases with the number of satellites providing data services. It can also be seen that our theoretical result in (16) perfectly matches with

B. The Number of Deployed LEO Satellites Note that there are various factors inÔ¨Çuencing the number of deployed (i.e., eligible) LEO satellites such as the backhaul requirement of each UT, the average coverage ratio requirement, the density of UTs, the initial constellation deployment, the altitude of satellites, and the minimum elevation angle at Authorized licensed use limited to: Tsinghua University. Downloaded on August 29,2024 at 22:13:35 UTC from IEEE Xplore.  Restrictions apply. DENG et al.: ULTRA-DENSE LEO SATELLITE CONSTELLATIONS: HOW MANY LEO SATELLITES DO WE NEED? 4851 TABLE II THE MINIMUM NUMBER OF LEO SATELLITES GUARANTEEING COVERAGE RATIO OVER 90% AND 95% Algorithm 1 Three-Dimensional Constellation Optimization Algorithm Input: Coverage degree for low latitude area kmin, coverage degree for high latitude area kmax, coverage ratio requirement Œ∑0. 1 Initialization: Global k-coverage LEO polar-orbit constellation deployment shown in Section IV.B, kmax‚Äôs lower bound km = kmin, kmax‚Äôs upper bound kM = kMAX; 2 while kM > km do 3 Set kmax =  + 1; 4 for Satellite m in M do 5 Find all intersection points inside the coverage area of m and calculate their coverage degrees; 6 if m Ô¨Çies over high latitude area then 7 Determine the eligibility of m based on the kmax-covered eligibility rule. 8 end 9 else if m Ô¨Çies over low latitude area then 10 Determine the eligibility of m based on the kmin-covered eligibility rule. 11 end 12 if m is ineligible then 13 Remove m from the satellite set M. 14 end 15 end 16 Calculate the average coverage ratio Œ∑; 17 if Œ∑ < Œ∑0 or kmax = kM then 18 Set km = kmax; 19 end 20 else 21 Set kM = kmax; 22 end 23 end Output: The minimum subset Mmin ‚äÇM of LEO satellites guaranteeing the given coverage ratio requirement. the UT. We Ô¨Årst evaluate the inÔ¨Çuence of the required backhaul capacity of each UT Cth and the coverage ratio averaged over all time slots and then investigate how the rest factors inÔ¨Çuence the number of deployed LEO satellites. Fig. 6 shows a 3D surface plot of the deployed LEO satellite number versus the required backhaul capacity of each UT Cth and the coverage ratio averaged over all time slots. The speciÔ¨Åc value of the minimum LEO satellite number guaranteeing Fig. 5. Average total backhaul capacity of each UT versus the density of UTs. Fig. 6. The number of deployed LEO satellite versus coverage degree. coverage ratio over 90% and 95% is also given in Table II. It can be seen that the number of deployed LEO satellites increases with Cth. The coverage ratio averaged over all time slots also increases with the number of deployed LEO satellites when kmin is Ô¨Åxed. Moreover, Fig. 6 shows that for any given coverage ratio requirement, the corresponding optimized LEO satellite constellation can be obtained by the proposed threedimensional constellation optimization algorithm. Note that there is a close relation between the number of orbits in the initial global 1-coverage polar-orbit constellation, i.e., N0, the number of satellites in each orbit M, the satellites‚Äô Authorized licensed use limited to: Tsinghua University. Downloaded on August 29,2024 at 22:13:35 UTC from IEEE Xplore.  Restrictions apply. 4852 IEEE TRANSACTIONS ON WIRELESS COMMUNICATIONS, VOL. 20, NO. 8, AUGUST 2021 TABLE III THE RELATION BETWEEN N0 AND INITIAL NUMBER OF LEO SATELLITES MN Fig. 7. The number of deployed LEO satellite versus N0. altitude h, and the minimum elevation angle Œ∏min at the UT as given in eq. (22). Since the satellites‚Äô altitude h and the minimum elevation angle Œ∏min at the UT also inÔ¨Çuences the average total backhaul capacity of each UT, we consider evaluating the inÔ¨Çuence of (N0, M) and (h, Œ∏min) separately. Fig. 7 illustrates the number of deployed LEO satellites versus N0 when h and Œ∏min are Ô¨Åxed.10 We observe that the number of deployed LEO satellites Ô¨Årst decreases then increases as N0 grows. The main reason is that when h and Œ∏min are Ô¨Åxed, based on the relation between N0 and M given in eq. (22), the total number of satellites in the initial constellation MN (i.e., MN0kmin) Ô¨Årst decreases then increases as N0 grows, as shown in Table III. This implies that the number of deployed LEO satellites in the optimized constellation has a close relation to the initial LEO satellite constellation. The initialization of LEO satellite constellation can be optimized to minimize the number of LEO satellites. Fig. 8 shows a 3D surface plot of the deployed LEO satellite number versus the altitude of satellites h and the minimum elevation angle Œ∏min at the UT when the backhaul requirement for each UT Cth is 100Mbps.11 It can be seen that the number of deployed LEO satellites Ô¨Årst increase and then decreases as h grows when Œ∏min is Ô¨Åxed. The main reason is that 10In Fig. 7, we set Œ∏min = 16‚ó¶. 11Note that according to eq. (22), each combination of h and Œ∏min corresponds to multiple combinations of N0 and M. As shown in Fig. 7, the number of deployed LEO satellites in the optimized constellation has a close relation to the initial LEO satellite constellation. For the sake of fairness, we choose the initial LEO satellite constellation with the minimum number of satellites for each combination of h and Œ∏min. Fig. 8. The number of deployed LEO satellite versus satellites‚Äô altitude and minimum elevation angle. Fig. 9. The number of deployed LEO satellite versus the density of UTs. each satellite can provide services to more UTs as h grows.

in the sharp decline of the backhaul capacity, and thus, more satellites are needed. We can also observe from Fig. 8 that the number of deployed LEO satellites Ô¨Årst increase and then decreases as Œ∏min grow when h is Ô¨Åxed. This is because the average data rate of the UT-satellite link increases with Œ∏min. However, the decline of the number of UTs within each satellite‚Äôs coverage becomes the main inÔ¨Çuencing factor when Œ∏min continues to grow. This implies there exists an optimal combination of the Authorized licensed use limited to: Tsinghua University. Downloaded on August 29,2024 at 22:13:35 UTC from IEEE Xplore.  Restrictions apply. DENG et al.: ULTRA-DENSE LEO SATELLITE CONSTELLATIONS: HOW MANY LEO SATELLITES DO WE NEED? 4853 Fig. 10. Coverage ratio versus the satellites‚Äô maximum radial offset. satellites‚Äô altitude and minimum elevation angle at the UT minimizing the number of LEO satellites. Under the parameter settings in the simulation, the optimal combination of h and Œ∏min is (800Km, 14‚ó¶). Fig. 9 depicts the number of deployed LEO satellites versus the density of UTs Œª when the average data rate of the UT-satellite link and the backhaul requirement of each UT are Ô¨Åxed. We observe that the number of deployed LEO satellites increases with the density of UTs. The main reason is that the total backhaul capacity requirement of all UTs is higher. It can also be seen that the number of deployed LEO satellites increases with the minimum elevation angle Œ∏min at the UT. This is because the number of satellites which can provide service to each UT decreases with the minimum elevation angle Œ∏min. Another important observation in Fig. 9 is that the proposed three-dimensional constellation optimization algorithm outperforms the greedy constellation algorithm, where the satellites in the initial constellation are removed based on the

the coverage ratio of the proposed LEO satellite constellation remains almost unchanged even the satellites‚Äô maximum radial offset is very large, thereby verifying the constellation‚Äôs stability. It has also been proved that the proposed LEO satellite constellation can improve the average coverage ratio of Telesat constellation by at least 10 percentage points.

First, the initialization of LEO satellite constellation can be optimized to minimize the number of LEO satellites. Second, there exists an optimal combination of the satellites‚Äô altitude and minimum elevation angle at the UT minimizing the number of LEO satellites. Third, a well-designed asymmetrical satellite constellation can meet the backhaul requirement with a smaller number of deployed satellites than the traditional symmetrical satellite constellation. APPENDIX A PROOF OF PROPOSITION 1 Without loss of generality, we assume that UT q is located in the north pole. According to Campell‚Äôs theorem (Chapter 4, ), the interference of UT q - satellite m link is E(Im,q) = Œª‚Ä≤PG  q‚Ä≤‚ààDm,q d‚àíŒ± m,q‚Ä≤dq‚Ä≤, where Dm,q = {q‚Ä≤|dm ‚â§ dm,q‚Ä≤ ‚â§ ‚àö h2 + 2Reh} is the region with latitude between Authorized licensed use limited to: Tsinghua University. Downloaded on August 29,2024 at 22:13:35 UTC from IEEE Xplore.  Restrictions apply. DENG et al.: ULTRA-DENSE LEO SATELLITE CONSTELLATIONS: HOW MANY LEO SATELLITES DO WE NEED? 4855 (arcsin Re Re+h) and ( œÄ 2 ‚àíœï). We then use the spherical segments between latitude lines as the partition of the integral region, and thus, E(Im,q) can be obtained by E(Im,q) = Œª‚Ä≤PG

œÄ 2 ‚àíœï arcsin Re Re+h 2œÄR2 e cos Œ≤ ¬∑ ‚àíŒ± 2 dŒ≤ (a) = Œª‚Ä≤PG cos œï Re Re+h 2œÄR2 e ¬∑ ‚àíŒ± 2 du (b) = Œª‚Ä≤PG 2Re(Re + h) h2+2Reh d2m 2œÄR2 ev‚àíŒ± 2 dv = 2œÄReŒªPG J(Œ± ‚àí2)(Re + h), (26) where in (a) and (b) the substitutions u = sin Œ≤ and v = R2 e + (Re + h)2 ‚àí2Re(Re + h)u are applied respectively. APPENDIX B PROOF OF LEMMA 1 Without loss of generality, we assume that UT q is located in the north pole and the satellites are uniformly distributed on the sphere with radius Re + h. For simplicity, we denote the region where satellites are visible to the UT in one snapshot as Sq. The area of Sq can then be given by SSq = 2œÄ(Re + h)2(1 ‚àí cos œï). Therefore, the expectation of log2

1 + P gm,q œÉ2+E(Im,q)  can be given by Œ• = E  log2

1 + P gm,q œÉ2+E(Im,q)  = 1 SSq ln 2  m‚ààSq ln

1 + P gm,q œÉ2+E(Im,q)  dm. Similar to the partition of the integral region utilized in the proof of Proposition 1, Œ• can be calculated by Œ• = 1 SSq ln 2

œÄ 2 œÄ 2 ‚àíœï 2œÄ(Re + h)2 cos œà ln{1+ PG œÉ2 + E(Im,q) ¬∑ ‚àíŒ± 2 }dœà (a) = œÄ(1 + h Re ) SSq ln 2 d2 m h2 ln

1 + PGv‚àíŒ± 2 œÉ2 + E(Im,q)

dv, (27) where in (a) the substitution v = R2 e + (Re + h)2 ‚àí2Re(Re + h)u is applied. By utilizing the integral formula, i.e.,  ln(1 + AvB)dv = v

B 2F1(1, 1 B ; 1 + 1 B ; ‚àíAvB) + log(AvB + 1) ‚àíB

, Œ• can then be obtained by setting A = P G œÉ2+E(Im,q) and B = ‚àíŒ± 2 in the integral formula. APPENDIX C PROOF OF PROPOSITION 2 Proposition 2 can be derived from Lemma 1 by utilizing the Puiseux series of the exponential integral, i.e., Ei(x) = Œ≥ + ln(x) + ‚àû k=1 xk k¬∑k!, where Œ≥ is the Euler constant. By substituting the expectation of log2

1 + P gm,q œÉ2+E(Im,q)  given in Lemma 1 into eq. (14), i.e., E(Rm,q) = ‚àû  k=1 (ŒªS)k ¬∑ Fig. 13. Illustration of the coverage patch bounded by exterior arcs of satellites‚Äô coverage area. e‚àíŒªS k! ¬∑ B k ¬∑ E  log2

1 + P gm,q œÉ2+E(Im,q)  , we have E(Rm,q) = ‚àû  k=1 (ŒªS)k ¬∑ e‚àíŒªS k! ¬∑ B k ¬∑ Œ• (a) = (Ei(ŒªS) ‚àíln(ŒªS) ‚àíŒ≥) e‚àíŒªSBŒ•, where in (a) the Puiseux series of the exponential integral is applied. APPENDIX D PROOF OF REMARK 1 On the one hand, since the average interference of UT q satellite m link given in eq. (11) increases with the density of UTs Œª, Œ• = E  log2

1 + P gm,q œÉ2+E(Im,q)  decreases as Œª grows. On the other hand, we have d d(ŒªS) = e‚àíŒªS  1 ‚àí+‚àû k=1 (ŒªS)k k!k(k+1)  . Note that when ŒªS ‚â• 2 (i.e., there are no less than 2 UTs within each LEO satellite‚Äôs coverage, which is accordant with practical circumstances.), we have 1 ‚àí+‚àû k=1 (ŒªS)k k!k(k+1) < 1 ‚àíŒªS 2 ‚â§0. Therefore, (Ei(ŒªS) ‚àíln(ŒªS) ‚àíŒ≥) e‚àíŒªS also decreases as Œª grows, and the average total backhaul capacity of each UT given in eq. (16) decreases as the density of UTs grows. APPENDIX E PROOF OF PROPOSITION 3 We prove by contradiction. As shown in Fig. 13, assume that point q has the smallest coverage degree kq < k on the Earth surface, and all intersection points between two satellites on the Earth surface are at least k-covered. The set of LEO satellites‚Äô coverage area can partition the Earth surface into a collection of coverage patches, which are bounded by arcs of the coverage area. Besides, all points in each coverage patch have the same coverage degree. Assume that point q is located in coverage patch S. We Ô¨Årst prove by contradiction that the interior arc of any coverage area cannot serve as the boundary of S. Assume that there exists an interior arc serving as the boundary of S. Note that crossing this arc can reach an area that has a smaller coverage degree than point q, which contradicts the assumption that point q has the smallest coverage degree on the Earth surface. Therefore, the boundary of S is consists of exterior arcs of the set of LEO satellites‚Äô coverage area as Authorized licensed use limited to: Tsinghua University. Downloaded on August 29,2024 at 22:13:35 UTC from IEEE Xplore.  Restrictions apply. 4856 IEEE TRANSACTIONS ON WIRELESS COMMUNICATIONS, VOL. 20, NO. 8, AUGUST 2021 illustrated in Fig. 13. Moreover, since the arcs of each LEO satellite‚Äôs coverage area are outside the satellite‚Äôs coverage range, the entire boundary of S, including the intersection points of between two satellites deÔ¨Åning the boundary, has the same coverage degree as point q. This contradicts the assumption that q has a smaller coverage degree than k and all intersection points are at least k-covered. Proposition 3 can then be proved.

N OWADAYS, the explosive increasing data trafÔ¨Åc created by the growing wireless devices and applications makes Ô¨Åfth generation networks have a stringent demand for seamless reliable global data services and massive connectivity , . However, the unbalanced infrastructure deployment and unstable wireless environment limit traditional terrestrial networks Manuscript received August 10, 2020; revised December 18, 2020; accepted February 20, 2021. Date of publication March 5, 2021; date of current version August 12, 2021. This work was supported in part by the National Key Research and Development Program of China under Grant 2020YFB1804800 and in part by the National Natural Science Foundation of China under Grant 61625101, Grant 61829101, Grant 61941101, and Grant 61911540076. The associate editor coordinating the review of this article and approving it for publication was G. C. Alexandropoulos. (Corresponding author: Lingyang Song.) Ruoqi Deng and Lingyang Song are with the Department of Electronics, Peking University, Beijing 100871, China (e-mail: ruoqi.deng@pku.edu.cn; lingyang.song@pku.edu.cn). Boya Di is with the Department of Electronics, Peking University, Beijing 100871, China, and also with the Department of Computing, Imperial College London, London SW7 2BU, U.K. (e-mail: diboya92@gmail.com). Hongliang Zhang is with the Department of Electronics, Peking University, Beijing 100871, China, and also with the Department of Electrical Engineering, Princeton University, Princeton, NJ 08544 USA (e-mail: hongliang.zhang92@gmail.com). Linling Kuang is with the Tsinghua Space Center, Tsinghua University, Beijing 100084, China, and also with the Beijing National Research Center for Information Science and Technology, Tsinghua University, Beijing 100084, China (e-mail: kll@tsinghua.edu.cn). Color versions of one or more Ô¨Ågures in this article are available at https://doi.org/10.1109/TWC.2021.3062658. Digital Object IdentiÔ¨Åer 10.1109/TWC.2021.3062658 to handle the exponentially increasing data trafÔ¨Åc . Besides, the limited backhaul capacity is another development bottleneck for traditional terrestrial networks due to the short of available bandwidth . To solve the above issues, the ultradense low Earth orbit (LEO) satellite networks are developed with the promising of providing high-capacity backhaul, seamless global coverage, and much more Ô¨Çexible network access services , . SpeciÔ¨Åcally, in the ultra-dense LEO-based terrestrial-satellite network, the user terminal (UT) acting as the access point can not only connect to multiple satellites over Ka-band for backhaul but also support the user-UT links over the dedicated C-band1 , . To further improve the system performance, one of the most important issues to be considered in the construction of an ultra-dense LEO satellite network is the constellation design . The LEO satellite constellation contains a group of LEO satellites launched into pre-planned orbits by the ground control center to form a network . A well-designed LEO satellite constellation can improve the QoS for terrestrial cellular networks with a proper constellation size without resource wasting. Although several typical satellite constellations have been proposed to achieve global coverage such as polar orbit constellation , Walker Delta constellation , and Flower constellation , , they can only satisfy basic communication needs2 without considering quality-ofservice (QoS) of terrestrial users and the cost of LEO satellite deployment. Therefore, rather than satisfy basic communication needs, the main target of ultra-dense LEO satellite constellation design is to balance the terrestrial-satellite network performance (such as the backhaul capacity of the UT and the coverage ratio) and the cost of LEO satellite deployment . In the literature, various aspects have been considered for LEO satellite constellation deployment such as satellite number minimization , , coverage maximization , , communication delay minimization , and heterogeneous networks construction . Several intelligent algorithms are utilized for satellite constellation optimization such as the genetic algorithm (GA), differential evolution (DE), immune algorithm and particle swarm optimization (PSO) . has proposed a non-dominated sorting genetic algorithm for regional LEO satellite constellation design to meet the user 1With the development of reconÔ¨Ågurable intelligent surfaces (RISs) , the RIS-aided LEO satellite networks can further improve the system performance such as the total capacity and energy efÔ¨Åciency . 2The basic communication needs refer to the low data rate communication, such as voice communication. 1536-1276 ¬© 2021 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See https://www.ieee.org/publications/rights/index.html for more information. Authorized licensed use limited to: Tsinghua University. Downloaded on August 29,2024 at 22:13:35 UTC from IEEE Xplore.  Restrictions apply. 4844 IEEE TRANSACTIONS ON WIRELESS COMMUNICATIONS, VOL. 20, NO. 8, AUGUST 2021 requirements with lower satellite costs. In , a satellite

We assume that the backhaul requirement for a UT is Cth. Therefore, the expectation of the backhaul capacity for a UT should satisfy the backhaul requirement for any time slot t ‚àà T , i.e., E( ÀúCt q) ‚â•Cth, ‚àÄt ‚ààT , ‚àÄq. According to eq. (16), the minimum number of satellites providing service to each UT can be given by kmin = Cth (Ei(ŒªS) ‚àíln(ŒªS) ‚àíŒ≥) e‚àíŒªSBŒ•. (17) Note that each satellite will associate with all the UTs in its coverage area, the Ô¨Årst criterion for LEO satellite constellation design can then be given as follows. Criterion 1 (Backhaul Requirement): Each UT should be covered by at least kmin satellites in any time slot t ‚ààT . Moreover, since on the orbit sphere, the region where satellites are visible to the UT in one snapshot is 2œÄ(Re + h)2(1 ‚àícos œï), the minimum density of LEO satellites can be given by eq. (18), shown at the bottom of the previous page, and the minimum number of LEO satellites guaranteeing seamless global coverage while satisfying the backhaul requirement of each UT can then be given by ( N

n=1 Mn)min = œÅ ¬∑ 4œÄ(Re + h)2 = 2Cth (1 ‚àícos œï)  e‚àíŒªSBŒ•. (19) DeÔ¨Ånition 1: A point q in a region A is said to be k-covered if it is covered by at least k satellites, and k is said to be the coverage degree of point q. A region A is said to be k-covered if every point q ‚ààA is k-covered. Since the UTs are distributed according to a HPPP, their locations are random points. We aim to minimize the number of LEO satellites under the constraint that the LEO satellite constellation deployment must guarantee the Earth is kmincovered in any time slot t ‚ààT . Such a global kmin-coverage problem can be formulated as min

n‚ààN Mn s.t. St q ‚â•kmin, ‚àÄt ‚ààT , ‚àÄq. (20) Note that the problem of selecting a minimum subset of Mmin ‚äÇM of LEO satellites to achieve global kmin-coverage is NP-hard. To solve this global kmin-coverage problem, we Ô¨Årst give an initial constellation deployment which can guarantee global kmin-coverage. Following that, we design a three-dimensional constellation optimization algorithm to Ô¨Ånd extra satellites that can be removed from the initial constellation deployment without degrading the global kmin-coverage. B. Initial LEO Satellite Constellation Deployment We adopt the typical LEO polar-orbit constellation for the initial constellation deployment8 . We Ô¨Årst consider the global 1-coverage with polar orbits which has been investigated well in the previous work. SpeciÔ¨Åcally, as shown in Fig. 4(a), each orbit consists of the same number of satellites, i.e., M1 = M2 = ¬∑ ¬∑ ¬∑ = Mn = M. Satellites in adjacent orbits move in the same direction with a phase difference of œÄ/M. The number of orbital planes N0 and the angular radius of the coverage circle œï satisÔ¨Åes (N0 ‚àí1)œï + (N0 + 1)Œî = œÄ, (21) where Œî = cos‚àí1, and œï can be given by eq. (3). Therefore, the N orbital planes are separated in angle by œÜ where œÜ = œï + Œî, and the relation between the number of orbital planes N, the number of satellites in each orbit M, the altitude of each satellite h, and the minimum elevation angle Œ∏min at the UT satisfy the following equation: (N0 + 1) cos‚àí1 ‚éß ‚é® ‚é© cos  cos‚àí1

Re cos Œ∏min Re+h  ‚àíŒ∏min  cos( œÄ M ) ‚é´ ‚é¨ ‚é≠ + (N0 ‚àí1)

cos‚àí1 Re cos Œ∏min Re + h  ‚àíŒ∏min

= œÄ. (22) Note that the satellites in adjacent orbits moving in the same direction can cover an area with a longitude span of (œï + Œî), while the satellites in adjacent orbits moving in the opposite direction can cover an area with a longitude span 8The polar-orbit constellation is one of the most representative satellite constellations and has been well investigated. Iridium  and OneWeb both adopt polar-orbit constellation for LEO satellite deployment to provide global coverage. The advantage of the polar-orbit constellation is that it can strengthen the effective coverage of polar regions greatly. The polar-orbit constellation can save more satellites and outperforms the non-polar-orbit constellation for global coverage. Authorized licensed use limited to: Tsinghua University. Downloaded on August 29,2024 at 22:13:35 UTC from IEEE Xplore.  Restrictions apply. DENG et al.: ULTRA-DENSE LEO SATELLITE CONSTELLATIONS: HOW MANY LEO SATELLITES DO WE NEED? 4849 of 2Œî . Therefore, the global 1-coverage can be guaranteed by the polar-orbit LEO satellite constellation satisfying eq. (21). After determining the global 1-coverage polar-orbit LEO satellite constellation deployment, we can copy the polarorbit LEO satellite constellation illustrated above kmin ‚àí1 times on the same location, and then rotate the ith (1 ‚â§i ‚â§ kmin ‚àí1) duplicate around the north-south direction by an angle iœÄ/kmin. Therefore, as shown in Fig. 4(b), we obtain the initial polar-orbit LEO satellite constellation consisting of N = N0kmin polar orbits and M satellites in each orbit, based on which the global kmin-coverage can be ensured. The upper bound of the minimum number of LEO satellites guaranteeing global kmin-coverage can then be given by (N n=1 Mn)max = MN0kmin. C. Three-Dimensional Constellation Optimization Algorithm 1) Eligibility of a Satellite: Note that for a given initial LEO satellite constellation as mentioned above, there are several unnecessary LEO satellites resulting in coverage redundant. In other words, the backhaul requirement of each UT can also be satisÔ¨Åed even if these LEO satellites are removed from the initial constellation. Therefore, we Ô¨Årst determine the eligibility of each satellite in the initial constellation. For convenience, we deÔ¨Åne the following notations. DeÔ¨Ånition 2: Satellite m is ineligible and can be removed from the initial constellation, if every location within satellite m‚Äôs coverage is already kmin-covered by other satellites in its neighborhood. Otherwise, satellite m is eligible and can be selected into the minimum subset of LEO satellites. DeÔ¨Ånition 3: A point p on Earth is called an intersection point between two satellites, if p is an intersection point of the coverage area‚Äôs boundaries of two satellites. SpeciÔ¨Åcally, the coordinate of the intersection point between two satellites located at (x1, y1, z1) and (x2, y2, z2) can be obtained by solving the following equations with respect to (x, y, z): ‚éß ‚é™ ‚é® ‚é™ ‚é© xx1 + yy1 + zz1 = Re(Re + h) cos œï, xx2 + yy2 + zz2 = Re(Re + h) cos œï, x2 + y2 + z2 = R2 e. (23) Without loss of generality, we assume that x1y2 Ã∏= x2y1. The closed-form solution of the coordinate of the intersection point can be given by ‚éõ ‚éù x y z ‚éû ‚é†= ‚éõ ‚éú ‚éú ‚éú ‚éù (y2‚àíy1)Re(Re+h) cos œï x1y2 ‚àíx2y1 (x1‚àíx2)Re(Re+h) cosœï x1y2 ‚àíx2y1 0 ‚éû ‚éü ‚éü ‚éü ‚é†+ Œ∫ ‚éõ ‚éù y1z2‚àíy2z1 z1x2‚àíz2x1 x1y2‚àíx2y1 ‚éû ‚é†, (24) where Œ∫ can be obtained by solving the following quadratic equation: Œ∫2 + Œ∫2Re(Re + h) cos œï x1y2 ‚àíx2y1 + Re(Re + h) cos œï x1y2 ‚àíx2y1 2 ¬∑  ‚àíR2 e = 0. (25) Before presenting the three-dimensional constellation optimization algorithm, we introduce the following proposition which states a sufÔ¨Åcient condition for global kmin-coverage. Proposition 3: The Earth‚Äôs surface is k-covered by a set of LEO satellites if (a) there exist intersection points between two satellites; (b) all intersection points are at least k-covered . Proof: See Appendix E. According to Proposition 3, the kmin-Covered eligibility rule determining whether a satellite in the initial polar-orbit LEO satellite constellation should be removed can be obtained. SpeciÔ¨Åcally, a satellite is ineligible and can be removed from the initial constellation if all the intersection points inside its coverage area are at least kmin-covered. Otherwise, the satellite can not be removed. Therefore, we propose the second criterion for LEO satellite constellation design to determine whether a satellite should be removed from the initial constellation. Criterion 2 (Satellite‚Äôs kmin-Covered Eligibility): For each LEO satellite in the initial polar-orbit LEO satellite constellation, whether it should be removed from the initial constellation is determined by the coverage-based eligibility rule. 2) Execution of Criterion 2: Note that if the eligibility of all satellites is determined based on this kmin-covered eligibility rule in the Ô¨Årst time slot, the number of ineligible satellites Ô¨Çying over the high latitude area will be larger than that of the low latitude area. When satellites in the high latitude area Ô¨Çy over the low latitude area in later time slots, it is likely that global kmin-coverage can not be achieved. Therefore, we consider reducing the number of ineligible satellites Ô¨Çying over the high latitude area to guarantee the global kmin-coverage in any time slot t ‚ààT . SpeciÔ¨Åcally, we deÔ¨Åne a larger required coverage degree over high latitude area kmax (kmax ‚â•kmin). The eligibility of satellites Ô¨Çying over the high latitude area is determined based on the kmax-covered eligibility rule. Since the number of eligible satellites which can not be removed from the initial constellation increases with kmax, the coverage ratio averaged over all time slots of the optimized LEO satellite constellation will increase correspondingly. Therefore, the value of kmax can be determined by the coverage ratio requirement, and the third criterion for LEO satellite constellation design can then be given as follows. Criterion 3 (Latitude-Based k-Covered Eligibility Selection): The eligibility of satellites Ô¨Çying over the high latitude area is determined by the kmax-covered eligibility rule (kmax ‚â•kmin), while the eligibility of satellites Ô¨Çying over the low latitude area is determined by the kmin-covered eligibility rule. The value of kmax is determined by the coverage ratio requirement. 3) Three-Dimensional Constellation Optimization Algorithm Description: According to the above three criteria (i.e., backhaul requirement, satellite‚Äôs kmin-covered eligibility, and latitude-based k-covered eligibility selection) for LEO satellite constellation design, the three-dimensional constellation Authorized licensed use limited to: Tsinghua University. Downloaded on August 29,2024 at 22:13:35 UTC from IEEE Xplore.  Restrictions apply. 4850 IEEE TRANSACTIONS ON WIRELESS COMMUNICATIONS, VOL. 20, NO. 8, AUGUST 2021 TABLE I MAJOR PARAMETERS FOR SIMULATION optimization algorithm is summarized in Algorithm 1 where

has been proposed for continuous mutual regional coverage. The relation between the coverage ratio and the number of satellites has been discussed.  and  both have adopted the genetic algorithm for regional satellite constellation design to maximize the coverage of target areas. In , a progressive satellite constellation network construction scheme has been developed to minimize the end-to-end delay.  has investigated the LEO satellite constellation-based Internet-of-Things system. The LEO satellite constellation, spectrum allocation scheme, and routing protocols have been discussed for such a heterogeneous network. In , the performance of different intelligent algorithms for satellite constellation design, i.e., GA, DE, immune algorithm, and PSO has been compared for satellite coverage capability enhancement. However, several critical issues in LEO satellite constellation design have not been considered in most existing works. First, they mainly considered the case that satellites are uniformly distributed on orbital planes . The coupling between neighboring orbits has been ignored, resulting in redundant satellite coverage. Second, some works mainly focused on the satellite constellation design to achieve regional coverage with static or quasi-static topology of LEO satellite constellation without considering LEO satellites‚Äô highmobility , . Third, the seamless global coverage (i.e., the coverage on the Earth is continuous) and the backhaul requirement of the UT3 have not been jointly considered due to the limited number of satellites . Against this background, we mainly investigate two open issues in the literature. ‚Ä¢ Considering the cost of LEO satellite deployment and LEO satellites‚Äô high-mobility, how many LEO satellites are enough to achieve seamless global coverage while satisfying the backhaul requirement of each UT? ‚Ä¢ For any given coverage ratio requirement,4 how to design an ultra-dense LEO satellite constellation with the minimum number of LEO satellites? To address the above issues, in this paper, we map such demands to multiple criteria in the ultra-dense LEO satellite constellation design, i.e., backhaul requirement satisfaction of UTs, seamless global coverage, and minimization of satellite number. We aim to propose a three-dimensional5 constellation optimization algorithm simultaneously handling these criteria to achieve an optimal trade-off between the cost of LEO satellite deployment and the LEO-based backhaul services provided to UTs. This is a non-trivial task due to the following three reasons. First, since UTs are randomly distributed on the Earth, the distance between a UT and a LEO satellite varies according to the location of the UT. Therefore, the theoretical backhaul 3The backhaul requirement means that the backhaul capacity of each UT should be larger than a predeÔ¨Åned threshold (such as 100Mbps). 4The coverage ratio requirement means that the satellite constellation‚Äôs coverage ratio on the Earth averaged over time should be larger than a predeÔ¨Åned threshold (such as 90%). 5The term ‚Äúthree-dimensional‚Äù refers to the three-dimensional space, since the satellites are distributed on a three-dimensional sphere, and the coverage area of each satellite is also a three-dimensional spherical cap. capacity analysis of each UT is difÔ¨Åcult to conduct. Second, due to the satellite orbital motion, the topology of the LEO satellite constellation is time-varying. It is challenging to optimize the multi-parametric LEO satellite constellation targeting at seamless global coverage while satisfying the backhaul requirement of each UT. Third, since the satellites are distributed on a three-dimensional sphere, and the coverage area of each satellite is also a three-dimensional spherical cap, the geometric relation of different satellites‚Äô coverage regions is hard to model. By addressing the above challenges, we contribute to the research on ultra-dense LEO satellite constellation deployment in the following ways. ‚Ä¢ We derive the average total backhaul capacity of each UT in the ultra-dense LEO-based terrestrial-satellite network, based on which a seamless global coverage problem considering the backhaul requirement of each UT is formulated to minimize the number of LEO satellites. ‚Ä¢ We design a three-dimensional constellation optimization algorithm to solve the seamless global coverage problem. SpeciÔ¨Åcally, for any given backhaul requirement and global coverage ratio requirement, the corresponding optimized LEO satellite constellation can be obtained by the proposed algorithm. The Cartesian coordinate of each satellite in the optimized LEO satellite constellation can also be given explicitly after the proposed algorithm is performed.

of kmax. In the initialization step (line 1), the LEO satellites are deployed according to the global k-coverage LEO polarorbit constellation shown in Section IV.B. The search interval

The following LEO satellite constellation optimization process (line 2-23) consists of multiple iterations. In each iteration, the selection of a minimum subset of LEO satellites following the coverage-based eligibility rule (line 4-15) is performed, based on which the selection of the proper value of kmax adopting the

will not stop until the search interval width of the bisection

optimized constellation Œ∑ meets the coverage ratio requirement Œ∑0. Therefore, for any given coverage ratio requirement, the proposed three-dimensional constellation optimization algorithm can give a corresponding optimized LEO satellite constellation by choosing a proper value of kmax.9 Although the eligibility of all satellites is determined in the Ô¨Årst time slot, the seamless global kmin-coverage can be guaranteed, which will be veriÔ¨Åed in Section V. Moreover, since the initial polar-orbit constellation is deterministic, the Cartesian coordinate of each satellite in the optimized LEO satellite constellation can be given explicitly after three-dimensional constellation optimization algorithm is performed. 4) Complexity Analysis: On the convergence of Algorithm 1, we observe the following facts. The complexity of Algorithm 1 is determined by the calculation of each intersection point‚Äôs coverage degrees of in line 5. We assume that the coverage area of each satellite is intersected with at 9The proposed three-dimensional constellation optimization algorithm can be extended to a multi-layer satellite network, since the proposed three criteria for LEO satellite constellation design have no limits on the Ô¨Çying altitudes of the satellites. most L coverage areas of other satellites. For each satellite, the complexity of Ô¨Ånding all intersection points inside its coverage area is O(NML2), where N is the number of orbits and M is the number of satellites operated in each orbit in the initial polar-orbit constellation. The calculation of each intersection point‚Äôs coverage degree has a complexity of O(L). Therefore, the complexity of line 5 is O(NML3), and thus, the whole algorithm has a complexity of O(N 2M 2L3).

constellation optimized by the greedy algorithm, the satellite constellation optimized by the proposed three-dimensional constellation optimization algorithm can meet the backhaul requirement with a smaller number of satellites. This shows the effectiveness of our proposed three-dimensional constellation optimization algorithm. C. The Stability of the Proposed Optimized LEO Satellite Constellation Since LEO satellites are under the inÔ¨Çuence of various perturbative forces such as the gravitation from other planets and the atmospherical drag, which affect their orbits and cause relative drifts , Fig. 10 evaluates the stability of the proposed optimized LEO satellite constellation in different coverage ratios. It can be seen that there is only a slight drop in the coverage ratio even the satellites‚Äô maximum radial offset grows to 10Km,12 indicating the stability of the proposed optimized LEO satellite constellation. 12In general, the satellites‚Äô maximum radial offset is about 5Km , . Fig. 11. Comparison between the proposed constellation and the modiÔ¨Åed Telesat constellation. D. Comparison With Other LEO Satellite Constellations To further evaluate the performance of the proposed threedimensional constellation optimization algorithm, we consider comparing the LEO satellite constellation optimized by the proposed three-dimensional constellation optimization algorithm with other representative global LEO satellite constellations. Fig. 11 compares the LEO satellite constellation optimized by the proposed three-dimensional constellation optimization algorithm with a modiÔ¨Åed Telesat constellation.13 SpeciÔ¨Åcally, the modiÔ¨Åed Telesat constellation consists of no less than 117 LEO satellites distributed on two sets of orbital planes. The Ô¨Årst set consists of 6 polar orbits with at least 12 satellites 13The Telesat constellation consists of no fewer than 117 LEO satellites distributed on two sets of orbital planes. The Ô¨Årst set consists of 6 polar orbits with at least 12 satellites on each orbital plane. The orbital inclination is 99.5‚ó¶and the altitude is 1000Km. The second set consists of no less than 5 inclined orbits with a minimum of 10 satellites on each orbital plane. The orbital inclination is 37.4‚ó¶and the altitude is 1200Km , which can better cover the low-latitude area on the Earth. For the fairness of the comparison, we consider a modiÔ¨Åed Telesat constellation where the inclination of the inclined orbits is 45‚ó¶to achieve more even coverage of the Earth. Authorized licensed use limited to: Tsinghua University. Downloaded on August 29,2024 at 22:13:35 UTC from IEEE Xplore.  Restrictions apply. 4854 IEEE TRANSACTIONS ON WIRELESS COMMUNICATIONS, VOL. 20, NO. 8, AUGUST 2021 TABLE IV AVERAGE COVERAGE RATIO OF THE ONEWEB CONSTELLATION Fig. 12. Comparison between the proposed constellation and the OneWeb constellation. on each orbital plane. The orbital inclination is 99.5‚ó¶and the altitude is 1000Km. The second set consists of no less than 5 inclined orbits with a minimum of 10 satellites on each orbital plane. The orbital inclination is 45‚ó¶and the altitude is 1200Km. It can be seen that for a given coverage degree and the total number of deployed LEO satellites, the average coverage ratio of the proposed optimized LEO satellite constellation is at least 10 percentage points higher than that of the modiÔ¨Åed Telesat constellation, indicating the effectiveness of the proposed three-dimensional constellation optimization algorithm. Fig. 12 compares the LEO satellite constellation optimized by the proposed three-dimensional constellation optimization algorithm with the OneWeb constellation. The OneWeb constellation consists of 720 LEO satellites distributed on 18 near polar orbits. Each near polar orbit consists of 40 uniformly distributed LEO satellites. The orbital inclination is 87‚ó¶and the altitude is 1200Km. Since the total number and the distribution of LEO satellites are Ô¨Åxed in the OneWeb constellation, the average coverage ratio of the OneWeb constellation varies with the backhaul capacity requirement of the UT. SpeciÔ¨Åcally, the average coverage ratio corresponding to different backhaul capacity requirement of the UT is given in Table IV. For the fairness of the comparison, under the same backhaul capacity requirement Cth, we set the average coverage ratio of the proposed constellation the same as that of the OneWeb constellation. It can be seen that for a given backhaul capacity requirement and average coverage ratio, the number of deployed LEO satellites in the proposed optimized LEO satellite constellation is smaller than that of the OneWeb constellation, which also veriÔ¨Åes the effectiveness of the proposed three-dimensional constellation optimization algorithm. Both Fig. 11 and Fig. 12 imply that a well-designed asymmetrical satellite constellation (i.e., satellites are not uniformly distributed on orbits) can meet the backhaul requirement with a smaller number of deployed satellites than the traditional symmetrical satellite constellation (i.e., satellites are uniformly distributed on orbits).

Z. Liu, W. Guo, W. Hu, and M. Xia, ‚ÄúDelay minimization for progressive construction of satellite constellation network,‚Äù IEEE Commun. Lett., vol. 19, no. 10, pp. 1718‚Äì1721, Oct. 2015. Z. Qu, G. Zhang, H. Cao, and J. Xie, ‚ÄúLEO satellite constellation for Internet of Things,‚Äù IEEE Access, vol. 5, pp. 18391‚Äì18401, 2017. X. Zhu and Y. Gao, ‚ÄúComparison of intelligent algorithms to design satellite constellations for enhanced coverage capability,‚Äù in Proc. 10th Int. Symp. Comput. Intell. Design (ISCID), Hangzhou, China, Dec. 2017, pp. 223‚Äì226. OneWeb Non-Geostationary Satellite System (Attachment A), Federal Commun. Commissions, Washington, DC, USA, 2016. O. Montenbruck and E. Gill, Satellite Orbits: Models, Methods and Applications. Berlin, Germany: Springer, 2012. J. Lopez-Fernandez, J. F. Paris, and E. Martos-Naya, ‚ÄúBivariate Rician shadowed fading model,‚Äù IEEE Trans. Veh. Technol., vol. 67, no. 1, pp. 378‚Äì384, Jan. 2018. R. Deng, B. Di, S. Chen, S. Sun, and L. Song, ‚ÄúUltra-dense LEO satellite ofÔ¨Çoading for terrestrial networks: How much to pay the satellite operator?‚Äù IEEE Trans. Wireless Commun., vol. 19, no. 10, pp. 6240‚Äì6254, Oct. 2020. Study on New Radio (NR) to Support Non Terrestrial Networks (Release 15), document TR 38.811 (V0.3.0), 3GPP, Dec. 2017. G. S. Grimmett, ‚ÄúDiscrete random variables,‚Äù in Probability and Random Processes. Oxford, U.K.: Oxford Univ. Press, 2020. W. W. Bell, ‚ÄúHypergeometric functions,‚Äù in Special Functions for Scientists Engineers. North Chelmsford, MA, USA: Courier Corporation, 2004. A. Jeffrey and H. Dai, Handbook of Mathematical Formulas and Integrals, 4th ed. New York, NY, USA: Academic, 2008. Y. Jia and Z. Peng, ‚ÄúThe analysis and simulation of communication network in iridium system based on OPNET,‚Äù in Proc. 2nd IEEE Int. Conf. Inf. Manage. Eng., Chengdu, China, Apr. 2010, pp. 68‚Äì72. X. Wang, G. Xing, Y. Zhang, C. Lu, R. Pless, and C. Gill, ‚ÄúIntegrated coverage and connectivity conÔ¨Åguration in wireless sensor networks,‚Äù in Proc. 1st Int. Conf. Embedded Netw. Sensor Syst. (SenSys), 2003, pp. 28‚Äì39. D. G. Luenberger and Y. Ye, ‚ÄúBasic descent methods,‚Äù in Linear and Nonlinear Programming, 4th ed. Cham, Switzerland: Springer, 2016. P. E. Zadunaisky, ‚ÄúSmall perturbations on artiÔ¨Åcial satellites as an inverse problem,‚Äù IEEE Trans. Aerosp. Electron. Syst., vol. 39, no. 4, pp. 1270‚Äì1276, Oct. 2003. P. Ligong, F. Zhuren, L. Ganhua, and H. Minzhang, ‚ÄúRelative motion model of satellites formation Ô¨Çying base on the inÔ¨Çuence of the J2 perturbation,‚Äù in Proc. IEEE Int. Conf. Robot. Biomimetics (ROBIO), Guilin, China, Dec. 2009, pp. 308‚Äì313. X. Cao, P. Zheng, and S. Zhang, ‚ÄúAtmospheric drag perturbation effect on the deployment of tether-assisted deorbit system,‚Äù in Proc. Int. Conf. Mechatronics Autom., Changchun, China, Aug. 2009, pp. 4316‚Äì4321. I. D. Portillo, B. G. Cameron, and E. F. Crawley, ‚ÄúA technical comparison of three low Earth orbit satellite constellation systems to provide global broadband,‚Äù Acta Astronautica, vol. 159, pp. 123‚Äì135, Jun. 2019. M. Haenggi, ‚ÄúSums and products over point processes,‚Äù in Stochastic Geometry for Wireless Networks. New York, NY, USA: Cambridge Univ. Press, 2013. Ruoqi Deng (Graduate Student Member, IEEE) received the B.S. degree in electronic engineering from Peking University, China, in 2019, where she is currently pursuing the Ph.D. degree with the Department of Electronics. Her current research interests include reconÔ¨Ågurable holographic metasurface, game theory, integrated aerial access, and satellite networks. Authorized licensed use limited to: Tsinghua University. Downloaded on August 29,2024 at 22:13:35 UTC from IEEE Xplore.  Restrictions apply. DENG et al.: ULTRA-DENSE LEO SATELLITE CONSTELLATIONS: HOW MANY LEO SATELLITES DO WE NEED? 4857 Boya Di (Member, IEEE) received the B.S. degree in electronic engineering from Peking University, China, in 2014, and the Ph.D. degree from the Department of Electronics, Peking University, in 2019. She is currently working as a Post-Doctoral Researcher with Imperial College London. Her current research interests include integrated aerial access and satellite networks, reconÔ¨Ågurable intelligent surfaces, multi-agent systems, edge computing, and vehicular networks. So far, she has contributed as the Ô¨Årst author for 11 journal articles and one of her journal articles is also listed as an ESI highly cited articles. She has served as a TPC Member for GlobeCom 2016, GlobeCom 2020, ICCC 2017, ICC 2016, ICC 2018, ICC 2020, and VTC 2019. She also serves as an Associate Editor for IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY. Hongliang Zhang (Member, IEEE) received the B.S. and Ph.D. degrees from the School of Electrical Engineering and Computer Science, Peking University, in 2014 and 2019, respectively. He was a Post-Doctoral Fellow with the Electrical and Computer Engineering Department, University of Houston, Houston, TX, USA, from July 2019 to July 2020. He is currently a Post-Doctoral Associate with the Department of Electrical Engineering, Princeton University, Princeton, NJ, USA. His current research interests include reconÔ¨Ågurable intelligent surfaces, aerial access networks, and game theory. He has served as a TPC Member for many IEEE conferences, such as Globecom, ICC, and WCNC. He received the Best Doctoral Thesis Award from the Chinese Institute of Electronics in 2019. He has been an exemplary reviewer of IEEE TRANSACTIONS ON COMMUNICATIONS since 2020. He is also an Editor of IET Communications and Frontiers in Signal Processing. He also serves as a Guest Editor for IEEE INTERNET OF THINGS JOURNAL (IoT-J) special issue on Internet of UAVs over Cellular Networks. Linling Kuang (Member, IEEE) received the B.S. and M.S. degrees from the National University of Defense Technology, Changsha, China, in 1995 and 1998, respectively, and the Ph.D. degree in electronic engineering from Tsinghua University, Beijing, China, in 2004. She has been with the Tsinghua Space Center, Tsinghua University, since 2007. Her research interests include wireless broadband communications, signal processing, and satellite communication. She is currently a member of IEEE Communications Society. Lingyang Song (Fellow, IEEE) received the Ph.D. degree from the University of York, U.K., in 2007. He worked as a Research Fellow with the University of Oslo, Norway, until rejoining Philips Research U.K. in March 2008. In May 2009, he joined the Department of Electronics, School of Electronics Engineering and Computer Science, Peking University, where he is currently a Boya Distinguished Professor. His research interests include wireless communication and networks, signal processing, and machine learning. He received the K. M. Stott Prize for excellent research from the University of York. He was a recipient of the IEEE Leonard G. Abraham Prize in 2016 and the IEEE Asia PaciÔ¨Åc (AP) Young Researcher Award in 2012. He has been an IEEE Distinguished Lecturer since 2015. Authorized licensed use limited to: Tsinghua University. Downloaded on August 29,2024 at 22:13:35 UTC from IEEE Xplore.  Restrictions apply.

II. ULTRA-DENSE LEO SATELLITE CONSTELLATION TOPOLOGY In this section, we Ô¨Årst describe the ultra-dense LEO-based terrestrial-satellite network where terrestrial users can access the network through the LEO-based backhaul over the Ka-band spectrum. We then introduce the LEO satellite constellation topology including the orbit model and the orbital Authorized licensed use limited to: Tsinghua University. Downloaded on August 29,2024 at 22:13:35 UTC from IEEE Xplore.  Restrictions apply. DENG et al.: ULTRA-DENSE LEO SATELLITE CONSTELLATIONS: HOW MANY LEO SATELLITES DO WE NEED? 4845 Fig. 1. Ultra-dense LEO-based terrestrial-satellite network. Fig. 2. Illustration of the LEO satellite orbit. period. Finally, we present the coverage model for satellite communications. As shown in Fig. 1, we consider an ultra-dense LEO-based terrestrial-satellite network  consisting of multiple user terminals (UTs) as transmitters and a set of satellites as receivers. To support the seamless coverage for the UT, an ultra-dense LEO satellite constellation is conÔ¨Ågured to ensure that at least one satellite Ô¨Çies over the area of interest at each time slot. We assume that these satellites are operated in N orbital planes of altitude h, denoted by N = {1, 2, . . ., N}, and orbital plane n consists of Mn LEO satellites, denoted by Mn = {1, 2, . . ., Mn}. Each satellite associates with all the UTs in its coverage area, and the UTs share the available bandwidth B over the Ka-band for each LEO satellite equally. A. LEO Satellite Orbit We assume that the orbit of a LEO satellite is circular . In order to describe the orientation of the satellite with respect to the equatorial coordinate system, as illustrated in Fig. 2, the traditional six orbital parameters are introduced as follows. ‚Ä¢ Inclination angle i: the angle of intersection between the orbital plane and the equator. An inclination angle of more than 90‚ó¶implies that the direction of the satellite‚Äôs motion is opposite to that of the Earth‚Äôs rotation. ‚Ä¢ The right ascension of ascending node Œ©: the angle between the vernal equinox and the interactions of the orbital and the equatorial planes. ‚Ä¢ Argument of the perigee œâ: the angle between the ascending node and the perigee, i.e., the point where the satellite is the closest to the Earth, measured along the orbital plane. ‚Ä¢ Eccentricity e: the eccentricity of the orbital ellipse. Since the LEO satellite orbit is assumed to be circular, the eccentricity e is 0. ‚Ä¢ Semi-major axis a: half of the length of the orbit‚Äôs major axis. In the circular orbit case, the semi-major axis a is equal to the radius of the orbit. ‚Ä¢ True anomaly ŒΩ: the geocentric angle between perigee direction and satellite direction. The position of each satellite can be expressed by a function

In this paper, we have considered the ultra-dense LEO satellite constellation deployment to satisfy the backhaul capacity requirement of UTs. We have derived the average total backhaul capacity and the required coverage degree (i.e., kmin) of each UT, based on which an initial constellation deployment guaranteeing global kmin-coverage has been given. To minimize the number of LEO satellites, a three-dimensional constellation optimization algorithm jointly considering the seamless global coverage and the backhaul requirement of UTs has been designed, based on which the corresponding optimized LEO satellite constellation can be obtained for any given coverage ratio requirement. SpeciÔ¨Åcally, three design criteria about backhaul requirement satisfaction, satellite‚Äôs eligibility, and latitude-based eligibility selection have been applied to optimize the LEO satellite constellation. The Cartesian coordinate of each satellite in the optimized LEO satellite constellation can be given explicitly after the proposed

U. Siddique, H. Tabassum, E. Hossain, and D. I. Kim, ‚ÄúWireless backhauling of 5G small cells: Challenges and solution approaches,‚Äù IEEE Wireless Commun., vol. 22, no. 5, pp. 22‚Äì31, Oct. 2015. T. Wang, S. Wang, and Z. Zhou, ‚ÄúMachine learning for 5G and beyond from model-based to data-driven mobile wireless networks,‚Äù China Commun., vol. 16, no. 1, pp. 165‚Äì175, Jan. 2019. X. Ge, H. Cheng, M. Guizani, and T. Han, ‚Äú5G wireless backhaul networks: Challenges and research advances,‚Äù IEEE Netw., vol. 28, no. 6, pp. 6‚Äì11, Nov./Dec. 2014. Y. Ruan, Y. Li, C.-X. Wang, R. Zhang, and H. Zhang, ‚ÄúPerformance evaluation for underlay cognitive satellite-terrestrial cooperative networks,‚Äù Sci. China Inf. Sci., vol. 61, no. 10, pp. 1‚Äì11, Oct. 2018. Z. Zhang et al., ‚ÄúUser activity detection and channel estimation for grant-free random access in LEO satellite-enabled Internet of Things,‚Äù IEEE Internet Things J., vol. 7, no. 9, pp. 8811‚Äì8825, Sep. 2020. N. U. Hassan, C. Huang, C. Yuen, A. Ahmad, and Y. Zhang, ‚ÄúDense small satellite networks for modern terrestrial communication systems: BeneÔ¨Åts, infrastructure, and technologies,‚Äù IEEE Wireless Commun., vol. 27, no. 5, pp. 96‚Äì103, Oct. 2020. C. Huang, A. Zappone, G. C. Alexandropoulos, M. Debbah, and C. Yuen, ‚ÄúReconÔ¨Ågurable intelligent surfaces for energy efÔ¨Åciency in wireless communication,‚Äù IEEE Trans. Wireless Commun., vol. 18, no. 8, pp. 4157‚Äì4170, Aug. 2019. C. Huang et al., ‚ÄúHolographic MIMO surfaces for 6G wireless networks: Opportunities, challenges, and trends,‚Äù IEEE Wireless Commun., vol. 27, no. 5, pp. 118‚Äì125, Oct. 2020. R. Deng, B. Di, and L. Song, ‚ÄúHow capacity is inÔ¨Çuenced by ultradense LEO topology in multi-terminal satellite systems?‚Äù in Proc. IEEE Wireless Commun. Netw. Conf. (WCNC), Seoul, South Korea, May 2020, pp. 1‚Äì6. B. Di, L. Song, Y. Li, and H. V. Poor, ‚ÄúUltra-dense LEO: Integration of satellite access networks into 5G and beyond,‚Äù IEEE Wireless Commun., vol. 26, no. 2, pp. 62‚Äì69, Apr. 2019. M. Werner, A. Jahn, E. Lutz, and A. Bottcher, ‚ÄúAnalysis of system parameters for LEO/ICO-satellite communication networks,‚Äù IEEE J. Sel. Areas Commun., vol. 13, no. 2, pp. 371‚Äì381, Feb. 1995. M. Richharia, ‚ÄúSatellite constellations,‚Äù in Mobile Satellite Communications: Principles and Trends. Hoboken, NJ, USA: Wiley, 2013, pp. 37‚Äì87. D. Beste, ‚ÄúDesign of satellite constellations for optimal continuous coverage,‚Äù IEEE Trans. Aerosp. Electron. Syst., vol. AES-14, no. 3, pp. 466‚Äì473, May 1978. C.-J. Wang, ‚ÄúStructural properties of a low Earth orbit satellite constellation‚Äìthe Walker delta network,‚Äù in Proc. MILCOM-IEEE Mil. Commun. Conf., Boston, MA, USA, Oct. 1993, pp. 968‚Äì972. D. Mortari and M. P. Wilkins, ‚ÄúFlower constellation set theory. Part I: Compatibility and phasing,‚Äù IEEE Trans. Aerosp. Electron. Syst., vol. 44, no. 3, pp. 953‚Äì962, Jul. 2008. M. P. Wilkins and D. Mortari, ‚ÄúFlower constellation set theory part II: Secondary paths and equivalency,‚Äù IEEE Trans. Aerosp. Electron. Syst., vol. 44, no. 3, pp. 964‚Äì976, Jul. 2008. D. Mortari, M. D. Sanctis, and M. Lucente, ‚ÄúDesign of Ô¨Çower constellations for telecommunication services,‚Äù Proc. IEEE, vol. 99, no. 11, pp. 2008‚Äì2019, Nov. 2011. J. Jiang, S. Yan, and M. Peng, ‚ÄúRegional LEO satellite constellation design based on user requirements,‚Äù in Proc. IEEE/CIC Int. Conf. Commun. China (ICCC), Beijing, China, Aug. 2018, pp. 855‚Äì860. I. Meziane-Tani, G. M√©tris, G. Lion, A. Deschamps, F. T. Bendimerad, and M. Bekhti, ‚ÄúOptimization of small satellite constellation design for continuous mutual regional coverage with multi-objective genetic algorithm,‚Äù Int. J. Comput. Intell. Syst., vol. 9, no. 4, pp. 627‚Äì637, Jul. 2016. C. Dai, G. Zheng, and Q. Chen, ‚ÄúSatellite constellation design with multi-objective genetic algorithm for regional terrestrial satellite network,‚Äù China Commun., vol. 15, no. 8, pp. 1‚Äì10, Aug. 2018. T. Savitri, Y. Kim, S. Jo, and H. Bang, ‚ÄúSatellite constellation orbit design optimization with combined genetic algorithm and semianalytical