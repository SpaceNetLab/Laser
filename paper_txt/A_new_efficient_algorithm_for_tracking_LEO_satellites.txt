A New Efficient Algorithm for Tracking LEO Satellites 
Ahmad Khanlari, Member, IEEE, Fatemeh MansourKiaie  
Memorial University of Newfoundland 
St. John’s, Canada 
a.khanlari@mun.ca, f.mansourkiaie@mun.ca   
 
 
 
 
Abstract—The methods of tracking Low Earth Orbit (LEO) 
satellites can be grouped into two different categories: “signal-
based" and "program-based" methods. In this paper, we employ 
a new program-based tracking method to trace satellites, using 
Two Line orbital Elements (TLE). Using TLE is a simple and 
well-known method for tracking satellites; however, this paper 
presents a new algorithm for tracking satellites, based on TLE 
files. This algorithm, uses an available TLE file to estimate the 
satellite’s position and to update the orbital elements, for any 
desired time that we are interested in tracing the satellite. The 
results show that the algorithm is accurate and reliable.  
 Keywords—Program-based tracking; LEO satellites, Orbital 
elements; TLE component.  
I. 
INTRODUCTION 
Along with satellite technology development, researchers 
offered various ways for tracking LEO satellites, but many of 
the presented ways are either expensive or inaccurate. 
Therefore, there is a need to present accurate and inexpensive 
ways for tracking satellites. The purpose of this paper is to 
present a new reliable algorithm for tracking LEO satellites, 
which employs an available TLE file as the primary data and 
predicts satellites’ orbital elements.   
In order to uniquely identify a satellite orbit, we need its 
orbital elements, including a set of six parameters. These six 
parameters are [1]: 
1. Eccentricity (e): This parameter determines how a 
satellite’s orbit deviates from a perfectly circular orbit. 
Indeed, it determines the shape of orbit. 
2. Semi-major axis (a): This parameter defines the size 
of orbit and equals to the sum of apogee and perigee, 
divided by two.  
3. Inclination (i): Inclination determines the vertical tilt 
of the orbit measured at the ascending node, with 
respect to the earth’s equatorial plane. 
4. Right ascension of ascending node ( Ω ): This 
parameter horizontally orients the ascending node of 
the orbit, where it passes upward (with respect to the 
earth’s equatorial plane). 
These two elements (inclination and right ascension of 
ascending node) are used to determine the orientation 
of the orbital plane of a satellite. 
5. Argument of perigee ( w ): This parameter is an angle 
measured from the ascending node to perigee, and 
determines the orientation of the orbit. 
6. True anomaly (θ ): This parameter is an angle 
measured from the perigee to the position of the 
satellite at any given time. True anomaly determines 
the real geometric angle of the satellite.  
These six orbital elements are shown in Fig. 1. 
The NORAD website [2] provides some text files that 
include orbital elements for various satellites. These text files 
are called Two-Line Elements (TLE) files. Although there are 
a few algorithms, such as SGP, SGP4, SDP4, SGP8, and 
SDP8, that use TLE files to track satellites [3], this paper 
presents a new reliable algorithm for tracking LEO satellites, 
using TLE file. 
II. 
PROPOSED ALGORITHM  
    In the suggested algorithm in this paper, an available 
TLE file is used for extracting the initial values of orbital 
elements (semi-major axis, inclination, eccentricity, argument 
of perigee, Right Ascension of Ascending Node (RAAN), and 
True Anomaly (TA)). Using these initial values, the initial 
velocity vector and position vector, are obtained. These initial 
vectors are for the time that the TLE file has been generated. 
Using the initial velocity and position vectors, and Lagrange 
coefficients, the velocity and position vectors for any desired 
time are estimated. Finally, these new vectors are used to 
calculate the orbital elements and to estimate the satellite’s 
location. 
     This algorithm includes the following steps:  
 
Fig. 1.   Orbital elements 
978-1-4673-3108-1/13/$31.00 ©2013 IEEE
Authorized licensed use limited to: Tsinghua University. Downloaded on February 26,2025 at 06:05:51 UTC from IEEE Xplore.  Restrictions apply. 

A. Calculating the initial position vector and velocity vector: 
 Using an available TLE file, the numerical values of 
orbital elements, which are available in the TLE file, are 
extracted. Using these orbital elements, the initial position 
vector and velocity vector will be obtained as follow [4]:                                                                
{ }
⎥
⎥
⎥
⎦
⎤
⎢
⎢
⎢
⎣
⎡
Ω
−
Ω
+
Ω
−
Ω
+
Ω
Ω
Ω
−
Ω
−
Ω
−
Ω
⎪⎭
⎪⎬
⎫
⎪⎩
⎪⎨
⎧
+
=
i
i
w
i
w
i
i
w
w
i
w
w
i
i
w
w
i
w
w
e
h
cos
sin
cos
sin
sin
sin
cos
cos
cos
cos
sin
sin
cos
cos
sin
sin
cos
sin
sin
cos
cos
sin
sin
cos
cos
sin
sin
cos
cos
*
0
sin
cos
*
cos
1
1
r
2
0
θ
θ
θ
μ
(1)
 
 
 
{ }
⎥
⎥
⎥
⎦
⎤
⎢
⎢
⎢
⎣
⎡
Ω
−
Ω
+
Ω
−
Ω
+
Ω
Ω
Ω
−
Ω
−
Ω
−
Ω
⎪⎭
⎪⎬
⎫
⎪⎩
⎪⎨
⎧
+
−
=
i
i
w
i
w
i
i
w
w
i
w
w
i
i
w
w
i
w
w
e
h
cos
sin
cos
sin
sin
sin
cos
cos
cos
cos
sin
sin
cos
cos
sin
sin
cos
sin
sin
cos
cos
sin
sin
cos
cos
sin
sin
cos
cos
*
0
cos
sin
*
v0
θ
θ
μ
(2)
 
where θ is the initial value of true anomaly, e is initial 
eccentricity, w is the initial value of the argument of perigee, h 
is the magnitude of angular momentum, Ω is the initial value of 
RAAN, and μ is the standard gravitational parameter. 
B. Calculating new position and velocity vectors of the 
satellite: 
Using the initial position and velocity vectors, the new 
position and velocity vectors of the satellite will be calculated 
using (3) and (4) [4]: 
                          { }
{ }
{ }
0
0
r
v
g
r
f
+
=
                         (3)   
                          { }
{ }
{ }
0
0
v
v
g
r
f
•
•
+
=
 ,                       (4) 
where f and g  are the Lagrange coefficients. For calculating 
the Lagrange coefficients, the Kepler’s equation is solved 
using Newton’s method. After simplification, we have an 
iterative equation [4] , [5]: 
                          
i
e
i
i
i
i
E
e
M
E
e
E
E
E
cos
1
sin
1
−
−
−
−
=
+
,                  (5) 
where 
e
M  is called mean anomaly and defines the angular 
position of the satellite along the orbit, at a specific time, and e 
is the eccentricity. In  the above equation, E is called eccentric 
anomaly that is obtained by drawing an auxiliary circle of 
the ellipse with center O and focus F, and drawing a line 
perpendicular to the semi major and intersecting it at A. Fig. 2, 
shows the eccentric anomaly. 
     In order to determine the Lagrange coefficients, the 
Kepler’s equation is rewritten in terms of χ  ,
)
(
i
a
S
χ
,
)
(
i
a
C
χ
: 
      
(
)
0
2
0
2
0
0
3
0
2
0
1
)
(
)
1(
)]
(
1[
)
(
)
1(
r
a
C
r
a
S
v
r
t
r
a
S
a
r
a
C
v
r
i
i
i
i
i
ro
i
i
i
i
i
ro
i
i
+
−
+
−
Δ
−
+
−
+
−
=
+
χ
χ
α
χ
αχ
χ
μ
μ
χ
χ
χ
χ
χ
μ
χ
χ
           (6) 
where ‘a’ is the semi-major axis, and 
ro
v
is the radial velocity 
component: 
 
Fig. 2. Definition of eccentric anomaly ( [6] ) 
                                     
o
o
o
ro
r
v
r
v
.
=
 .                                     (7) 
Equation 
(8) 
describes 
the 
relationship 
between
i
χ and
i
E [7]: 
                     
⎪
⎪
⎪
⎩
⎪⎪
⎪
⎨
⎧
−
=
hyperbola
E
a
ellipse
E
a
parabola
h
i
i
i
2
tan θ
μ
χ
  ,             (8) 
where an initial estimation of 
i
χ  can be calculated as:  
                                     
t
a
i
Δ
=
1
0
μ
χ
.                       (9) 
Furthermore,
)
(
i
a
S
χ
 and 
)
(
i
a
C
χ
 are defined as follow [4]:  
              
⎪
⎪
⎪
⎪
⎪
⎩
⎪⎪
⎪
⎪
⎪
⎨
⎧
=
<
−
−
−
−
>
−
=
o
a
o
a
a
a
a
o
a
a
a
a
a
S
i
i
i
i
i
i
i
i
i
i
2
2
3
2
2
2
2
3
2
2
2
6
1
)
(
sinh
)
(
sin
)
(
χ
χ
χ
χ
χ
χ
χ
χ
χ
χ
         (10) 
          
⎪
⎪
⎪
⎪
⎩
⎪
⎪
⎪
⎪
⎨
⎧
=
<
−
−
−
>
−
=
o
a
o
a
a
a
o
a
a
a
a
C
i
i
i
i
i
i
i
i
2
2
2
2
2
2
2
2
1
1
cosh
cos
1
)
(
χ
χ
χ
χ
χ
χ
χ
χ
                 (11) 
These parameters are used to calculate the Lagrange 
coefficients, using the following steps [4]: 
1. In each step, with 
iχ  obtained in the previous step, 
)
(
i
a
S
χ
, 
)
(
i
a
C
χ
, 
)
(
i
f χ
, and 
)
(
i
f
χ
′
will be calculated: 
Authorized licensed use limited to: Tsinghua University. Downloaded on February 26,2025 at 06:05:51 UTC from IEEE Xplore.  Restrictions apply. 

 
              
t
r
a
S
a
r
a
C
v
r
f
i
i
i
i
i
r
i
Δ
−
+
−
+
⎟
⎟
⎠
⎞
⎜
⎜
⎝
⎛
=
μ
χ
χ
χ
χ
χ
μ
χ
0
2
3
0
2
2
0
0
)
(
)
1(
)
(
)
(
  (12) 
 
                   
r
a
C
a
r
a
S
a
v
r
f
i
i
i
i
i
r
i
+
−
+
−
⎟
⎟
⎠
⎞
⎜
⎜
⎝
⎛
=
′
)
(
)
1(
)]
(
1[
)
(
2
2
0
2
2
0
0
χ
χ
χ
χ
χ
μ
χ
           (13) 
 
      If 
)
(
)
(
i
i
f
f
χ
χ
′
 is less than the desired error, this 
i
χ  
will be accepted, and will be used for calculating the Lagrange 
coefficients, using (15) and (16).  Otherwise, the new value 
of
i
χ will be calculated using (14), and the algorithm will 
return 
to 
(10) 
for 
calculating 
new 
values 
of
)
(
i
a
S
χ
,
)
(
i
a
C
χ
,
)
(
i
f χ
, and 
)
(
i
f
χ
′
:   
                             
)
(
)
(
1
i
i
i
i
f
f
χ
χ
χ
χ
′
−
=
+
.                     (14) 
2. Finally, f and g  that are the Lagrange coefficients are 
calculated using (15) and (16): 
                          
)
(
1
2
3
χ
χ
μ
a
S
t
g
−
Δ
=
                   (15) 
                             
)
(
1
2
0
2
χ
χ
a
C
r
f
−
=
,                     (16) 
 where a is the semi major axis that will be calculated as 
follow: 
                                 
μ
2
0
0
2
1
v
r
a
−
=
                           (17) 
•
f  and 
•
g can be calculated using 0r , χ , a  and r: 
                          
)
(
1
2
2
αχ
χ
C
r
g
−
=

                          (18) 
                       
]
)
(
[
2
3
0
χ
αχ
αχ
μ
−
=
S
rr
f
.                  (19) 
After calculating f , g ,
•
f , and 
•
g , the new position vector 
and velocity vector can be calculated using (3) and (4). 
C. Calculating new orbital elements 
After computing new position vector (r) and velocity 
vector (v), new orbital elements that are for any desired time 
will be calculated as follow [8], [9]: 
• for calculating orbital elements, the angular momentum is  
calculated using (20): 
                                   
v
r
h
×
=
                              (20) 
• The inclination is calculated as the second orbital 
elements, using the following equation:  
                                    
⎟⎟
⎠
⎞
⎜⎜
⎝
⎛
=
−
h
hz
1
cos
i
                             (21) 
In the above equation, if
180
90
≤
< i
, the direction of the 
satellite motion is against the direction of the earth motion. 
• The Right Ascension of Ascending Node (RAAN), that is 
the third orbital element, can be calculated using (22):  
                 
⎪
⎪
⎩
⎪
⎪
⎨
⎧
<
−
≥
=
Ω
−
−
0
)
(
c
360
0
)
(
c
1
1
Y
X
Y
X
N
N
N
os
N
N
N
os
         (22) 
where { }
N is a vector between the ascending node and the 
descending node, and is calculated using: 
                                          { }
h
Kˆ
N
×
=
                           (23) 
• In this step, the eccentricity vector and its magnitude will 
be calculated as the fourth orbital element:  
                      
(
)
(
)
2
2
2
2
2
1
rv
rv
rv
e
r
−
+
−
=
μ
μ
μ
           (24) 
• Using h and e, the first orbital element that is the semi-
major axis is calculated:  
                                   
)
1(
2
2
e
h
a
−
=
μ
                     (25) 
• The argument of perigee can be calculated using the 
following equation:  
                       
⎪
⎪
⎩
⎪
⎪
⎨
⎧
<
−
≥
=
−
−
0
)
.
(
c
360
0
)
.
(
c
1
1
z
z
e
e
N
e
N
os
e
e
N
e
N
os
w
      (26) 
In the above equation, if
0
. >
e
N
, the w is located in either 
the first or fourth quadrant. Using the following equation, the 
True Anomaly (TA) can be calculated:   
                    
⎪
⎪
⎩
⎪
⎪
⎨
⎧
<
−
≥
=
−
−
0
)
e.r
(
c
360
0
)
e.r
(
c
1
1
r
r
v
r
e
os
v
r
e
os
θ
         (27) 
III. CHECKING THE ACCURACY OF THE 
SUGGESTED ALGORITHM  
The described algorithm has been written using C++ 
software. In order to check the accuracy of this program, six 
Authorized licensed use limited to: Tsinghua University. Downloaded on February 26,2025 at 06:05:51 UTC from IEEE Xplore.  Restrictions apply. 

TLE files for the IRS-1B satellite are used. Based on the 
available information in these TLE files, the last five TLE files 
that we used are extracted 0.8586, 1.5762, 2.939, 3.9382, and 
5.0156 days after the first TLE file, respectively. 
First, we executed the program using the first TLE file, 
that is downloaded from the NORAD website, to calculate the 
orbital elements of the IRS-1B satellite, after 0.8586, 1.5762, 
2.939, 3.9382, 5.0156 days. After calculating the orbital 
elements, we compared the results of the program with the 
orbital elements that are available in the corresponding TLE 
files, that have been downloaded from the NORAD website. 
In Fig. 3, which is plotted using MATLAB, we compared the 
numerical values of one of the orbital elements (True 
Anomaly) that are extracted using the program for the last four 
days, and the real values of True Anomaly that are available in 
the corresponding TLE files. As the Fig. 3 shows, this 
algorithm precisely predicts the geometric angle of the 
satellite (True Anomaly).  
Table I and table II show the results of the simulation for 
2.939 and 5.0156 days after extracting the first TLE file, and 
compare them with the real values. As the tables show, this 
program is accurate and can precisely predict the orbital 
elements of a satellite, based on an initial TLE file. 
1.5763
2.939 
3.9382
5.0156
129.1911
134.1911
139.1911
144.1911
 
Time (Days)
True Anomaly (Degree)
Simulation
Real Values
 
Fig. 3.  Comparing the values of True Anomaly that are extracted from the 
program, with the values that are available in TLE files. 
TABLE I.  
ORBITAL ELEMENTS EXTRACTED FROM AN AVAILABLE TLE 
FILE AND EXECUTING PROGRAM ON THE PRIMARY TLE (2.9382 DAYS LATER) 
Parameters 
From TLE  
From program 
errors 
Semi major axis  
7282.95 
7282.95 
0% 
Eccentricity  
0.0024287 
0.0024416 
0.53% 
RAAN  
57.0689 
56.2254 
1.48% 
Inclination  
98.8958 
98.8958 
0% 
Argument of Perigee  
336.3878 
342.131 
1.70% 
TA  
145.5506 
145.071 
0.33% 
TABLE II.  
ORBITAL ELEMENTS EXTRACTED FROM AN AVAILABLE TLE 
FILE AND EXECUTING PROGRAM ON THE PRIMARY TLE (5.0156 DAYS LATER) 
Parameters 
From TLE  
From program 
errors 
Semi major axis  
7282.95 
7282.95 
0% 
Eccentricity  
0.0024203 
0.0024416   
0.88% 
RAAN  
59.0781 
58.2254 
1.44% 
Inclination  
98.8958 
98.8958 
0% 
Argument of Perigee  
330.3620 
337.131 
2.04% 
TA  
148.3167 
147.535 
0.53% 
 
IV. 
 CONCLUSION  
   Using TLE files is a well-known method for tracking 
LEO satellites. However, using an available TLE file for 
tracking satellites is not an accurate method, because the TLE 
elements that are available in the web pages are for a special 
time, not for any time that we are interested in tracking a 
satellite. In this article, we employed a new program-based 
tracking algorithm to trace satellites. In this algorithm, an 
available TLE file is used for estimating and creating a new 
TLE file for any desired time that we are interested in tracing 
the satellite. This algorithm is a simple inexpensive method 
that can be used to find the position of a satellite easily. 
Furthermore, the results indicated that this algorithm is 
accurate and reliable. 
REFERENCES  
 
[1] V. Chobotov, Orbital Mechanics. American Institute of Aeronautics and 
Astronautics, 2002. 
[2] T. S. Kelso, “NORAD Two-Line Element Sets,” 2013. [Online]. 
Available: 
http://www.celestrak.com/NORAD/elements/ 
[3] F. R. Hoots and R. L. Roehrich, “Spacetrack report No. 3: Models for 
propagation of NORAD element sets,” TS Kelso, 1988. [Online]. 
Available: http://www.amsat.org/amsat/ftp/docs/spacetrk.pdf 
[4] A. F. Ma, and N. N. Dominikovic, “Three-Axis Stabilized Earth 
Orbiting 
Spacecraft 
Simulator,” 
2012. 
[Online]. 
http://digitalcommons.calpoly.edu/cgi/viewcontent.cgi?article=1101&co
ntext=aerosp 
[5] J. M. Danby, Fundamentals of Celestial Mechanics. Richmond, VA: 
Willmann-Bell, 1988. 
[6] L. Cantafio, Space-Based Radar Handbook. Norwood, MA: Artech 
House, 1989. 
[7] G. Beutler, Methods of Celestial Mechanics. Springe, 2005. Available:  
http://link.springer.com/book/10.1007/b138225/page/1 
[8] O. Montenbruck, and  G. Eberhard, Satellite Orbits: Models, Methods, 
Applications. Heidelberg, Springer, 2005. 
[9] R. Schwarz, “Cartesian State Vectors to Keplerian Orbit Elements,” 
2013. 
[Online]. 
Available: 
http://downloads.rene-
schwarz.com/download/M002-
Cartesian_State_Vectors_to_Keplerian_Orbit_Elements.pdf 
 
 
 
Authorized licensed use limited to: Tsinghua University. Downloaded on February 26,2025 at 06:05:51 UTC from IEEE Xplore.  Restrictions apply. 

