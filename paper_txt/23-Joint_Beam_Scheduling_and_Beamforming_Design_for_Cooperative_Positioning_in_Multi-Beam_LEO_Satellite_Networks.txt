5276
IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 73, NO. 4, APRIL 2024
Joint Beam Scheduling and Beamforming Design for
Cooperative Positioning in Multi-Beam
LEO Satellite Networks
Hongtao Xv
, Graduate Student Member, IEEE, Yaohua Sun
, Yafei Zhao
, Mugen Peng
, Fellow, IEEE,
and Shijie Zhang
Abstractâ€”Cooperative positioning with multiple low earth orbit
(LEO) satellites is promising in providing location-based services
and enhancing satellite-terrestrial communication. However, po-
sitioning accuracy is greatly affected by inter-beam interference
and satellite-terrestrial topology geometry. To select the best com-
bination of satellites from visible ones and suppress inter-beam
interference, this paper explores the utilization of ï¬‚exible beam
scheduling and beamforming of multi-beam LEO satellites that can
adjust beam directions toward the same earth-ï¬xed cell to send po-
sitioning signals simultaneously. By leveraging CramÃ©r-Rao lower
bound (CRLB) to characterize user Time Difference of Arrival
(TDOA) positioning accuracy, the concerned problem is formu-
lated, aiming at optimizing user positioning accuracy under beam
scheduling and beam transmission power constraints. To deal with
the mixed-integer-nonconvex problem, we decompose it into an
inner beamforming design problem and an outer beam scheduling
problem. For the former, we ï¬rst prove the monotonic relationship
between user positioning accuracy and its perceived signal-to-
interference-plus-noise ratio (SINR) to reformulate the problem,
and then semideï¬nite relaxation (SDR) is adopted for beamforming
design. For the outer problem, a heuristic low-complexity beam
scheduling scheme is proposed, whose core idea is to schedule users
with lower channel correlation to mitigate inter-beam interference
while seeking a proper satellite-terrestrial topology geometry. Sim-
ulation results verify the superior positioning performance of our
proposed positioning-oriented beamforming and beam scheduling
scheme, and it is shown that average user positioning accuracy
is improved by 17.1% and 55.9% when the beam transmission
power is 20 dBw, compared to conventional beamforming and beam
scheduling schemes, respectively.
Index Termsâ€”Multi-beam low earth orbit (LEO) satellite,
cooperative time difference of arrival (TDOA) positioning,
positioning-oriented beamforming and beam scheduling.
Manuscript received 1 February 2023; revised 27 June 2023 and 27 September
2023; accepted 1 November 2023. Date of publication 20 November 2023; date
of current version 22 April 2024. This work was supported in part by the National
Natural Science Foundation of China under Grants 62371071 and 62001053, and
in part by the Young Elite Scientists Sponsorship Program by CAST under Grant
2021QNRC001. The review of this article was coordinated by Prof. Xianbin
Wang. (Corresponding author: Yaohua Sun.)
Hongtao Xv, Yaohua Sun, Yafei Zhao, and Mugen Peng are with the
State Key Laboratory of Networking and Switching Technology, Beijing
University of Posts and Telecommunications, Beijing 100876, China (e-
mail: htxu@bupt.edu.cn; sunyaohua@bupt.edu.cn; zhaoyafei@bupt.edu.cn;
pmg@bupt.edu.cn).
Shijie Zhang is with the Beijing University of Posts and Telecommunications
and Yinhe Hangtian, Beijing Internet Technology Co., Ltd., Beijing 100876,
China (e-mail: zsj@yinhe.ht).
Digital Object Identiï¬er 10.1109/TVT.2023.3332142
I. INTRODUCTION
W
ITH the evolution of small satellite platform manufac-
ture and space launch technology, dense LEO satel-
lite constellations will come into being, such as Starlink and
OneWeb [1], [2]. In such constellations, multiple LEO satel-
lites can simultaneously cover a ground user, which facil-
itates providing more enhanced services, including satellite
edge computing [3] and high precision user positioning [4].
For the latter, multiple satellites can send positioning sig-
nals to the same user or cell to improve Geometric Dilu-
tion of Precision (GDOP), convergence speed, and pseudo-
range measurement accuracy, where cooperative satellite beam
scheduling and beamforming design are the fundamental
issues.
Owing to the development of software-deï¬ned payloads,
satelliteonboardcommunicationresourcescanbescheduledand
conï¬gured on demand. An LEO satellite can ï¬‚exibly adjust the
serving relationship between beams and earth-ï¬xed cells [5],
following a speciï¬c time-space transmission plan. Such ï¬‚exi-
bility in beam scheduling enables a good match between limited
network resources and heterogeneous service demands, thereby
greatly enhancing system utility [6], [7]. The design of beam
scheduling usually involves binary variables, which makes the
problem fall into the category of integer programming that is
difï¬cult to solve. The authors of [8] made use of the Semi-
Deï¬nite Programming (SDP) technique and presented a heuris-
tic algorithm to provide a solution rapidly. Aiming to achieve
global optimal beam scheduling, the authors of [9] employed a
simulated annealing method at the expense of high computation
complexity. Considering the unknown dynamics of the satellite
communication environment, a model-free deep reinforcement
learning-based approach was proposed to learn the optimal beam
scheduling plan [10]. However, these previous works ignore the
potential co-frequency interference among beams. To further re-
duce the inter-beam interference, literature [11] provided a novel
joint beam scheduling and SVD-based beamforming approach
to suppress inter-beam interference. The authors in [12], [13],
[14] adopted SDR to reformulate the co-channel interference
suppression problem and conducted successive convex approxi-
mation (SCA) to optimize the beamformer. In a similar vein,
the authors in [3] adopted Lyapunov optimization theory to
solve the problems of binary association and beamforming to
0018-9545 Â© 2023 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission.
See https://www.ieee.org/publications/rights/index.html for more information.
Authorized licensed use limited to: Tsinghua University. Downloaded on September 02,2024 at 10:51:33 UTC from IEEE Xplore.  Restrictions apply. 

XV et al.: JOINT BEAM SCHEDULING AND BEAMFORMING DESIGN FOR COOPERATIVE POSITIONING
5277
maximize the data rate. Moreover, literature [8] jointly
considered beam scheduling design and Zero Forcing (ZF)
beamforming under per feed power constraint at the satellite.
The above works on satellite beam scheduling and beam-
forming mainly focus on satisfying user communication de-
mands. However, multi-beam LEO satellite systems need to
take advantage of positioning and provide positioning informa-
tion services in the future [15]. Compared with GNSS, which
relies on satellites mainly operating in medium earth orbits,
the free space loss with LEO satellites is much lower. The
received power on the ground can be improved by more than
30 dB under the same transmission power [16], which makes
it easier for us to capture and track positioning signals. Apart
from providing location-based services, position information
is also essential for enhancing communication services. In the
physical layer, positioning information can be used for improv-
ing carrier frequency offset estimation in uplink orthogonal
frequency division multiple access systems [17]. In the net-
working layer, a user terminal (UT) can leverage its position
information to trigger a handover procedure between satellites
actively [18].
A well-known methodology for positioning is the time dif-
ference of arrival (TDOA) technique [19]. In this paradigm, a
UT calculates the difference between the times at which the
signals of a pair of satellites arrive at the UT. For each pair
of satellites, TDOA provides a hyperbolic map plot of possible
UT positions [20]. Each additional satellite pair provides an-
other intersecting hyperbola, further reï¬ning the UT position.
To assess TDOA performance [21], [22], [23], [24], [25], the
metric for benchmarking any unbiased estimators, CRLB, is
generally used. There has been some research on optimizing
TDOA positioning performance by beamforming and beam
scheduling in terrestrial and satellite networks. The authors
of [26] optimized beamforming vectors at base stations (BSs) to
minimize the power expenditure under data rate and positioning
accuracy constraints, where multiple BSs with multiple antennas
communicate with multiple single-antenna UTs. Literature [27]
proposed a method to decrease the overlap of estimated positions
as well as increase the accuracy of TDOA positioning by using
beamforming at BSs. In LEO satellite systems, the authors
of [28] investigated the beam scheduling problem and designed
a novel beam hopping framework to optimize positioning per-
formance.
Overall,thejointdesignofbeamformingandbeamscheduling
for positioning in multi-beam LEO satellite systems still needs
to be explored, which is technically challenging for several
reasons. First, with the number of visible satellites increasing,
it becomes intractable to quickly select serving satellites for
UTs/cells to maximize positioning accuracy. Second, consider-
ing full frequency reuse (FFR) among satellite beams [29], [30],
inter-beam interference becomes critical, and the radio ranging
measurement accuracy can signiï¬cantly degrade as SINR gets
lower. Third, mitigating inter-beam interference also imposes
higherrequirementsonbeamschedulingdesign,andmeanwhile,
proper satellite-terrestrial topology geometry should also be
formed by beam schedule. Our main contributions are summa-
rized as follows.
TABLE I
SYMBOL SUMMARY
r A novel multi-beam LEO satellite network scenario for co-
operative UT positioning is considered, where each satel-
lite can generate multiple beams using a planar antenna
array, and each UT can receive positioning signals sent by
beams from numerous satellites. Using CRLB to character-
ize the TDOA positioning accuracy of a single UT, we for-
mulate the problem of joint satellite beam scheduling and
beamforming design, aiming at optimizing UT positioning
accuracy under per-beam transmission power constraint
and the constraint on the number of serving beams for each
UT.
r To deal with the non-convex mixed-integer problem, it is
decomposed into an inner beamforming design problem
and an outer beam scheduling problem. For the former, we
proposeaUTSINRthresholdadjustment basedbeamform-
ing algorithm with the SDR technique, which is inspired
by the monotonic relationship between the positioning
accuracy of a single UT and its perceived SINR. For the
latter, a fast and efï¬cient greedy heuristic beam scheduling
algorithm that changes the value of a 0-1 variable from 0
to 1 in each round of iteration is developed, considering
the trade-off between channel correlation and UT-satellite
topology geometry.
r Extensive numerical evaluations are carried out, where our
proposal is compared with conventional beamforming and
GDOP-based beam scheduling schemes under different
beam transmission powers and the numbers of visible
satellites. It is shown that average user positioning accuracy
can be improved by 17.1% and 55.9%, respectively.
The remainder of the paper is organized as follows. Section II
presents the system model and the concerned positioning ac-
curacy optimization problem. Section III details the design of
the beamforming algorithm. In Section IV, the beam scheduling
problem is solved. Simulation results are given in Section V,
and the conclusion is drawn in Section VI. Essential symbols
are summarized in Table I.
We use the following notation throughout this paper: X is a
matrix; x is a vector; x is a scalar; X(:, j) is the j-th column
Authorized licensed use limited to: Tsinghua University. Downloaded on September 02,2024 at 10:51:33 UTC from IEEE Xplore.  Restrictions apply. 

5278
IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 73, NO. 4, APRIL 2024
Fig. 1.
Multi-beam LEO satellite system scenario for cooperative UT posi-
tioning.
of X; X(i, j) is the element in the i-th row and j-th column of
X; The transpose and conjugate transpose of X are represented
by XT and XH, respectively; IN is the N Ã— N identity matrix;
rank(X) denotes the rank of X; Xâˆ’1 is the inverse of X; Î»i(X)
denotes the i-th eigenvalue of X; tr(X) indicates the trace of
X; ||x||2 is 2-norm of x; CmÃ—n denotes an m by n dimensional
complex space; Kronecker product is denoted by âŠ—; E is the
expectation operator; âˆ‚f
âˆ‚x is used to denote the partial derivative
of function f with respect to x.
II. SYSTEM MODEL AND PROBLEM FORMULATION
A. System Model
The LEO satellite communication system scenario for coop-
erative UT positioning is shown in Fig. 1. To realize centralized
control and coordinate satellites, if the reference satellite has
powerful computing capability and connects to other satel-
lites through inter-satellite links (ISLs), the positioning-oriented
beam scheduling and beamforming algorithms are executed at
this satellite, whose results are fed back to other satellites via
ISLs. Otherwise, the gateway (GW), covering the cooperative
LEO satellites simultaneously, is responsible for executing these
algorithms and forwards the results to satellites via feeder links.
Each satellite is equipped with a uniform planar array (UPA)
composed of N = NxNy antennas, where Nx and Ny are the
numbers of antennas on the x and y axis, respectively, and it
is assumed that each satellite can generate at most K beams.
By sending positioning signals on time-frequency resource
that is orthogonal to the resource used for normal communi-
cation services, multiple satellites can cooperatively provide
UT positioning capability. There are multiple single-antenna
UTs distributed in C earth-ï¬xed cells whose set is denoted by
C = {1, 2, . . ., C}, and denote the set of LEO satellites visible
to the cells by I = {1, 2, . . ., I}. Further, it is assumed that
there is one UT in each cell for simplicity, and hence we use
UT c to represent the UT located in cell c in the following.
Deï¬ne Î´i,c = 1 if satellite i schedules a beam to serve UT c, and
Î´i,c = 0 otherwise. The set of satellites serving UT c and the
set of UTs served by satellite i are denoted as Ic = {i|Î´i,c = 1}
and Ci = {c|Î´i,c = 1}, respectively.
The beamforming vector of satellite i for UT c is denoted as
wi,c âˆˆCNÃ—1 and the collection of all beamforming vectors is
denoted as Wi âˆˆCNÃ—|Ci|. Then, the discrete-time transmitted
navigation signal of satellite i is therefore given by xi = Wini,
where ni is the |Ci| Ã— 1 symbol vector consisting of the navi-
gation signal ni,c for UT c with E

ninH
i

= I|Ci|. Suppose that
proper frequency reuse is utilized among satellites so there is
no inter-satellite interference. In contrast, intra-satellite interfer-
ence exists due to full frequency reuse among beams of the same
satellite. Therefore, the received signal of UT c from satellite i
is given by
yi,c = hT
i,cwi,cni,c +

câ€²âˆˆCi,câ€²Ì¸=c
hT
i,cwi,câ€²ni,câ€² + Ë†yi,c,
(1)
where hi,c âˆˆCNÃ—1 is the channel vector between satellite i
and UT c, and Ë†yi,c âˆ¼N

0, Ïµ2
c

is white Gaussian noise. Then,
the SINR of UT c when receiving the positioning signal from
satellite i is given by
SINRi,c =
|hT
i,cwi,c|2

câ€²âˆˆCi,câ€²Ì¸=c |hT
i,cwi,câ€²|2 + Ïµ2c
,
i âˆˆIc.
(2)
Considering the clock asynchronous problem, the signal from
a reference satellite is used as the reference measurement for all
UTs. With the knowledge of satellite positions acquired from
the ephemeris, UTs use TDOA measurements for positioning.
Speciï¬cally, UT c uses the signal from satellite i âˆˆIc to estimate
time of arrival (TOA) and calculates the time difference between
TOAs of satellite i and the reference satellite. Then, UT c esti-
mates its own position with the observation equations of TDOA.
According to [21], [31], for UT c and satellite i, the CRLB of
TOA measurement under an AWGN channel is calculated by
Ïƒ2
i,c =
3
4Ï€2B2SINRi,c
,
(3)
where B is the bandwidth of satellite iâ€™s beam [32].
Denote the positions of UT c, satellites i and the refer-
ence satellite as sc = [xc, yc, zc]T , si = [xi, yi, zi]T and s0 =
[x0, y0, z0]T , respectively. Then, the distance di,c between satel-
lite i and UT c can be expressed as
di,c = âˆ¥sc âˆ’siâˆ¥2.
(4)
Thus, UT c can get TDOA measurements for satellite i and the
reference satellite as
TDOAi,c = 1
v (di,c âˆ’d0,c) + (TOAi,c âˆ’TOA0,c)
= Gi,c(sc) + (TOAi,c âˆ’TOA0,c),
(5)
Authorized licensed use limited to: Tsinghua University. Downloaded on September 02,2024 at 10:51:33 UTC from IEEE Xplore.  Restrictions apply. 

XV et al.: JOINT BEAM SCHEDULING AND BEAMFORMING DESIGN FOR COOPERATIVE POSITIONING
5279
where v is the speed of light, Gi,c(sc) = 1
v(di,c(sc) âˆ’d0,c(sc)),
TOAi,c and TOA0,c are the TOA measurement and TOAi,c âˆ¼
N(0, Ïƒ2
i,c). As a result of the fact of a common refer-
ence satellite, TDOA measurements are correlated. Denote
the indexes of satellites serving UT c as i1, i2, . . . , i|Ic|, the
variance of TOAi1,c âˆ’TOA0,c is Ïƒ2
i1,c + Ïƒ2
0,c and TDOAc =
[TDOAi1,c, TDOAi2,c, . . . , TDOAi|Ic|,c]T has a joint conditional
Gaussian distribution with covariance matrix Rc given as
Rc =
â¡
â¢â¢â¢â£
Ïƒ2
0,c + Ïƒ2
i1,c
Ïƒ2
0,c
Â· Â· Â·
Ïƒ2
0,c
Ïƒ2
0,c
Ïƒ2
0,c + Ïƒ2
i2,c
Â· Â· Â·
Ïƒ2
0,c
...
...
...
...
Ïƒ2
0,c
Ïƒ2
0,c
Â· Â· Â·
Ïƒ2
0,c + Ïƒ2
i|Ic|,c
â¤
â¥â¥â¥â¦.
The measurement equation for the measurement vector TDOAc
is given by
TDOAc = Gc(sc) + uc, uc âˆ¼N(0, Rc),
(6)
where Gc(sc) = [Gi1,c(sc), Gi2,c(sc), . . . , Gi|Ic|,c(sc),c]T .
The CRLB for TDOA positioning equals the inverse of the
Fisher information J [33] as
CRLBc
= tr(Jâˆ’1) = tr
â›
â
âˆ‚Gc(sc)
âˆ‚sc
T
Râˆ’1
c
âˆ‚Gc(sc)
âˆ‚sc
âˆ’1â
â 
= tr((AT
c Râˆ’1
c Ac)âˆ’1).
(7)
Ac represents the Jacobian matrix of Gc with regard to sc, which
is given by
Ac = âˆ‚Gc(sc)
âˆ‚sc
= 1
v

ai1,c, . . . , ai|Ic|,c
T ,
ai,c = scâˆ’si
di,c âˆ’a0,c, and a0,c = scâˆ’s0
d0,c . The position error in
meters for UT c is ï¬nally computed as âˆšCRLBc [31].
B. Channel Model
Particularly, the free space path loss is considered to construct
the channel model. According to [12], [13], [14], the channel
vector from satellite i to UT c is modeled as
hi,c =

Li,cejÎ¸i,cvi,c,
(8)
where Î¸i,c is the phase vector with uniform distribution over
[0, 2Ï€), Li,c is the free space loss given by
Li,c(dB) = 20lg(f) + 20lg(di,c) + 32.4,
(9)
and vi,c is the UPA response vector. Based on [34], the UPA
response vector vi,c can be further calculated as
vi,c = vx

Î¸x
i,c

âŠ—vy

Î¸y
i,c

,
(10)
vx

Î¸x
i,c

=
1
Nx

1, eâˆ’jÏ€Î¸x
i,c, . . ., eâˆ’jÏ€(Nxâˆ’1)Î¸x
i,c
T
,
vy

Î¸y
i,c

= 1
Ny

1, eâˆ’jÏ€Î¸y
i,c, . . ., eâˆ’jÏ€(Nyâˆ’1)Î¸y
i,c
T
,
where vx and vy are the array response vector of the angle
with respect to the x and y-axis. The parameter Î¸x
i,c and Î¸y
i,c
are related to physical angles via Î¸x
i,c = sin(Ï•y
i,c) cos(Ï•x
i,c) and
Î¸y
i,c = cos(Ï•y
i,c), where Ï•x
i,c and Ï•y
i,c are the angles with respect
to the x and y axis associated with the propagation path from
i-th satellite to UT c.
C. Problem Formulation
The positioning-oriented beam scheduling and beamforming
design is formulated as the following problem, aiming to opti-
mize UT TDOA positioning accuracy, which is given by
P0 :
min
{wi,c},{Î´i,c}
C

c=1
Fc (Rc ({wi,c}, {Î´i,c}) , Ac ({Î´i,c}))
s.t. C1 :
C

c=1
Î´i,c â‰¤K, âˆ€i âˆˆI,
C2 :

iâˆˆI
Î´i,c = ITDOA, âˆ€c âˆˆC,
C3 : Î´i,c âˆˆ{0, 1}, âˆ€i âˆˆI, âˆ€c âˆˆC,
C4 : ||wi,c||2
2 = P Â· Î´i,c, âˆ€i âˆˆI, âˆ€c âˆˆC,
(11)
where Fc = CRLBc. Constraint C1 states that each satellite
can generate at most K beams simultaneously due to limited
hardwarecapability.ConstraintC2 ensuresthateachUTreceives
positioning signals from ITDOA beams from different satellites
alongsidethereferencesatellite.ConstraintC3 meansÎ´i,c isa0-1
indicator variable. Constraint C4 is the beam transmission power
constraint, and wi,c is an all-zero column vector of dimension
N when Î´i,c = 0.
III. DYNAMIC UT SINR THRESHOLD ADJUSTMENT BASED
SATELLITE BEAMFORMING
In (11), we seek to ï¬nd beamforming design {wi,c} and beam
scheduling plan {Î´i,c} that optimize user positioning accuracy.
Unfortunately, ï¬nding a globally optimal solution in polynomial
time is impossible due to the non-convex objective function and
mixed-integer structure. To make the problem more tractable, in
thissection,weï¬rstdealwithpositioning-orientedbeamforming
under any pre-ï¬xed {Î´i,c}, and the corresponding problem is
given as
P1 : min
{wi,c}
C

c=1
Fc({wi,c}|{Î´i,c})
s.t. C4 : ||wi,c||2
2 = P Â· Î´i,c, âˆ€i âˆˆI, âˆ€c âˆˆC.
(12)
In the following proposition, we ï¬rst highlight the intrin-
sic relationship between UTâ€™s positioning accuracy and UTâ€™s
perceived SINR from a single satellite to guide beamforming
algorithm design.
Proposition 1: Fc is monotonically decreasing with respect
to SINRi,c with the gradient of Fc with respect to SINRi,c given
Authorized licensed use limited to: Tsinghua University. Downloaded on September 02,2024 at 10:51:33 UTC from IEEE Xplore.  Restrictions apply. 

5280
IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 73, NO. 4, APRIL 2024
Fig. 2.
Spatial relationships among UT c and satellites.
by
âˆ‚Fc
âˆ‚SINRi,c
= âˆ’3tr(Râˆ’1
c (i, :)Ac(AT
c Râˆ’1
c Ac)âˆ’2AT
c Râˆ’1
c (:,i))
4Ï€2B2SINR2
i,c
,
(13)
where satellite i is thei-th satellite in set Ic serving UT c, Ac is a
column full rank matrix with probability one and Rc is positive
deï¬nite.
Proof: First, we leverage Fig. 2 to prove that Ac is a column
full rank matrix with probability one when |Ic| = 3 by contra-
diction. As shown in Fig. 2, O, i0, i1, i2, i3 are the positions of
UT c, the reference satellite and satellite i1, i2, i3. O0, O1, O2, O3
are the intersection points of line Oi0, Oi1, Oi2, Oi3 with the
unit sphere whose center is O, respectively. The satellites
are assumed to be distributed in sphere P1 following a two-
dimensional distribution with a probability density function.
Since the column of AT
c , ai,c = scâˆ’si
di,c âˆ’scâˆ’s0
d0,c , represents the
difference between the unit vectors pointing to satellite i and
the reference satellite from UT, i.e. âˆ’âˆ’â†’
OOi âˆ’âˆ’âˆ’â†’
OO0, a1,c, a2,c and
a3,c correspond to âˆ’âˆ’âˆ’â†’
O0O1, âˆ’âˆ’âˆ’â†’
O0O2 and âˆ’âˆ’âˆ’â†’
O0O3, respectively. If Ac
is not a full rank matrix, a3,c can be represented as a linear
combination of a1,c and a2,c, which means âˆ’âˆ’âˆ’â†’
O0O3 should lie in
plane P2 which is spanned by âˆ’âˆ’âˆ’â†’
O0O1 and âˆ’âˆ’âˆ’â†’
O0O2. As âˆ’âˆ’â†’
OO3 is a
unit vector, O3 should lie in circle L1, the intersecting curve of
the unit sphere and plane P2. Further, as O3 is the intersection
point of the line Oi3 with the unit sphere, we can conclude that
the point i3 falls on circle L2, the projection of circle L1 onto
sphere P1 on the basis of O. However, the probability that the
point i3 falls onto circle L2 is zero because the probability equals
the integration of a 2-dimensional probability density function
over the 1-dimensional curve. Since a contradiction occurs, the
assumption that Ac is not a full rank matrix does not hold.
Similarly, we can select 3 linearly independent columns from
AT
c to prove that rank(Ac) = 3 when |I| > 3, which means Ac
is a column full rank matrix.
Next, we show that Rc is positive deï¬nite. Rc in (7) can be
re-written as Rc = Uc + Vc as follows:
Uc =
â¡
â¢â¢â¢â¢â£
Ïƒ2
0,c
Ïƒ2
0,c
Â· Â· Â·
Ïƒ2
0,c
Ïƒ2
0,c
Ïƒ2
0,c
Â· Â· Â·
Ïƒ2
0,c
...
...
...
...
Ïƒ2
0,c
Ïƒ2
0,c
Â· Â· Â·
Ïƒ2
0,c
â¤
â¥â¥â¥â¥â¦
and
Vc =
â¡
â¢â¢â¢â¢â£
Ïƒ2
i1,c
0
Â· Â· Â·
0
0
Ïƒ2
i2,c
Â· Â· Â·
0
...
...
...
...
0
0
Â· Â· Â·
Ïƒ2
i|Ic|,c
â¤
â¥â¥â¥â¥â¦
.
The eigenvalues of Uc and Vc equal Ïƒ2
0,c, 0, . . . , 0 and
Ïƒ2
i1,c, Ïƒ2
i2,c, . . . , Ïƒ2
i|Ic|,c, respectively. Applying the Rayleigh-
Ritz quotient result in [35], we can conclude that for any
|I|-dimensional vector x, 0 â‰¤xHUcx
xHx
â‰¤Ïƒ2
0,c and mini Ïƒ2
i,c â‰¤
xHVcx
xHx
â‰¤maxi Ïƒ2
i,c. Thus,
xH(Uc + Vc)x
xHx
â‰¥min
i
Ïƒ2
i,c > 0,
which means Rc is positive deï¬nite.
Further, to derive the closed-form expression of
âˆ‚Fc
âˆ‚SINRi,c , we
deï¬ne Ïƒ2
i,c = Ïƒ2
i,c + Î”2. Accordingly, Fc and Rc change to
Fc and Rc, respectively. Denote vi = [0, . . . , Î”, . . . , 0]T as a
vector where only thei-th component equals Î” and all the others
are zero. Then, using the fact that
(X + xyT )âˆ’1 = Xâˆ’1 âˆ’Xâˆ’1xyT Xâˆ’1
1 + yT Xâˆ’1x
for any vector x, y âˆˆC|I|Ã—1 and non-singular matrix X, the
expression of Rc can be written as
Rc = (Rc + vivT
i )âˆ’1
= Râˆ’1
c
âˆ’Î”2Râˆ’1
c (:,i)Râˆ’1
c (i, :)
1 + Î”2Râˆ’1
c (i,i)
Î”2â†’0
===== Râˆ’1
c
âˆ’Î”2Râˆ’1
c (:,i)Râˆ’1
c (i, :).
(14)
By substituting (14) into (7), we have
Fc = tr((AT
c Râˆ’1
c Ac)âˆ’1) + Î”2tr(zT
i,c(AT
c Râˆ’1
c Ac)âˆ’2zi,c).
(15)
Then,
âˆ‚Fc
âˆ‚Ïƒ2
i,c
= lim
Î”2â†’0
Fc âˆ’Fc
Î”2
= tr(zT
i,c(AT Râˆ’1A)âˆ’2zi,c),
(16)
where zi,c = AT
c Râˆ’1
c (:,i). By substituting (3) into (16) and
applying the chain rule, we can get
âˆ‚Fc
âˆ‚SINRi,c
= âˆ’3tr(zT
i,c(AT
c Râˆ’1
c Ac)âˆ’2zi,c)
4Ï€2B2SINR2
i,c
.
(17)
Since both Ac and AT
c Râˆ’1
c (:,i) are column full rank matri-
ces, Râˆ’1
c (i, :)Ac(AT
c Râˆ’1
c Ac)âˆ’2AT
c Râˆ’1
c (:,i) is also positive
Authorized licensed use limited to: Tsinghua University. Downloaded on September 02,2024 at 10:51:33 UTC from IEEE Xplore.  Restrictions apply. 

XV et al.: JOINT BEAM SCHEDULING AND BEAMFORMING DESIGN FOR COOPERATIVE POSITIONING
5281
deï¬nite for positive deï¬nite matrix Rc [36], which means
âˆ‚Fc
âˆ‚SINRi,c < 0.
â– 
Proposition 1 reveals the monotonic relationship between UT
SINR of receiving the signal sent by one beam and its positioning
accuracy under a speciï¬c UT-satellite-topology, and it inspires
us to gradually improve SINRi,c to enhance overall positioning
performance. To this end, we deï¬ne Î³i,c as the threshold for
SINRi,c, i.e. Î³i,c â‰¤SINRi,c, and successively raise Î³i,c with
equal step size. Speciï¬cally, we raise up Î³i,c for one UT based
on the derived gradient (17) as
Î³i,c = Î³i,c + Î³0, c = arg min
câ€²âˆˆCi
âˆ‚Fcâ€²
âˆ‚SINRi,câ€² .
(18)
For each update, the following problem is solved to check
whether the new {Î³i,c}câˆˆCi is feasible.
P2 :
max
t,{wi,c}câˆˆCi
t
s.t.
|hT
i,cwi,c|2

câ€²Ì¸=c |hT
i,cwi,câ€²|2 + Ïµ2c
â‰¥t Â· Î³i,c, c âˆˆCi,
wH
i,cwi,c = P, c âˆˆCi,
(19)
If tâˆ—â‰¥1, it is feasible and we can continue to raise Î³i,c with
(18), while tâˆ—< 1 otherwise.
Note that problem (19) can be well solved by SDR [37], [38]
by converting it into the following form:
P3 :
max
t,{Qi,c}câˆˆCi
t
s.t.
1
Î³i,c
tr(Hâ€²T
i,cQi,c)

câ€²Ì¸=c tr(Hâ€²T
i,cQi,câ€²) + Ïµ2c
â‰¥t, c âˆˆCi,
tr(Qi,c) = P, c âˆˆCi,
rank(Qi,c) = 1, c âˆˆCi,
(20)
where Hâ€²i,c = hi,chH
i,c, Qi,c = wi,cwH
i,c, and the only non-
convex constraint rank(Qi,c) = 1 can be relaxed. In this way,
problem (20) can be solved as a general convex optimization
problem. The results of the original problem(19) can be obtained
by applying rank-one approximation based on the results of
problem (20) via wâˆ—
i,c =
âˆš
Î»âˆ—bâˆ—, where Î»âˆ—and bâˆ—are the the
largest eigenvalue and respective eigenvector of Qâˆ—
i,c, respec-
tively.
Our basic description of dynamic UT SINR threshold adjust-
ment (DSTA) based beamforming algorithm is now complete,
whose detail is summarized in Algorithm 1, which assumes
T different values for Î³i,c with an equal step size. Compared
with the algorithm in [38], which has the same search space
size, Algorithm 1 reduces the number of iterations from KT to
K Â· T. In addition, the SDR technique can be used to produce
an approximated solution to (20) with a complexity of O((N Â·
K)3.5) [37]. Since we need to adjust the SINR threshold Î³i,c at
most O(K Â· T) times with (17), the overall time complexity of
Algorithm 1 is no more than O(N 3.5 Â· K4.5 Â· T) for each satel-
lite, which is polynomial in N.
Algorithm 1: DSTA-based Satellite Beamforming Algo-
rithm.
Input: hi,c, Ac, Î´i,c, Ïµ2
c, âˆ€i âˆˆI, âˆ€c âˆˆC
Output: wi,c, âˆ€i âˆˆI, âˆ€c âˆˆCi
1: for satellite i âˆˆI do
2:
Initialize Î³i,c = Î³â€², c âˆˆCi, and all Î³i,c are set to be
feasible to raise.
3:
for UT c âˆˆCi do
4:
Compute
âˆ‚Fc
âˆ‚SINRi,c according to (17).
5:
end for
6:
while there exists Î³i,c which is feasible to raise and
Î³i,c < Î³max do
7:
Select c = arg min
câ€²
âˆ‚Fcâ€²
âˆ‚SINRi,câ€² .
8:
Update Î³i,c = Î³i,c + Î³0.
9:
Solve problem (20) by SDR to get tâˆ—and Qâˆ—
i,c.
10:
if tâˆ—â‰¥1 then
11:
Update SINRi,c according to (2).
12:
Update
âˆ‚Fc
âˆ‚SINRi,c according to (17).
13:
else
14:
Update Î³i,c = Î³i,c âˆ’Î³0, and set Î³i,c to be
infeasible to raise.
15:
end if
16:
end while
17:
Apply rank-one approximation of Qâˆ—
i,c to get wâˆ—
i,c.
18: end for
IV. BEAM SCHEDULING ALGORITHM DESIGN
After ï¬nishing the beamforming design under any pre-ï¬xed
beam scheduling, the next part of this paper considers the beam
scheduling optimization problem, which is expressed as
P4 : min
{Î´i,c}

câˆˆC
Fc({Î´i,c}, {wâˆ—
i,c({Î´i,c})})
s.t. C1 :
C

c=1
Î´i,c â‰¤K, i âˆˆI,
C2 :

iâˆˆI
Î´i,c = ITDOA, âˆ€c âˆˆC,
C3 : Î´i,c âˆˆ{0, 1}, i âˆˆI, âˆ€c âˆˆC.
(21)
Considering the coupling of beam scheduling and beamform-
ing design, a straightforward way to solve the above problem
is to design a two-layer iterative algorithm, where the outer
layer optimizes beam scheduling while the inner layer optimizes
beamforming under ï¬xed beam scheduling with our proposed
DSTA-based beamforming algorithm. The outer layer solves a
0-1 programming, and particle swarm optimization or branch-
and-bound method can be adopted. Nevertheless, such a design
can incur high complexity, which is undesirable for practi-
cal implementation. Hence, in this paper, a fast and efï¬cient
beam scheduling algorithm is designed, which decouples beam
scheduling from beamforming and only relies on channel state
information and satellite ephemeris. To guide the design, we ï¬rst
Authorized licensed use limited to: Tsinghua University. Downloaded on September 02,2024 at 10:51:33 UTC from IEEE Xplore.  Restrictions apply. 

5282
IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 73, NO. 4, APRIL 2024
examine an approximated expression of Fc to intuitively show
the impacts of beam scheduling on UT positioning performance.
Proposition
2: When
Ïƒ2
0,c
is
small
enough,
Fc =
tr
â›
â


iâˆˆIc
ai,caT
i,c
Ïƒ
2
i,c
âˆ’1â
â 
can
approximate
the
positioning
performance Fc of UT c.
Proof: First,
we
show
that
the
inequality
xT Xx â‰¤
âˆ¥xâˆ¥2
2tr(X) holds for any x and positive deï¬nite matrix X. The
eigenvalue decomposition of positive deï¬nite matrix X can
be expressed as R
r=1 Î»rbrbT
r , where R, Î»r, br are the rank,
eigenvalues and eigenvectors, respectively. Applying Cauchy-
Schwarz inequality, we have
xT Xx =
R

r=1
Î»râˆ¥xT brâˆ¥2
2 â‰¤
R

r=1
Î»râˆ¥xâˆ¥2
2 = âˆ¥xâˆ¥2
2tr(X).
Since Rc can be written as (Vc + Ïƒ2
0,ceeT )âˆ’1, where e =
[1, . . . , 1]T , using the fact that
(X + xyT )âˆ’1 = Xâˆ’1 âˆ’Xâˆ’1xyT Xâˆ’1
1 + yT Xâˆ’1x ,
Fc can be rewritten as
Fc = tr((AT
c Râˆ’1
c Ac)âˆ’1)
= tr((AT
c Vâˆ’1
c Ac)âˆ’1) +
Ïƒ2
0,cuT
c (AT
c Vâˆ’1
c Ac)âˆ’2uc
1 + Ïƒ2
0,cuTc (ATc Vâˆ’1
c Ac)âˆ’1uc
,
(22)
where uc =
AT
c Vâˆ’1
c e
âˆš
1+
iâˆˆIc Ïƒ2
i,c .
For positive deï¬nite matrices (AT
c Vâˆ’1
c Ac)âˆ’1, Fc in (22) can
be viewed as a concave function of Ïƒ2
0,c with the derivative
with respect to Ïƒ2
0,c equals uT
c (AT
c Vâˆ’1
c Ac)âˆ’2uc at Ïƒ2
0,c = 0.
According to the ï¬rst-order Taylor expansion of Fc at Ïƒ2
0,c = 0,
we can get
0 â‰¤Fc âˆ’Fc â‰¤Ïƒ2
0,cuT
c (AT
c Vâˆ’1
c Ac)âˆ’2uc,
(23)
where Fc = tr((AT
c Vâˆ’1
c Ac)âˆ’1). According to the conclusion
tr(X2) â‰¤tr(X)2 for positive deï¬nite matrix X [36], we have
the following inequality
uT
c

AT
c Vâˆ’1
c Ac
âˆ’2 uc â‰¤âˆ¥ucâˆ¥2
2tr

AT
c Vâˆ’1
c Ac
âˆ’2
â‰¤âˆ¥ucâˆ¥2
2tr

AT
c Vâˆ’1
c Ac
âˆ’12
. (24)
Since ai,c represents the difference between two unit vectors
as shown in Fig. 2, we can get âˆ¥ai,câˆ¥2 < 2 and
âˆ¥ucâˆ¥2
2 â‰¤
1
1 + 
iâˆˆIc Ïƒ2
i,c

iâˆˆIc
1
Ïƒ4
i,c
tr

AcAT
c

â‰¤

iâˆˆIc
1
Ïƒ4
i,c

iâˆˆIc
1
v2 aT
i,cai,c
â‰¤
4I2
TDOA
mini Ïƒ4
i,cv2 .
(25)
By substituting (24) and (25) into (23), we can get
0 â‰¤Fc âˆ’Fc â‰¤4I2
TDOAÏƒ2
0,c
mini Ïƒ4
i,cv2 F 2
c ,
(26)
which indicates that when Ïƒ0,c is small enough,
Fc =
tr

(AT
c Vâˆ’1
c Ac)
âˆ’1
=tr
â›
â


iâˆˆIc
ai,caT
i,c
Ïƒ2
i,c
âˆ’1â
â can approximate Fc. â– 
Proposition 2 gives an approximation of UT positioning ac-
curacy and further reveals its intrinsic relationship with beam
scheduling result indicated by Ic that is the set of satellites
serving UT c. On the one hand, beam scheduling inï¬‚uences
inter-beam/inter-user interference and hence Ïƒ2
i,c via SINRi,c.
On the other hand, beam scheduling directly determines the
relative positions among UTs and satellites, which impacts
ai,c. Inspired by these observations, a low-complexity heuris-
tic beam scheduling algorithm is designed incorporating two
steps.
In the ï¬rst step, we focus on degrading inter-UT interference
to achieve higher SINRi,c, and the following metric Ïi,c is
deï¬ned to measure the similarity between hi,c and the elements
in {hi,câ€²}câ€²âˆˆCi, which is given by
Ïi,c =

câ€²âˆˆCiâˆªc
hT
i,chi,câ€²
hT
i,câ€²hi,câ€² .
(27)
Such metric is originally derived for ZF beamforming to ï¬nd
the users with minimum mutual interference [38].
In the second step, we consider the inï¬‚uence of beam schedul-
ingonFc viaai,c,andthemetricÎ¼i,c isdeï¬nedtocoarselyreï¬‚ect
the impact of ai,c on Fc as
Î¼i,c = tr
â›
â
 
iâ€²âˆˆIcâˆªi
aiâ€²,caT
iâ€²,c
âˆ’1â
â âˆ’tr
â›
â

iâ€²âˆˆIc
aiâ€²,caT
iâ€²,c
âˆ’1â
â 
=

r
1
Î»r

iâ€²âˆˆIcâˆªi aiâ€²,caT
iâ€²,c
âˆ’

r
1
Î»r

iâ€²âˆˆIc aiâ€²,caT
iâ€²,c
,
(28)
where Î»r(X) denotes the r-th eigenvalue of X. To reduce the
complexity of computing the eigenvalues in (28), we further
design a fast method for calculating Î¼i,c.
Suppose the eigenvalue decomposition of 
iâˆˆIc ai,caT
i,c is
R
r=1 Î»rbrbT
r , where R, Î»r, br are the rank, eigenvalues and
eigenvectors, respectively. Moreover, ai,c can be decomposed
into two orthogonal parts. The ï¬rst part is the projection onto
the subspace spanned by {br}R
r=1, which can be calculated as
R
r=1 aT
i,cbrbr. The second part is the remaining components
li, which can be expressed as
li = ai,c âˆ’
R

r=1
aT
i,cbrbr.
(29)
Hence, we can get

iâ€²âˆˆIcâˆªi
aiâ€²,caT
iâ€²,c = ai,caT
i,c +

iâ€²âˆˆIc
aiâ€²,caT
iâ€²,c
Authorized licensed use limited to: Tsinghua University. Downloaded on September 02,2024 at 10:51:33 UTC from IEEE Xplore.  Restrictions apply. 

XV et al.: JOINT BEAM SCHEDULING AND BEAMFORMING DESIGN FOR COOPERATIVE POSITIONING
5283
=
R

r=1
(Î»r + (aT
i,cbr)2)brbT
r + lilT
i .
(30)
Since li is orthogonal to the element in {br}R
r=1, we can get
the eigenvalue decomposition expression of 
iâ€²âˆˆIcâˆªi aiâ€²,caT
iâ€²,c
from (30), and then when adding satellite i to Ic, the expression
of rank, eigenvalue and eigenvectors of 
iâ€²âˆˆIc aiâ€²,caT
iâ€²,c are
updated as
R =

R,
if âˆ¥liâˆ¥2 = 0,
R + 1,
âˆ¥liâˆ¥2 Ì¸= 0,
(31a)
Î»r =

Î»r + (ai,cbr)2,
r = 1, . . . , R,
âˆ¥liâˆ¥2
2,
r = R + 1, if âˆ¥liâˆ¥2 Ì¸= 0,
(31b)
br =

br,
r = 1, . . . , R,
li/âˆ¥liâˆ¥2,
r = R + 1, if âˆ¥liâˆ¥2 Ì¸= 0.
(31c)
With the above easily calculated equations, (28) can be fast
computed with
Î¼i,c =

R

r=1
1
Î»r
âˆ’
R

r=1
1
Î»r
.
(32)
Based on the above metric, instead of ï¬nding the optimal
beam scheduling iteratively, we only need to ï¬nd a beam
scheduling plan that satisï¬es the constraints of (21) and provides
good channel orthogonality and UT-satellite-topology geome-
try. Speciï¬cally, we ï¬rst greedily select m candidate satellites
for each UT in each iteration according to the principle of
minimizing channel similarity Ïi,c. Then, with the principle of
maximizing Î¼i,c, a satellite is ï¬nally selected to provide service
for UT c. Finally, Ic and Ci are updated. The summary of the
proposed heuristic beam scheduling (HBS) algorithm is given in
Algorithm 2, whose complexity is O(C Â· ITDOA Â· I Â· K).
Overall, we design a low-complexity joint beamforming and
beam scheduling algorithm with the help of Proposition 1 and
Proposition 2, which essentially reveal the correlation of posi-
tioning performance with SINR and GDOP. Compared with the
genetic algorithms [39], HBS-DSTA need not feed the output
of the beamformer back to the scheduler with the complexity of
O(I Â· N 3.5 Â· K4.5 Â· T) + O(C Â· ITDOA Â· I Â· K).
V. SIMULATION RESULTS
This section presents simulation results to verify the perfor-
mance of the proposed DSTA-based beamforming and beam
scheduling algorithms. We choose three beamforming algo-
rithms for comparison as below.
r ZF based beamforming [40]: ZF beamforming eliminates
the co-channel interference (CCI) term in (2) caused
by frequency reuse among beams. Denoting the matrix
of channel by Hi = [hi,c1, . . . , hi,c|Ci|]H âˆˆC|Ci|Ã—N, the
beamforming weight matrix Wi of satellite i is calculated
by
Wi = Î²HH
i (HiHH
i )âˆ’1
(33)
Algorithm 2: HBS Algorithm.
Input: hi,c, si, sc, s0, âˆ€i âˆˆI, âˆ€c âˆˆC
Output: Î´i,c, âˆ€i âˆˆI, âˆ€c âˆˆC
1: Initialize
Î´i,c = 0, Ci = âˆ…, Ic = âˆ…, Ki = 0, âˆ€i âˆˆI, âˆ€c âˆˆC.
2: for UT c âˆˆC do
3:
while |Ic| < ITDOA do
4:
for satellite i âˆˆI do
5:
if Ki < K then
6:
Compute similarity Ïi,c according to (27).
7:
Compute R,Î»r, br according to (31).
8:
Compute Î¼i,c with the fast calculation method
according to (32).
9:
end if
10:
end for
11:
Select the set Iâˆ—of m candidate satellites with
smallest Ïi,c.
12:
Select the satellite iâˆ—to form the best UT-satellite
topology geometry with iâˆ—= arg max
iâˆˆIâˆ—Î¼i,c.
13:
Compute R,Î»r, br according to (31).
14:
Update R, Î»r, br with R,Î»r, br.
15:
Allocate a beam of satellite iâˆ—to UT c. Set Î´iâˆ—,c =
1, Ciâˆ—= Ciâˆ—âˆª{c}, Ic = Ic âˆª{iâˆ—}, Kiâˆ—= Kiâˆ—+ 1.
16:
end while
17: end for
with
Î² =

P|Ci|
âˆ¥(HH
i Hi)âˆ’1âˆ¥2
F
.
r Single-cell beamforming (SCB) [35]: In single-cell beam-
forming, wi,c is calculated by
wi,c =

P
âˆ¥hi,câˆ¥2
F
hi,c.
(34)
r Single-cell beamforming without interference (SCBWI):
For comparison, we consider an ideal scenario where
inter-beam interference is completely ignored and wi,c is
calculated the same as SCB. Since each UT SINR reaches
the theoretical maximum, individual positioning accuracy
is also the best, according to Proposition 1. Therefore, we
use it as the ideal upper bound of the positioning accuracy.
At this time, SINRi,c is reduced to SNRi,c that is calculated
by
SNRi,c = |hT
i,cwi,c|2
Ïµ2c
.
(35)
In the baseline schemes for beam scheduling, we have
compared the proposed HBS algorithm with the GDOP-based
scheduling scheme [41], the communication-oriented beam
scheduling scheme [38], and the parallax-based scheduling
scheme [42].
r GDOP-based scheduling: GDOP-based beam scheduling
has been widely used in Global Positioning System. In
Authorized licensed use limited to: Tsinghua University. Downloaded on September 02,2024 at 10:51:33 UTC from IEEE Xplore.  Restrictions apply. 

5284
IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 73, NO. 4, APRIL 2024
TABLE II
KEY SIMULATION PARAMETERS
GDOP-based scheduling, satellites are continuously and
greedily selected from I to minimize GDOP for UT c until
there areITDOA satellites providing service for UT c. GDOP
is calculated as
GDOPc = 1
v

tr((ATc Ac)âˆ’1).
(36)
Note that GDOPc can also be calculated by converting it
into the form with regard to the eigenvalues of Ac. With
the proposed method (31), GDOPc can be fast computed.
Meanwhile, the GDOP-based beam scheduling is a partic-
ular case of our proposed beam scheduling algorithm if we
set m = |I|.
r Communication-oriented scheduling: In communication-
oriented scheduling, satellites are continuously and greed-
ily selected from I to minimize Ïi,c until there are
ITDOA satellites providing service for UT c. Meanwhile,
communication-oriented scheduling is a special case of
HBS if we set m = 1.
r Parallax-based scheduling: We ï¬rst denote
Pc =
â¡
â¢â¢â¢â£
cos Ï†c
1,1
cos Ï†c
1,2
Â· Â· Â·
cos Ï†c
1,I
cos Ï†c
2,1
cos Ï†c
2,2
Â· Â· Â·
cos Ï†c
2,I
...
...
...
...
cos Ï†c
I,1
cos Ï†c
I,2
Â· Â· Â·
cos Ï†c
I,I
â¤
â¥â¥â¥â¦,
(37)
and cost function Ji = I
j=1 cos Ï†c
i,j, where Ï†c
i,j is the
parallax of UT c observed from satellite i and satellite j. In
parallax-based scheduling, we continuously delete satellite
i corresponding to max Ji and remove the row and column
elements of the matrix Pc corresponding to the removed
satellite until there are ITDOA satellites remaining.
Key simulation parameters are summarized in Table II, where
we set the number of satellites I visible to the ground user to
16, 21, 26 with the corresponding number of satellites/beams
serving each UT being 3, 4, 5.
A. The Effectiveness of DSTA-Based Beamforming
When ITDOA = 4, the cumulative distribution functions
(CDFs) of UT positioning accuracy under different beamform-
ing schemes are shown in Fig. 3, where the proposed HBS
is adopted with m = 4 for all the schemes. It can be found
Fig. 3.
CDFs of UT positioning accuracy under different beamforming
schemes when I = 21, ITDOA = 4, and P = 26 dBw.
TABLE III
AVERAGE UT POSITIONING ACCURACY WITH DSTA, SCBWI, ZF, AND SCB
BEAMFORMING SCHEMES UNDER DIFFERENT SYSTEM SETTINGS (M)
Fig. 4.
CDFs of UT SINR under different beamforming schemes when I =
21, ITDOA = 4, and P = 26 dBw.
that DSTA-based beamforming achieves higher positioning ac-
curacy than the other schemes employing positioning-oriented
beamforming. As shown in Table III, the average positioning
accuracyofDSTA-basedbeamformingisaround9.54minterms
of CRLB. It signiï¬cantly outperforms ZF and SCB by 11.9%
and 51.1%, respectively. In addition, the performance of our
proposed scheme is just within a small gap from the version of
SCBWI.
The CDFs of UT SINR under four beamforming schemes
are drawn in Fig. 4 to give more insight into the superior
Authorized licensed use limited to: Tsinghua University. Downloaded on September 02,2024 at 10:51:33 UTC from IEEE Xplore.  Restrictions apply. 

XV et al.: JOINT BEAM SCHEDULING AND BEAMFORMING DESIGN FOR COOPERATIVE POSITIONING
5285
Fig. 5.
CDFs of positioning accuracy with DSTA-based beamforming
under different satellite transmission power budgets when I = 21 and
ITDOA = 4.
performance of our proposal. Notably, it indicates a signiï¬cant
improvement brought by DSTA in SINR distribution compared
to ZF and SCB schemes, and there is only a 1â€“3 dB perfor-
mance loss compared to SCBWI. Meanwhile, the stepped curve
with DSTA-based beamforming is because we raise the SINR
threshold by ï¬xed value Î³0 each time.
B. The Impact of Beam Transmission Power Budget on the
Performance of DSTA-Based Beamforming
In Fig. 5, the performance of the DSTA-based beamforming
scheme is evaluated with ITDOA = 4 under various satellite
transmission power budgets. It can be found that the positioning
accuracy performance degrades when the available transmission
power decreases, which is possible because UT SINR becomes
lower at this time. Moreover, according to Table III, when the
transmission power budget decreases from 26 dBw to 20 dBw,
DSTA outperforms ZF more signiï¬cantly, which corresponds
to the positioning accuracy improvement by 11.9% to 17.1%.
The reason for such a performance difference is that interference
power is not the key that inï¬‚uences UT SINR and UT positioning
accuracy if beam transmission power gets lower.
C. The Impact of the Number of Visible Satellites on the
Performance of DSTA-Based Beamforming
The CDFs of UT positioning accuracy when ITDOA = 3, 4, 5
(I = 16, 21, 26) are shown in Fig. 6, and it can be found that
a more signiï¬cant number of visible satellites can contribute
to a considerable improvement in positioning performance. As
shown in Table III, when the number of satellites serving the
UT increases from 3 to 5, the positioning accuracy with DSTA
improves by 29.8%. This phenomenon is expected because
more good-quality signals can be measured, and better network
topology geometry can be obtained. To verify the performance
gain of our proposal, we list the accuracy performance under
different beamforming schemes and ITDOA in Table III.
Fig. 6.
CDFs of positioning accuracy with DSTA-based beamforming under
different numbers of visible satellites when P = 26 dBw.
Fig. 7.
CDFs of UT positioning accuracy under different beam scheduling
schemes when I = 21, ITDOA = 4, and P = 26 dBw.
TABLE IV
AVERAGE UT POSITIONING ACCURACY UNDER DIFFERENT BEAM
SCHEDULING SCHEMES WHEN I = 21, ITDOA = 4, AND P = 26 DBW. (M)
D. Performance Evaluation of the Proposed Heuristic Beam
Scheduling
To examine the performance of the proposed beam scheduling
scheme, Fig. 7 shows the CDFs of UT positioning accuracy
under GDOP-based beam scheduling and our proposal with
m = 1, 4, 12 and it can be found that the proposed scheme
outperforms GDOP-based beam scheduling, which is more sig-
niï¬cant when the parameter m is appropriately selected. More-
over, as shown in Table IV, the proposed HBS scheme always
results in substantial gains in positioning performance with
different beamforming schemes. Speciï¬cally, it outperforms
GDOP-based beam scheduling by 28.3%, 55.9%, and 53.2% in
Authorized licensed use limited to: Tsinghua University. Downloaded on September 02,2024 at 10:51:33 UTC from IEEE Xplore.  Restrictions apply. 

5286
IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 73, NO. 4, APRIL 2024
Fig. 8.
CDFs of SINR under different beam scheduling schemes when I = 21,
ITDOA = 4, and P = 26 dBw.
Fig. 9.
CDFs of UT GDOP under different beam scheduling schemes when
I = 21, ITDOA = 4, and P = 26 dBw.
average positioning accuracy with DSTA-based beamforming
for m = 1, 4, 12, respectively. The above results are because the
GDOP-based scheme only considers the UT-satellite topology
geometry. In contrast, the HBS scheme considers the impact
of geometric topology property and channel correlation among
UTs on positioning performance.
At last, to further reveal the intrinsic inï¬‚uence of parameter m
in the proposed HBS scheme, Figs. 8 and 9 show the CDFs of UT
SINR and GDOP under different m. In Fig. 8, it is demonstrated
that smaller m contributes to higher UT SINR, and HBS-DSTA
achieves the best UT SINR performance with m = 1. However,
this does not necessarily result in the positioning performance.
As m becomes smaller, as shown in Fig. 9, the GDOP value
increases rapidly due to the formation of improper UT-satellite
topology. Although the communication-oriented scheme ex-
hibitsbetterSINRandGDOP-basedandparallax-basedschemes
exhibit better GDOP, HBS has superior positioning perfor-
mance. These results reï¬‚ect there exists a trade-off between UT
SINR and GDOP value that can be adjusted by m.
VI. CONCLUSION
In this paper, positioning-oriented beam scheduling and
beamforming have been studied in multi-beam LEO satellite
networks. As user positioning performance suffers from se-
vere inter-beam interference and improper UT-satellite topology
geometry, based on the monotonic relationship between user
positioning accuracy and perceived SINR, we have designed a
dynamic SINR adjustment based beamforming algorithm with
SDR technique and also a fast heuristic beam scheduling algo-
rithm that takes channel correlation among users and satellite-
user topology geometric property into account. By simulation,
it has been shown that average user positioning accuracy can
be improved by 17.1% and 55.9%, compared to conventional
beamforming and beam scheduling schemes, respectively.
REFERENCES
[1] W. Jiang, B. Han, M. A. Habibi, and H. D. Schotten, â€œThe road towards
6G: A comprehensive survey,â€ IEEE Open J. Commun. Soc., vol. 2, no. 2,
pp. 334â€“366, Feb. 2021.
[2] Y. Sun, M. Peng, S. Zhang, G. Lin, and P. Zhang, â€œIntegrated satellite-
terrestrial networks: Architectures, key techniques, and experimental
progress,â€ IEEE Netw., vol. 36, no. 6, pp. 191â€“198, Nov./Dec. 2022.
[3] C. Ding, J.-B. Wang, M. Cheng, M. Lin, and J. Cheng, â€œDynamic trans-
mission and computation resource optimization for dense LEO satellite
assisted mobile-edge computing,â€ IEEE Trans. Commun., vol. 71, no. 5,
pp. 3087â€“3102, May 2023.
[4] T. Janssen, A. Koppert, R. Berkvens, and M. Weyn, â€œA survey on IoT
positioning leveraging LPWAN, GNSS, and LEO-PNT,â€ IEEE Internet
Things J., vol. 10, no. 13, pp. 11135â€“11159, Jul. 2023.
[5] G. Xu, F. Tan, Y. Ran, Y. Zhao, and J. Luo, â€œJoint beam-hopping schedul-
ing and coverage control in multibeam satellite systems,â€ IEEE Wirel.
Commun. Lett., vol. 12, no. 2, pp. 267â€“271, Feb. 2023.
[6] Y. Sun and M. Peng, â€œEdge intelligence assisted resource management
for satellite communication,â€ China Commun., vol. 19, no. 8, pp. 31â€“40,
Aug. 2022.
[7] Y. Sun and M. Peng, â€œLow earth orbit satellite communication sup-
porting direct connection with mobile phones: Key technologies, recent
progressandfuturedirections,â€Telecommun.Sci.,vol.39,no.2,pp. 25â€“36,
Jan. 2023.
[8] L. Chen, V. N. Ha, E. Lagunas, L. Wu, S. Chatzinotas, and B. Ottersten,
â€œThe next generation of beam hopping satellite systems: Dynamic beam
illumination with selective precoding,â€ IEEE Trans. Wireless Commun.,
vol. 22, no. 4, pp. 2666â€“2682, Apr. 2023.
[9] G. Cocco, T. d. Cola, M. Angelone, Z. Katona, and S. Erl, â€œRadio resource
management optimization of ï¬‚exible satellite payloads for DVB-S2 sys-
tems,â€ IEEE Trans. Broadcast., vol. 64, no. 2, pp. 266â€“280, Oct. 2018.
[10] X. Hu, Y. Zhang, X. Liao, Z. Liu, W. Wang, and F. M. Ghannouchi, â€œDy-
namic beam hopping method based on multi-objective deep reinforcement
learning for next generation satellite broadband systems,â€ IEEE Trans.
Broadcast., vol. 66, no. 3, pp. 630â€“646, Sep. 2020.
[11] C. Zhang, X. Zhao, and G. Zhang, â€œJoint precoding schemes for ï¬‚exible
resource allocation in high throughput satellite systems based on beam
hopping,â€ China Commun., vol. 18, no. 9, pp. 48â€“61, Sep. 2021.
[12] Z. Yin et al., â€œMulti-domain resource multiplexing based secure transmis-
sion for satellite-assisted IoT: AO-SCA approach,â€ IEEE Trans. Wireless
Commun., vol. 22, no. 11, pp. 7319â€“7330, Nov. 2023.
[13] Z. Yin, N. Cheng, T. H. Luan, Y. Hui, and W. Wang, â€œGreen interference
based symbiotic security in integrated satellite-terrestrial communica-
tions,â€ IEEE Trans. Wireless Commun., vol. 21, no. 11, pp. 9962â€“9973,
Nov. 2022.
[14] Z. Yin, N. Cheng, T. H. Luan, and P. Wang, â€œPhysical layer security in
cybertwin-enabled integrated satellite-terrestrial vehicle networks,â€ IEEE
Trans. Veh. Technol., vol. 71, no. 5, pp. 4561â€“4572, May 2022.
[15] C. D. Lima et al., â€œConvergent communication, sensing and localization in
6G systems: An overview of technologies, opportunities and challenges,â€
IEEE Access, vol. 9, pp. 26902â€“26925, 2021.
[16] C. Dai, G. Zheng, and Q. Chen, â€œSatellite constellation design with
multi-objective genetic algorithm for regional terrestrial satellite network,â€
China Commun., vol. 15, no. 8, pp. 1â€“10, Aug. 2018.
Authorized licensed use limited to: Tsinghua University. Downloaded on September 02,2024 at 10:51:33 UTC from IEEE Xplore.  Restrictions apply. 

XV et al.: JOINT BEAM SCHEDULING AND BEAMFORMING DESIGN FOR COOPERATIVE POSITIONING
5287
[17] Y. Nasser, H. Merhe, and M. HÃ©lard, â€œLocation aided carrier frequency
offset estimation for uplink OFDMA systems,â€ in Proc. IEEE 35th Sarnoff
Symp., 2012, pp. 1â€“6.
[18] E. Juan et al., â€œLocation-based handover triggering for low-Earth orbit
satellite networks,â€ in Proc. IEEE 95th Veh. Technol. Conf., 2022, pp. 1â€“6.
[19] K. C. Ho and Y. T. Chan, â€œSolution and performance analysis of geolo-
cation by TDOA,â€ IEEE Trans. Aerosp. Electron. Syst., vol. 29, no. 4,
pp. 1311â€“1322, Oct. 1993.
[20] D. J. Torrieri, â€œStatistical theory of passive location systems,â€ IEEE Trans.
Aerosp. Electron. Syst., vol. 20, no. 2, pp. 183â€“198, Mar. 1984.
[21] S. M. Kay, Fundamentals of Statistical Signal Processing: Estimation
Theory. Saddle River, NJ, USA: Prentice-Hall, Inc., 1993.
[22] I. Sharp, K. Yu, and Y. J. Guo, â€œGDOP analysis for positioning system de-
sign,â€ IEEE Trans. Veh. Technol., vol. 58, no. 7, pp. 3371â€“3382, Sep. 2009.
[23] R. K. Martin, C. Yan, H. H. Fan, and C. Rondeau, â€œAlgorithms and
bounds for distributed TDOA-based positioning using OFDM signals,â€
IEEE Trans. Signal Process., vol. 59, no. 3, pp. 1255â€“1268, Mar. 2011.
[24] C.-H. Park and J.-H. Chang, â€œClosed-form localization for distributed
MIMO radar systems using time delay measurements,â€ IEEE Trans.
Wireless Commun., vol. 15, no. 2, pp. 1480â€“1490, Feb. 2016.
[25] H. Miao, K. Yu, and M. J. Juntti, â€œPositioning for NLOS propagation: Al-
gorithm derivations and Cramerâ€“Rao bounds,â€ IEEE Trans. Veh. Technol.,
vol. 56, no. 5, pp. 2568â€“2580, Sep. 2007.
[26] S. Jeong, O. Simeone, A. Haimovich, and J. Kang, â€œBeamforming design
for joint localization and data transmission in distributed antenna system,â€
IEEE Trans. Veh. Technol., vol. 64, no. 1, pp. 62â€“76, Jan. 2015.
[27] H. Seo et al., â€œAccurate positioning using beamforming,â€ in Proc. IEEE
18th Annu. Consum. Commun. Netw. Conf., Las Vegas, NV, USA, 2021,
pp. 1â€“4.
[28] Y. Wang et al., â€œCooperative beam hopping for accurate positioning in
ultra-dense LEO satellite networks,â€ in Proc. IEEE Int. Conf. Commun.
Workshops, Montreal, QC, Canada, 2021, pp. 1â€“6.
[29] M. ËšA. VÃ¡zquez et al., â€œPrecoding in multibeam satellite communications:
Present and future challenges,â€ IEEE Wireless Commun., vol. 23, no. 6,
pp. 88â€“95, Dec. 2016.
[30] N. Letzepis and A. J. Grant, â€œCapacity of the multiple spot beam satellite
channel with Rician fading,â€ IEEE Trans. Inf. Theory, vol. 54, no. 11,
pp. 5210â€“5222, Nov. 2008.
[31] J. A. del Peral-Rosado et al., â€œAchievable localization accuracy of the
positioning reference signal of 3GPP LTE,â€ in Proc. Int. Conf. Localization
GNSS, Starnberg, Germany, 2012, pp. 1â€“6.
[32] D. Wang and M. Fattouche, â€œOFDM transmission for time-based range
estimation,â€ IEEE Signal Process. Lett., vol. 17, no. 6, pp. 571â€“574,
Jun. 2010.
[33] R. Kaune, J. HÃ¶rst, and W. Koch, â€œAccuracy analysis for TDOA local-
ization in sensor networks,â€ in Proc. 14th Int. Conf. Inf. Fusion, Chicago,
USA, 2011, pp. 1â€“8.
[34] R. Shaï¬n, L. Liu, Y. Li, Y. Li, A. Wang, and J. Zhang, â€œAngle and
delay estimation for 3-D massive MIMO/FD-MIMO systems based on
parametric channel modeling,â€ IEEE Trans. Wireless Commun., vol. 16,
no. 8, pp. 5370â€“5383, Aug. 2017.
[35] M. Sadek, A. Tarighat, and A. H. Sayed, â€œA leakage-based precoding
scheme for downlink multi-user MIMO channels,â€ IEEE Trans. Wireless
Commun., vol. 6, no. 5, pp. 1711â€“1721, May 2007.
[36] R. A. Horn and C. R. Johnson, Matrix Analysis. Cambridge, U.K.: Cam-
bridge Univ. Press, 2012.
[37] Z.-Q. Luo, W.-K. Ma, A. M. C. So, Y. Ye, and S. Zhang, â€œSemideï¬nite
relaxation of quadratic optimization problems,â€ IEEE Signal Process.
Mag., vol. 27, no. 3, pp. 20â€“34, May 2010.
[38] D. Christopoulos, S. Chatzinotas, and B. Ottersten, â€œMulticast multigroup
precoding and user scheduling for frame-based satellite communications,â€
IEEE Trans. Wireless Commun., vol. 14, no. 9, pp. 4695â€“4707, Sep. 2015.
[39] P. Kuendee and U. Janjarassuk, â€œA comparative study of mixed-integer
linear programming and genetic algorithms for solving binary problems,â€
in Proc. 5th Int. Conf. Ind. Eng. Appl., Singapore, 2018, pp. 284â€“288.
[40] Q. H. Spencer, A. L. Swindlehurst, and M. Haardt, â€œZero-forcing methods
for downlink spatial multiplexing in multiuser MIMO channels,â€ IEEE
Trans. Signal Process., vol. 52, no. 2, pp. 461â€“471, Feb. 2004.
[41] M. Zhang and J. Zhang, â€œA fast satellite selection algorithm: Beyond four
satellites,â€ IEEE J. Sel. Topics Signal Process., vol. 3, no. 5, pp. 740â€“747,
Oct. 2009.
[42] M. Wei, Z. Liu, C. Li, R. Yang, B. Li, and Q. Xu, â€œA combined satellite
selection algorithm,â€ in Proc. Int. Conf. Secur., Pattern Anal., Cybern.,
Jinan, China, 2018, pp. 477â€“480.
Hongtao Xv (Graduate Student Member, IEEE) re-
ceived the B.S. degree in information and commu-
nication engineering in 2022 from the Beijing Uni-
versity of Posts and Telecommunications (BUPT),
Beijing, Chinaâ€ where he is currently working toward
the Ph.D. degree with the State Key Laboratory of
Networking and Switching Technology, BUPT. His
research interests include LEO satellite communica-
tion and beamforming.
Yaohua Sun received the bachelorâ€™s degree (Hons.)
in telecommunications engineering (with manage-
ment) and the Ph.D. degree in communication en-
gineering from the Beijing University of Posts and
Telecommunications (BUPT), Beijing, China, in
2014 and 2019, respectively. He is currently an As-
sociate Professor with the School of Information
and Communication Engineering, BUPT. He has au-
thored or coauthored more than 30 papers, including
three ESI highly cited papers. His research interests
include intelligent radio access networks and LEO
satellite communication. He has been a Reviewer for IEEE TRANSACTIONS ON
COMMUNICATIONS, IEEE TRANSACTIONS ON MOBILE COMPUTING.
Yafei Zhao received the B.S., M.S., and Ph.D. de-
grees in aeronautical and astronautical science and
technology from the Harbin Institute of Technology,
Harbin, China, in 2010, 2012, and 2018, respec-
tively. He is currently an Associate Professor with
the Beijing University of Posts and Telecommunica-
tions, Beijing, China. His research interests include
integrated communication and navigation, integrated
satellite-terrestrial networks.
Mugen Peng (Fellow, IEEE) received the Ph.D. de-
gree in communication and information systems from
the Beijing University of Posts and Telecommunica-
tions, Beijing, China, in 2005. In 2014, he was an
Academic Visiting Fellow with Princeton University,
Princeton, NJ, USA. He joined BUPT, where he has
been the Dean of the School of Information and Com-
munication Engineering since 2020, and the Deputy
Director of the State Key Laboratory of Networking
and Switching Technology since 2018. He leads a
Research Group focusing on wireless transmission
and networking technologies with the State Key Laboratory of Networking
and Switching Technology, BUPT. His main research interests include wireless
communication theory, radio signal processing, cooperative communication,
self-organization networking, integrated sensing and communication, and Inter-
netofThings.Hewastherecipientofthe2018HeinrichHertzPrizePaperAward,
the 2014 IEEE ComSoc AP Outstanding Young Researcher Award, and the Best
Paper Award in IEEE ICC 2022, JCN 2016, and IEEE WCNC 2015. He is on
the Editorial or Associate Editorial Board of IEEE Communications Magazine,
IEEE NETWORK, IEEE INTERNET OF THINGS JOURNAL, IEEE TRANSACTIONS
ON VEHICULAR TECHNOLOGY, and IEEE TRANSACTIONS ON NETWORK SCI-
ENCE AND ENGINEERING.
Shijie Zhang received the B.S., M.S., and Ph.D.
degrees in spacecraft design from the Harbin Institute
of Technology, Harbin, China, in 2000, 2002, and
2005, respectively. He is currently the Chief Scien-
tist of the Yinhe Hangtian (Beijing) Communication
Technology Company, Ltd., and a Professor of the
State Key Laboratory of Media Convergence Produc-
tion Technology and Systems. His research interests
include satellite internet, aerospace communication,
spacecraft formation ï¬‚ying.
Authorized licensed use limited to: Tsinghua University. Downloaded on September 02,2024 at 10:51:33 UTC from IEEE Xplore.  Restrictions apply. 

