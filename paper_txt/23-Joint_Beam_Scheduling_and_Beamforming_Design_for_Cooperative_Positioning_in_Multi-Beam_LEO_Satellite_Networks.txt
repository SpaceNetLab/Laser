5276 IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 73, NO. 4, APRIL 2024 Joint Beam Scheduling and Beamforming Design for Cooperative Positioning in Multi-Beam LEO Satellite Networks Hongtao Xv , Graduate Student Member, IEEE, Yaohua Sun , Yafei Zhao , Mugen Peng , Fellow, IEEE, and Shijie Zhang

(LEO) satellites is promising in providing location-based services and enhancing satellite-terrestrial communication. However, positioning accuracy is greatly affected by inter-beam interference and satellite-terrestrial topology geometry. To select the best combination of satellites from visible ones and suppress inter-beam interference, this paper explores the utilization of ﬂexible beam scheduling and beamforming of multi-beam LEO satellites that can adjust beam directions toward the same earth-ﬁxed cell to send positioning signals simultaneously. By leveraging Cramér-Rao lower bound (CRLB) to characterize user Time Difference of Arrival (TDOA) positioning accuracy, the concerned problem is formulated, aiming at optimizing user positioning accuracy under beam scheduling and beam transmission power constraints. To deal with the mixed-integer-nonconvex problem, we decompose it into an inner beamforming design problem and an outer beam scheduling problem. For the former, we ﬁrst prove the monotonic relationship between user positioning accuracy and its perceived signal-tointerference-plus-noise ratio (SINR) to reformulate the problem, and then semideﬁnite relaxation (SDR) is adopted for beamforming design. For the outer problem, a heuristic low-complexity beam scheduling scheme is proposed, whose core idea is to schedule users with lower channel correlation to mitigate inter-beam interference while seeking a proper satellite-terrestrial topology geometry. Simproposed positioning-oriented beamforming and beam scheduling scheme, and it is shown that average user positioning accuracy is improved by 17.1% and 55.9% when the beam transmission power is 20 dBw, compared to conventional beamforming and beam scheduling schemes, respectively. Index Terms—Multi-beam low earth orbit (LEO) satellite, cooperative time difference of arrival (TDOA) positioning, positioning-oriented beamforming and beam scheduling. Manuscript received 1 February 2023; revised 27 June 2023 and 27 September 2023; accepted 1 November 2023. Date of publication 20 November 2023; date of current version 22 April 2024. This work was supported in part by the National Natural Science Foundation of China under Grants 62371071 and 62001053, and in part by the Young Elite Scientists Sponsorship Program by CAST under Grant 2021QNRC001. The review of this article was coordinated by Prof. Xianbin Wang. (Corresponding author: Yaohua Sun.) Hongtao Xv, Yaohua Sun, Yafei Zhao, and Mugen Peng are with the State Key Laboratory of Networking and Switching Technology, Beijing University of Posts and Telecommunications, Beijing 100876, China (email: htxu@bupt.edu.cn; sunyaohua@bupt.edu.cn; zhaoyafei@bupt.edu.cn; pmg@bupt.edu.cn). Shijie Zhang is with the Beijing University of Posts and Telecommunications and Yinhe Hangtian, Beijing Internet Technology Co., Ltd., Beijing 100876, China (e-mail: zsj@yinhe.ht). Digital Object Identiﬁer 10.1109/TVT.2023.3332142

ISLs. Otherwise, the gateway (GW), covering the cooperative LEO satellites simultaneously, is responsible for executing these

Each satellite is equipped with a uniform planar array (UPA) composed of N = NxNy antennas, where Nx and Ny are the numbers of antennas on the x and y axis, respectively, and it is assumed that each satellite can generate at most K beams. By sending positioning signals on time-frequency resource that is orthogonal to the resource used for normal communication services, multiple satellites can cooperatively provide UT positioning capability. There are multiple single-antenna UTs distributed in C earth-ﬁxed cells whose set is denoted by C = {1, 2, . . ., C}, and denote the set of LEO satellites visible to the cells by I = {1, 2, . . ., I}. Further, it is assumed that there is one UT in each cell for simplicity, and hence we use UT c to represent the UT located in cell c in the following. Deﬁne δi,c = 1 if satellite i schedules a beam to serve UT c, and δi,c = 0 otherwise. The set of satellites serving UT c and the set of UTs served by satellite i are denoted as Ic = {i|δi,c = 1} and Ci = {c|δi,c = 1}, respectively. The beamforming vector of satellite i for UT c is denoted as wi,c ∈CN×1 and the collection of all beamforming vectors is denoted as Wi ∈CN×|Ci|. Then, the discrete-time transmitted navigation signal of satellite i is therefore given by xi = Wini, where ni is the |Ci| × 1 symbol vector consisting of the navigation signal ni,c for UT c with E  ninH i  = I|Ci|. Suppose that proper frequency reuse is utilized among satellites so there is no inter-satellite interference. In contrast, intra-satellite interference exists due to full frequency reuse among beams of the same satellite. Therefore, the received signal of UT c from satellite i is given by yi,c = hT i,cwi,cni,c +  c′∈Ci,c′̸=c hT i,cwi,c′ni,c′ + ˆyi,c, (1) where hi,c ∈CN×1 is the channel vector between satellite i and UT c, and ˆyi,c ∼N  0, ϵ2 c  is white Gaussian noise. Then, the SINR of UT c when receiving the positioning signal from satellite i is given by SINRi,c = |hT i,cwi,c|2  c′∈Ci,c′̸=c |hT i,cwi,c′|2 + ϵ2c , i ∈Ic. (2) Considering the clock asynchronous problem, the signal from a reference satellite is used as the reference measurement for all UTs. With the knowledge of satellite positions acquired from the ephemeris, UTs use TDOA measurements for positioning. Speciﬁcally, UT c uses the signal from satellite i ∈Ic to estimate time of arrival (TOA) and calculates the time difference between TOAs of satellite i and the reference satellite. Then, UT c estimates its own position with the observation equations of TDOA. According to , , for UT c and satellite i, the CRLB of TOA measurement under an AWGN channel is calculated by σ2 i,c = 3 4π2B2SINRi,c , (3) where B is the bandwidth of satellite i’s beam . Denote the positions of UT c, satellites i and the reference satellite as sc = T , si = T and s0 = T , respectively. Then, the distance di,c between satellite i and UT c can be expressed as di,c = ∥sc −si∥2. (4) Thus, UT c can get TDOA measurements for satellite i and the reference satellite as TDOAi,c = 1 v (di,c −d0,c) + (TOAi,c −TOA0,c) = Gi,c(sc) + (TOAi,c −TOA0,c), (5) Authorized licensed use limited to: Tsinghua University. Downloaded on September 02,2024 at 10:51:33 UTC from IEEE Xplore.  Restrictions apply. XV et al.: JOINT BEAM SCHEDULING AND BEAMFORMING DESIGN FOR COOPERATIVE POSITIONING 5279 where v is the speed of light, Gi,c(sc) = 1 v(di,c(sc) −d0,c(sc)), TOAi,c and TOA0,c are the TOA measurement and TOAi,c ∼ N(0, σ2 i,c). As a result of the fact of a common reference satellite, TDOA measurements are correlated. Denote the indexes of satellites serving UT c as i1, i2, . . . , i|Ic|, the variance of TOAi1,c −TOA0,c is σ2 i1,c + σ2 0,c and TDOAc = T has a joint conditional Gaussian distribution with covariance matrix Rc given as Rc = ⎡ ⎢⎢⎢⎣ σ2 0,c + σ2 i1,c σ2 0,c · · · σ2 0,c σ2 0,c σ2 0,c + σ2 i2,c · · · σ2 0,c ... ... ... ... σ2 0,c σ2 0,c · · · σ2 0,c + σ2 i|Ic|,c ⎤ ⎥⎥⎥⎦. The measurement equation for the measurement vector TDOAc is given by TDOAc = Gc(sc) + uc, uc ∼N(0, Rc), (6) where Gc(sc) = T . The CRLB for TDOA positioning equals the inverse of the Fisher information J  as CRLBc = tr(J−1) = tr ⎛ ⎝ ∂Gc(sc) ∂sc T R−1 c ∂Gc(sc) ∂sc −1⎞ ⎠ = tr((AT c R−1 c Ac)−1). (7) Ac represents the Jacobian matrix of Gc with regard to sc, which is given by Ac = ∂Gc(sc) ∂sc = 1 v  ai1,c, . . . , ai|Ic|,c T , ai,c = sc−si di,c −a0,c, and a0,c = sc−s0 d0,c . The position error in meters for UT c is ﬁnally computed as √CRLBc . B. Channel Model Particularly, the free space path loss is considered to construct the channel model. According to , , , the channel vector from satellite i to UT c is modeled as hi,c =  Li,cejθi,cvi,c, (8) where θi,c is the phase vector with uniform distribution over T , using the fact that (X + xyT )−1 = X−1 −X−1xyT X−1 1 + yT X−1x , Fc can be rewritten as Fc = tr((AT c R−1 c Ac)−1) = tr((AT c V−1 c Ac)−1) + σ2 0,cuT c (AT c V−1 c Ac)−2uc 1 + σ2 0,cuTc (ATc V−1 c Ac)−1uc , (22) where uc = AT c V−1 c e √ 1+ i∈Ic σ2 i,c . For positive deﬁnite matrices (AT c V−1 c Ac)−1, Fc in (22) can be viewed as a concave function of σ2 0,c with the derivative with respect to σ2 0,c equals uT c (AT c V−1 c Ac)−2uc at σ2 0,c = 0. According to the ﬁrst-order Taylor expansion of Fc at σ2 0,c = 0, we can get 0 ≤Fc −Fc ≤σ2 0,cuT c (AT c V−1 c Ac)−2uc, (23) where Fc = tr((AT c V−1

mance of the proposed DSTA-based beamforming and beam scheduling algorithms. We choose three beamforming algorithms for comparison as below. r ZF based beamforming : ZF beamforming eliminates the co-channel interference (CCI) term in (2) caused by frequency reuse among beams. Denoting the matrix of channel by Hi = H ∈C|Ci|×N, the beamforming weight matrix Wi of satellite i is calculated by Wi = βHH i (HiHH i )−1 (33) Algorithm 2: HBS Algorithm. Input: hi,c, si, sc, s0, ∀i ∈I, ∀c ∈C Output: δi,c, ∀i ∈I, ∀c ∈C 1: Initialize δi,c = 0, Ci = ∅, Ic = ∅, Ki = 0, ∀i ∈I, ∀c ∈C. 2: for UT c ∈C do 3: while |Ic| < ITDOA do 4: for satellite i ∈I do 5: if Ki < K then 6: Compute similarity ρi,c according to (27). 7: Compute R,λr, br according to (31). 8:

Scheduling To examine the performance of the proposed beam scheduling scheme, Fig. 7 shows the CDFs of UT positioning accuracy under GDOP-based beam scheduling and our proposal with m = 1, 4, 12 and it can be found that the proposed scheme outperforms GDOP-based beam scheduling, which is more signiﬁcant when the parameter m is appropriately selected. Moreover, as shown in Table IV, the proposed HBS scheme always

different beamforming schemes. Speciﬁcally, it outperforms GDOP-based beam scheduling by 28.3%, 55.9%, and 53.2% in Authorized licensed use limited to: Tsinghua University. Downloaded on September 02,2024 at 10:51:33 UTC from IEEE Xplore.  Restrictions apply. 5286 IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 73, NO. 4, APRIL 2024 Fig. 8. CDFs of SINR under different beam scheduling schemes when I = 21, ITDOA = 4, and P = 26 dBw. Fig. 9. CDFs of UT GDOP under different beam scheduling schemes when I = 21, ITDOA = 4, and P = 26 dBw. average positioning accuracy with DSTA-based beamforming

GDOP-based scheme only considers the UT-satellite topology geometry. In contrast, the HBS scheme considers the impact of geometric topology property and channel correlation among UTs on positioning performance. At last, to further reveal the intrinsic inﬂuence of parameter m in the proposed HBS scheme, Figs. 8 and 9 show the CDFs of UT SINR and GDOP under different m. In Fig. 8, it is demonstrated that smaller m contributes to higher UT SINR, and HBS-DSTA achieves the best UT SINR performance with m = 1. However, this does not necessarily result in the positioning performance. As m becomes smaller, as shown in Fig. 9, the GDOP value increases rapidly due to the formation of improper UT-satellite topology. Although the communication-oriented scheme exhibitsbetterSINRandGDOP-basedandparallax-basedschemes exhibit better GDOP, HBS has superior positioning perforSINR and GDOP value that can be adjusted by m.

W ITH the evolution of small satellite platform manufacture and space launch technology, dense LEO satellite constellations will come into being, such as Starlink and OneWeb , . In such constellations, multiple LEO satellites can simultaneously cover a ground user, which facilitates providing more enhanced services, including satellite edge computing  and high precision user positioning . For the latter, multiple satellites can send positioning signals to the same user or cell to improve Geometric Dilution of Precision (GDOP), convergence speed, and pseudorange measurement accuracy, where cooperative satellite beam scheduling and beamforming design are the fundamental issues. Owing to the development of software-deﬁned payloads, satelliteonboardcommunicationresourcescanbescheduledand conﬁgured on demand. An LEO satellite can ﬂexibly adjust the serving relationship between beams and earth-ﬁxed cells , following a speciﬁc time-space transmission plan. Such ﬂexibility in beam scheduling enables a good match between limited network resources and heterogeneous service demands, thereby greatly enhancing system utility , . The design of beam scheduling usually involves binary variables, which makes the problem fall into the category of integer programming that is difﬁcult to solve. The authors of  made use of the SemiDeﬁnite Programming (SDP) technique and presented a heuristic algorithm to provide a solution rapidly. Aiming to achieve global optimal beam scheduling, the authors of  employed a

A. System Model The LEO satellite communication system scenario for cooperative UT positioning is shown in Fig. 1. To realize centralized control and coordinate satellites, if the reference satellite has powerful computing capability and connects to other satellites through inter-satellite links (ISLs), the positioning-oriented beam scheduling and beamforming algorithms are executed at

The positioning-oriented beam scheduling and beamforming design is formulated as the following problem, aiming to optimize UT TDOA positioning accuracy, which is given by P0 : min {wi,c},{δi,c} C  c=1 Fc (Rc ({wi,c}, {δi,c}) , Ac ({δi,c})) s.t. C1 : C  c=1 δi,c ≤K, ∀i ∈I, C2 :  i∈I δi,c = ITDOA, ∀c ∈C, C3 : δi,c ∈{0, 1}, ∀i ∈I, ∀c ∈C, C4 : ||wi,c||2 2 = P · δi,c, ∀i ∈I, ∀c ∈C, (11) where Fc = CRLBc. Constraint C1 states that each satellite can generate at most K beams simultaneously due to limited hardwarecapability.ConstraintC2 ensuresthateachUTreceives positioning signals from ITDOA beams from different satellites alongsidethereferencesatellite.ConstraintC3 meansδi,c isa0-1 indicator variable. Constraint C4 is the beam transmission power constraint, and wi,c is an all-zero column vector of dimension N when δi,c = 0. III. DYNAMIC UT SINR THRESHOLD ADJUSTMENT BASED SATELLITE BEAMFORMING In (11), we seek to ﬁnd beamforming design {wi,c} and beam scheduling plan {δi,c} that optimize user positioning accuracy. Unfortunately, ﬁnding a globally optimal solution in polynomial time is impossible due to the non-convex objective function and mixed-integer structure. To make the problem more tractable, in thissection,weﬁrstdealwithpositioning-orientedbeamforming under any pre-ﬁxed {δi,c}, and the corresponding problem is given as P1 : min {wi,c} C  c=1 Fc({wi,c}|{δi,c}) s.t. C4 : ||wi,c||2 2 = P · δi,c, ∀i ∈I, ∀c ∈C. (12) In the following proposition, we ﬁrst highlight the intrinsic relationship between UT’s positioning accuracy and UT’s perceived SINR from a single satellite to guide beamforming algorithm design. Proposition 1: Fc is monotonically decreasing with respect to SINRi,c with the gradient of Fc with respect to SINRi,c given Authorized licensed use limited to: Tsinghua University. Downloaded on September 02,2024 at 10:51:33 UTC from IEEE Xplore.  Restrictions apply. 5280 IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 73, NO. 4, APRIL 2024 Fig. 2. Spatial relationships among UT c and satellites. by ∂Fc ∂SINRi,c = −3tr(R−1 c (i, :)Ac(AT c R−1 c Ac)−2AT c R−1 c (:,i)) 4π2B2SINR2 i,c , (13) where satellite i is thei-th satellite in set Ic serving UT c, Ac is a column full rank matrix with probability one and Rc is positive deﬁnite. Proof: First, we leverage Fig. 2 to prove that Ac is a column full rank matrix with probability one when |Ic| = 3 by contradiction. As shown in Fig. 2, O, i0, i1, i2, i3 are the positions of UT c, the reference satellite and satellite i1, i2, i3. O0, O1, O2, O3 are the intersection points of line Oi0, Oi1, Oi2, Oi3 with the unit sphere whose center is O, respectively. The satellites are assumed to be distributed in sphere P1 following a twodimensional distribution with a probability density function. Since the column of AT c , ai,c = sc−si di,c −sc−s0 d0,c , represents the difference between the unit vectors pointing to satellite i and the reference satellite from UT, i.e. −−→ OOi −−−→ OO0, a1,c, a2,c and a3,c correspond to −−−→ O0O1, −−−→ O0O2 and −−−→ O0O3, respectively. If Ac is not a full rank matrix, a3,c can be represented as a linear combination of a1,c and a2,c, which means −−−→ O0O3 should lie in plane P2 which is spanned by −−−→ O0O1 and −−−→ O0O2. As −−→ OO3 is a unit vector, O3 should lie in circle L1, the intersecting curve of the unit sphere and plane P2. Further, as O3 is the intersection point of the line Oi3 with the unit sphere, we can conclude that the point i3 falls on circle L2, the projection of circle L1 onto sphere P1 on the basis of O. However, the probability that the point i3 falls onto circle L2 is zero because the probability equals the integration of a 2-dimensional probability density function over the 1-dimensional curve. Since a contradiction occurs, the assumption that Ac is not a full rank matrix does not hold. Similarly, we can select 3 linearly independent columns from AT c to prove that rank(Ac) = 3 when |I| > 3, which means Ac is a column full rank matrix. Next, we show that Rc is positive deﬁnite. Rc in (7) can be re-written as Rc = Uc + Vc as follows: Uc = ⎡ ⎢⎢⎢⎢⎣ σ2 0,c σ2 0,c · · · σ2 0,c σ2 0,c σ2 0,c · · · σ2 0,c ... ... ... ... σ2 0,c σ2 0,c · · · σ2 0,c ⎤ ⎥⎥⎥⎥⎦ and Vc = ⎡ ⎢⎢⎢⎢⎣ σ2 i1,c 0 · · · 0 0 σ2 i2,c · · · 0 ... ... ... ... 0 0 · · · σ2 i|Ic|,c ⎤ ⎥⎥⎥⎥⎦ . The eigenvalues of Uc and Vc equal σ2 0,c, 0, . . . , 0 and σ2 i1,c, σ2 i2,c, . . . , σ2 i|Ic|,c, respectively. Applying the RayleighRitz quotient result in , we can conclude that for any |I|-dimensional vector x, 0 ≤xHUcx xHx ≤σ2 0,c and mini σ2 i,c ≤ xHVcx xHx ≤maxi σ2 i,c. Thus, xH(Uc + Vc)x xHx ≥min i σ2 i,c > 0, which means Rc is positive deﬁnite. Further, to derive the closed-form expression of ∂Fc ∂SINRi,c , we deﬁne σ2 i,c = σ2 i,c + Δ2. Accordingly, Fc and Rc change to Fc and Rc, respectively. Denote vi = T as a vector where only thei-th component equals Δ and all the others are zero. Then, using the fact that (X + xyT )−1 = X−1 −X−1xyT X−1 1 + yT X−1x for any vector x, y ∈C|I|×1 and non-singular matrix X, the expression of Rc can be written as Rc = (Rc + vivT i )−1 = R−1 c −Δ2R−1 c (:,i)R−1 c (i, :) 1 + Δ2R−1 c (i,i) Δ2→0 ===== R−1 c −Δ2R−1 c (:,i)R−1 c (i, :). (14) By substituting (14) into (7), we have Fc = tr((AT c R−1 c Ac)−1) + Δ2tr(zT i,c(AT c R−1 c Ac)−2zi,c). (15) Then, ∂Fc ∂σ2 i,c = lim Δ2→0 Fc −Fc Δ2 = tr(zT i,c(AT R−1A)−2zi,c), (16) where zi,c = AT c R−1 c (:,i). By substituting (3) into (16) and applying the chain rule, we can get ∂Fc ∂SINRi,c = −3tr(zT i,c(AT c R−1 c Ac)−2zi,c) 4π2B2SINR2 i,c . (17) Since both Ac and AT c R−1 c (:,i) are column full rank matrices, R−1 c (i, :)Ac(AT c R−1 c Ac)−2AT c R−1 c (:,i) is also positive Authorized licensed use limited to: Tsinghua University. Downloaded on September 02,2024 at 10:51:33 UTC from IEEE Xplore.  Restrictions apply. XV et al.: JOINT BEAM SCHEDULING AND BEAMFORMING DESIGN FOR COOPERATIVE POSITIONING 5281 deﬁnite for positive deﬁnite matrix Rc , which means ∂Fc ∂SINRi,c < 0. ■ Proposition 1 reveals the monotonic relationship between UT SINR of receiving the signal sent by one beam and its positioning accuracy under a speciﬁc UT-satellite-topology, and it inspires us to gradually improve SINRi,c to enhance overall positioning performance. To this end, we deﬁne γi,c as the threshold for SINRi,c, i.e. γi,c ≤SINRi,c, and successively raise γi,c with equal step size. Speciﬁcally, we raise up γi,c for one UT based on the derived gradient (17) as γi,c = γi,c + γ0, c = arg min c′∈Ci ∂Fc′ ∂SINRi,c′ . (18) For each update, the following problem is solved to check whether the new {γi,c}c∈Ci is feasible. P2 : max t,{wi,c}c∈Ci t s.t. |hT i,cwi,c|2  c′̸=c |hT i,cwi,c′|2 + ϵ2c ≥t · γi,c, c ∈Ci, wH i,cwi,c = P, c ∈Ci, (19) If t∗≥1, it is feasible and we can continue to raise γi,c with (18), while t∗< 1 otherwise. Note that problem (19) can be well solved by SDR , by converting it into the following form: P3 : max t,{Qi,c}c∈Ci t s.t. 1 γi,c tr(H′T i,cQi,c)  c′̸=c tr(H′T i,cQi,c′) + ϵ2c ≥t, c ∈Ci, tr(Qi,c) = P, c ∈Ci, rank(Qi,c) = 1, c ∈Ci, (20) where H′i,c = hi,chH i,c, Qi,c = wi,cwH i,c, and the only nonconvex constraint rank(Qi,c) = 1 can be relaxed. In this way, problem (20) can be solved as a general convex optimization

IEEE Access, vol. 9, pp. 26902–26925, 2021. C. Dai, G. Zheng, and Q. Chen, “Satellite constellation design with multi-objective genetic algorithm for regional terrestrial satellite network,” China Commun., vol. 15, no. 8, pp. 1–10, Aug. 2018. Authorized licensed use limited to: Tsinghua University. Downloaded on September 02,2024 at 10:51:33 UTC from IEEE Xplore.  Restrictions apply. XV et al.: JOINT BEAM SCHEDULING AND BEAMFORMING DESIGN FOR COOPERATIVE POSITIONING 5287 Y. Nasser, H. Merhe, and M. Hélard, “Location aided carrier frequency offset estimation for uplink OFDMA systems,” in Proc. IEEE 35th Sarnoff Symp., 2012, pp. 1–6. E. Juan et al., “Location-based handover triggering for low-Earth orbit satellite networks,” in Proc. IEEE 95th Veh. Technol. Conf., 2022, pp. 1–6. K. C. Ho and Y. T. Chan, “Solution and performance analysis of geolocation by TDOA,” IEEE Trans. Aerosp. Electron. Syst., vol. 29, no. 4, pp. 1311–1322, Oct. 1993. D. J. Torrieri, “Statistical theory of passive location systems,” IEEE Trans. Aerosp. Electron. Syst., vol. 20, no. 2, pp. 183–198, Mar. 1984. S. M. Kay, Fundamentals of Statistical Signal Processing: Estimation Theory. Saddle River, NJ, USA: Prentice-Hall, Inc., 1993. I. Sharp, K. Yu, and Y. J. Guo, “GDOP analysis for positioning system design,” IEEE Trans. Veh. Technol., vol. 58, no. 7, pp. 3371–3382, Sep. 2009. R. K. Martin, C. Yan, H. H. Fan, and C. Rondeau, “Algorithms and bounds for distributed TDOA-based positioning using OFDM signals,” IEEE Trans. Signal Process., vol. 59, no. 3, pp. 1255–1268, Mar. 2011. C.-H. Park and J.-H. Chang, “Closed-form localization for distributed MIMO radar systems using time delay measurements,” IEEE Trans. Wireless Commun., vol. 15, no. 2, pp. 1480–1490, Feb. 2016. H. Miao, K. Yu, and M. J. Juntti, “Positioning for NLOS propagation: Algorithm derivations and Cramer–Rao bounds,” IEEE Trans. Veh. Technol., vol. 56, no. 5, pp. 2568–2580, Sep. 2007. S. Jeong, O. Simeone, A. Haimovich, and J. Kang, “Beamforming design for joint localization and data transmission in distributed antenna system,” IEEE Trans. Veh. Technol., vol. 64, no. 1, pp. 62–76, Jan. 2015. H. Seo et al., “Accurate positioning using beamforming,” in Proc. IEEE 18th Annu. Consum. Commun. Netw. Conf., Las Vegas, NV, USA, 2021, pp. 1–4. Y. Wang et al., “Cooperative beam hopping for accurate positioning in ultra-dense LEO satellite networks,” in Proc. IEEE Int. Conf. Commun. Workshops, Montreal, QC, Canada, 2021, pp. 1–6. M. ˚A. Vázquez et al., “Precoding in multibeam satellite communications: Present and future challenges,” IEEE Wireless Commun., vol. 23, no. 6, pp. 88–95, Dec. 2016. N. Letzepis and A. J. Grant, “Capacity of the multiple spot beam satellite channel with Rician fading,” IEEE Trans. Inf. Theory, vol. 54, no. 11, pp. 5210–5222, Nov. 2008. J. A. del Peral-Rosado et al., “Achievable localization accuracy of the positioning reference signal of 3GPP LTE,” in Proc. Int. Conf. Localization GNSS, Starnberg, Germany, 2012, pp. 1–6. D. Wang and M. Fattouche, “OFDM transmission for time-based range estimation,” IEEE Signal Process. Lett., vol. 17, no. 6, pp. 571–574, Jun. 2010. R. Kaune, J. Hörst, and W. Koch, “Accuracy analysis for TDOA localization in sensor networks,” in Proc. 14th Int. Conf. Inf. Fusion, Chicago, USA, 2011, pp. 1–8. R. Shaﬁn, L. Liu, Y. Li, Y. Li, A. Wang, and J. Zhang, “Angle and delay estimation for 3-D massive MIMO/FD-MIMO systems based on parametric channel modeling,” IEEE Trans. Wireless Commun., vol. 16, no. 8, pp. 5370–5383, Aug. 2017. M. Sadek, A. Tarighat, and A. H. Sayed, “A leakage-based precoding scheme for downlink multi-user MIMO channels,” IEEE Trans. Wireless Commun., vol. 6, no. 5, pp. 1711–1721, May 2007. R. A. Horn and C. R. Johnson, Matrix Analysis. Cambridge, U.K.: Cambridge Univ. Press, 2012. Z.-Q. Luo, W.-K. Ma, A. M. C. So, Y. Ye, and S. Zhang, “Semideﬁnite relaxation of quadratic optimization problems,” IEEE Signal Process. Mag., vol. 27, no. 3, pp. 20–34, May 2010. D. Christopoulos, S. Chatzinotas, and B. Ottersten, “Multicast multigroup precoding and user scheduling for frame-based satellite communications,” IEEE Trans. Wireless Commun., vol. 14, no. 9, pp. 4695–4707, Sep. 2015. P. Kuendee and U. Janjarassuk, “A comparative study of mixed-integer linear programming and genetic algorithms for solving binary problems,” in Proc. 5th Int. Conf. Ind. Eng. Appl., Singapore, 2018, pp. 284–288. Q. H. Spencer, A. L. Swindlehurst, and M. Haardt, “Zero-forcing methods for downlink spatial multiplexing in multiuser MIMO channels,” IEEE Trans. Signal Process., vol. 52, no. 2, pp. 461–471, Feb. 2004. M. Zhang and J. Zhang, “A fast satellite selection algorithm: Beyond four satellites,” IEEE J. Sel. Topics Signal Process., vol. 3, no. 5, pp. 740–747, Oct. 2009. M. Wei, Z. Liu, C. Li, R. Yang, B. Li, and Q. Xu, “A combined satellite selection algorithm,” in Proc. Int. Conf. Secur., Pattern Anal., Cybern., Jinan, China, 2018, pp. 477–480. Hongtao Xv (Graduate Student Member, IEEE) received the B.S. degree in information and communication engineering in 2022 from the Beijing University of Posts and Telecommunications (BUPT), Beijing, China„ where he is currently working toward the Ph.D. degree with the State Key Laboratory of Networking and Switching Technology, BUPT. His research interests include LEO satellite communication and beamforming. Yaohua Sun received the bachelor’s degree (Hons.) in telecommunications engineering (with management) and the Ph.D. degree in communication engineering from the Beijing University of Posts and Telecommunications (BUPT), Beijing, China, in 2014 and 2019, respectively. He is currently an Associate Professor with the School of Information and Communication Engineering, BUPT. He has authored or coauthored more than 30 papers, including three ESI highly cited papers. His research interests include intelligent radio access networks and LEO satellite communication. He has been a Reviewer for IEEE TRANSACTIONS ON COMMUNICATIONS, IEEE TRANSACTIONS ON MOBILE COMPUTING. Yafei Zhao received the B.S., M.S., and Ph.D. degrees in aeronautical and astronautical science and technology from the Harbin Institute of Technology, Harbin, China, in 2010, 2012, and 2018, respectively. He is currently an Associate Professor with the Beijing University of Posts and Telecommunications, Beijing, China. His research interests include integrated communication and navigation, integrated satellite-terrestrial networks. Mugen Peng (Fellow, IEEE) received the Ph.D. degree in communication and information systems from the Beijing University of Posts and Telecommunications, Beijing, China, in 2005. In 2014, he was an Academic Visiting Fellow with Princeton University, Princeton, NJ, USA. He joined BUPT, where he has been the Dean of the School of Information and Communication Engineering since 2020, and the Deputy Director of the State Key Laboratory of Networking and Switching Technology since 2018. He leads a Research Group focusing on wireless transmission and networking technologies with the State Key Laboratory of Networking and Switching Technology, BUPT. His main research interests include wireless communication theory, radio signal processing, cooperative communication, self-organization networking, integrated sensing and communication, and InternetofThings.Hewastherecipientofthe2018HeinrichHertzPrizePaperAward, the 2014 IEEE ComSoc AP Outstanding Young Researcher Award, and the Best Paper Award in IEEE ICC 2022, JCN 2016, and IEEE WCNC 2015. He is on the Editorial or Associate Editorial Board of IEEE Communications Magazine, IEEE NETWORK, IEEE INTERNET OF THINGS JOURNAL, IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, and IEEE TRANSACTIONS ON NETWORK SCIENCE AND ENGINEERING. Shijie Zhang received the B.S., M.S., and Ph.D. degrees in spacecraft design from the Harbin Institute of Technology, Harbin, China, in 2000, 2002, and 2005, respectively. He is currently the Chief Scientist of the Yinhe Hangtian (Beijing) Communication Technology Company, Ltd., and a Professor of the State Key Laboratory of Media Convergence Production Technology and Systems. His research interests include satellite internet, aerospace communication, spacecraft formation ﬂying. Authorized licensed use limited to: Tsinghua University. Downloaded on September 02,2024 at 10:51:33 UTC from IEEE Xplore.  Restrictions apply.

complexity. Considering the unknown dynamics of the satellite communication environment, a model-free deep reinforcement

scheduling plan . However, these previous works ignore the potential co-frequency interference among beams. To further reduce the inter-beam interference, literature  provided a novel

to suppress inter-beam interference. The authors in , , adopted SDR to reformulate the co-channel interference suppression problem and conducted successive convex approximation (SCA) to optimize the beamformer. In a similar vein, the authors in  adopted Lyapunov optimization theory to solve the problems of binary association and beamforming to 0018-9545 © 2023 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See https://www.ieee.org/publications/rights/index.html for more information. Authorized licensed use limited to: Tsinghua University. Downloaded on September 02,2024 at 10:51:33 UTC from IEEE Xplore.  Restrictions apply. XV et al.: JOINT BEAM SCHEDULING AND BEAMFORMING DESIGN FOR COOPERATIVE POSITIONING 5277 maximize the data rate. Moreover, literature  jointly considered beam scheduling design and Zero Forcing (ZF) beamforming under per feed power constraint at the satellite. The above works on satellite beam scheduling and beamforming mainly focus on satisfying user communication demands. However, multi-beam LEO satellite systems need to take advantage of positioning and provide positioning information services in the future . Compared with GNSS, which relies on satellites mainly operating in medium earth orbits, the free space loss with LEO satellites is much lower. The received power on the ground can be improved by more than 30 dB under the same transmission power , which makes it easier for us to capture and track positioning signals. Apart from providing location-based services, position information is also essential for enhancing communication services. In the physical layer, positioning information can be used for improving carrier frequency offset estimation in uplink orthogonal frequency division multiple access systems . In the networking layer, a user terminal (UT) can leverage its position information to trigger a handover procedure between satellites actively .

ference of arrival (TDOA) technique . In this paradigm, a UT calculates the difference between the times at which the signals of a pair of satellites arrive at the UT. For each pair of satellites, TDOA provides a hyperbolic map plot of possible UT positions . Each additional satellite pair provides another intersecting hyperbola, further reﬁning the UT position. To assess TDOA performance , , , , , the metric for benchmarking any unbiased estimators, CRLB, is generally used. There has been some research on optimizing TDOA positioning performance by beamforming and beam scheduling in terrestrial and satellite networks. The authors of  optimized beamforming vectors at base stations (BSs) to minimize the power expenditure under data rate and positioning accuracy constraints, where multiple BSs with multiple antennas communicate with multiple single-antenna UTs. Literature

as well as increase the accuracy of TDOA positioning by using beamforming at BSs. In LEO satellite systems, the authors of  investigated the beam scheduling problem and designed a novel beam hopping framework to optimize positioning performance. Overall,thejointdesignofbeamformingandbeamscheduling for positioning in multi-beam LEO satellite systems still needs to be explored, which is technically challenging for several reasons. First, with the number of visible satellites increasing, it becomes intractable to quickly select serving satellites for UTs/cells to maximize positioning accuracy. Second, considering full frequency reuse (FFR) among satellite beams , , inter-beam interference becomes critical, and the radio ranging measurement accuracy can signiﬁcantly degrade as SINR gets lower. Third, mitigating inter-beam interference also imposes higherrequirementsonbeamschedulingdesign,andmeanwhile, proper satellite-terrestrial topology geometry should also be formed by beam schedule. Our main contributions are summarized as follows. TABLE I

can incur high complexity, which is undesirable for practiSuppose the eigenvalue decomposition of  i∈Ic ai,caT i,c is R r=1 λrbrbT r , where R, λr, br are the rank, eigenvalues and eigenvectors, respectively. Moreover, ai,c can be decomposed into two orthogonal parts. The ﬁrst part is the projection onto the subspace spanned by {br}R r=1, which can be calculated as R r=1 aT i,cbrbr. The second part is the remaining components li, which can be expressed as li = ai,c − R  r=1 aT i,cbrbr. (29) Hence, we can get  i′∈Ic∪i ai′,caT i′,c = ai,caT i,c +  i′∈Ic ai′,caT i′,c Authorized licensed use limited to: Tsinghua University. Downloaded on September 02,2024 at 10:51:33 UTC from IEEE Xplore.  Restrictions apply. XV et al.: JOINT BEAM SCHEDULING AND BEAMFORMING DESIGN FOR COOPERATIVE POSITIONING 5283 = R  r=1 (λr + (aT i,cbr)2)brbT r + lilT i . (30) Since li is orthogonal to the element in {br}R r=1, we can get the eigenvalue decomposition expression of  i′∈Ic∪i ai′,caT i′,c from (30), and then when adding satellite i to Ic, the expression of rank, eigenvalue and eigenvectors of  i′∈Ic ai′,caT i′,c are updated as R =

R, if ∥li∥2 = 0, R + 1, ∥li∥2 ̸= 0, (31a) λr =

λr + (ai,cbr)2, r = 1, . . . , R, ∥li∥2 2, r = R + 1, if ∥li∥2 ̸= 0, (31b) br =

br, r = 1, . . . , R, li/∥li∥2, r = R + 1, if ∥li∥2 ̸= 0. (31c) With the above easily calculated equations, (28) can be fast computed with μi,c =

R  r=1 1 λr − R  r=1 1 λr . (32) Based on the above metric, instead of ﬁnding the optimal beam scheduling iteratively, we only need to ﬁnd a beam scheduling plan that satisﬁes the constraints of (21) and provides good channel orthogonality and UT-satellite-topology geometry. Speciﬁcally, we ﬁrst greedily select m candidate satellites for each UT in each iteration according to the principle of minimizing channel similarity ρi,c. Then, with the principle of maximizing μi,c, a satellite is ﬁnally selected to provide service

according to (32). 9: end if 10: end for 11: Select the set I∗of m candidate satellites with smallest ρi,c. 12: Select the satellite i∗to form the best UT-satellite topology geometry with i∗= arg max i∈I∗μi,c. 13: Compute R,λr, br according to (31). 14: Update R, λr, br with R,λr, br. 15: Allocate a beam of satellite i∗to UT c. Set δi∗,c = 1, Ci∗= Ci∗∪{c}, Ic = Ic ∪{i∗}, Ki∗= Ki∗+ 1. 16: end while 17: end for with β =

P|Ci| ∥(HH i Hi)−1∥2 F . r Single-cell beamforming (SCB) : In single-cell beamforming, wi,c is calculated by wi,c =

P ∥hi,c∥2 F hi,c. (34) r Single-cell beamforming without interference (SCBWI): For comparison, we consider an ideal scenario where inter-beam interference is completely ignored and wi,c is calculated the same as SCB. Since each UT SINR reaches the theoretical maximum, individual positioning accuracy is also the best, according to Proposition 1. Therefore, we use it as the ideal upper bound of the positioning accuracy. At this time, SINRi,c is reduced to SNRi,c that is calculated by SNRi,c = |hT i,cwi,c|2 ϵ2c . (35) In the baseline schemes for beam scheduling, we have compared the proposed HBS algorithm with the GDOP-based scheduling scheme , the communication-oriented beam scheduling scheme , and the parallax-based scheduling scheme . r GDOP-based scheduling: GDOP-based beam scheduling has been widely used in Global Positioning System. In Authorized licensed use limited to: Tsinghua University. Downloaded on September 02,2024 at 10:51:33 UTC from IEEE Xplore.  Restrictions apply. 5284 IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 73, NO. 4, APRIL 2024 TABLE II KEY SIMULATION PARAMETERS GDOP-based scheduling, satellites are continuously and greedily selected from I to minimize GDOP for UT c until there areITDOA satellites providing service for UT c. GDOP is calculated as GDOPc = 1 v

tr((ATc Ac)−1). (36) Note that GDOPc can also be calculated by converting it into the form with regard to the eigenvalues of Ac. With

Meanwhile, the GDOP-based beam scheduling is a particular case of our proposed beam scheduling algorithm if we set m = |I|. r Communication-oriented scheduling: In communicationoriented scheduling, satellites are continuously and greedily selected from I to minimize ρi,c until there are ITDOA satellites providing service for UT c. Meanwhile, communication-oriented scheduling is a special case of HBS if we set m = 1. r Parallax-based scheduling: We ﬁrst denote Pc = ⎡ ⎢⎢⎢⎣ cos φc 1,1 cos φc 1,2 · · · cos φc 1,I cos φc 2,1 cos φc 2,2 · · · cos φc 2,I ... ... ... ... cos φc I,1 cos φc I,2 · · · cos φc I,I ⎤ ⎥⎥⎥⎦, (37) and cost function Ji = I j=1 cos φc i,j, where φc i,j is the parallax of UT c observed from satellite i and satellite j. In parallax-based scheduling, we continuously delete satellite i corresponding to max Ji and remove the row and column elements of the matrix Pc corresponding to the removed satellite until there are ITDOA satellites remaining. Key simulation parameters are summarized in Table II, where we set the number of satellites I visible to the ground user to 16, 21, 26 with the corresponding number of satellites/beams serving each UT being 3, 4, 5. A. The Effectiveness of DSTA-Based Beamforming When ITDOA = 4, the cumulative distribution functions (CDFs) of UT positioning accuracy under different beamforming schemes are shown in Fig. 3, where the proposed HBS is adopted with m = 4 for all the schemes. It can be found Fig. 3. CDFs of UT positioning accuracy under different beamforming schemes when I = 21, ITDOA = 4, and P = 26 dBw. TABLE III AVERAGE UT POSITIONING ACCURACY WITH DSTA, SCBWI, ZF, AND SCB BEAMFORMING SCHEMES UNDER DIFFERENT SYSTEM SETTINGS (M) Fig. 4. CDFs of UT SINR under different beamforming schemes when I = 21, ITDOA = 4, and P = 26 dBw. that DSTA-based beamforming achieves higher positioning accuracy than the other schemes employing positioning-oriented beamforming. As shown in Table III, the average positioning accuracyofDSTA-basedbeamformingisaround9.54minterms of CRLB. It signiﬁcantly outperforms ZF and SCB by 11.9% and 51.1%, respectively. In addition, the performance of our proposed scheme is just within a small gap from the version of SCBWI. The CDFs of UT SINR under four beamforming schemes are drawn in Fig. 4 to give more insight into the superior Authorized licensed use limited to: Tsinghua University. Downloaded on September 02,2024 at 10:51:33 UTC from IEEE Xplore.  Restrictions apply. XV et al.: JOINT BEAM SCHEDULING AND BEAMFORMING DESIGN FOR COOPERATIVE POSITIONING 5285 Fig. 5. CDFs of positioning accuracy with DSTA-based beamforming under different satellite transmission power budgets when I = 21 and ITDOA = 4. performance of our proposal. Notably, it indicates a signiﬁcant improvement brought by DSTA in SINR distribution compared to ZF and SCB schemes, and there is only a 1–3 dB performance loss compared to SCBWI. Meanwhile, the stepped curve with DSTA-based beamforming is because we raise the SINR threshold by ﬁxed value γ0 each time. B. The Impact of Beam Transmission Power Budget on the Performance of DSTA-Based Beamforming In Fig. 5, the performance of the DSTA-based beamforming scheme is evaluated with ITDOA = 4 under various satellite transmission power budgets. It can be found that the positioning accuracy performance degrades when the available transmission power decreases, which is possible because UT SINR becomes lower at this time. Moreover, according to Table III, when the transmission power budget decreases from 26 dBw to 20 dBw, DSTA outperforms ZF more signiﬁcantly, which corresponds to the positioning accuracy improvement by 11.9% to 17.1%. The reason for such a performance difference is that interference power is not the key that inﬂuences UT SINR and UT positioning accuracy if beam transmission power gets lower. C. The Impact of the Number of Visible Satellites on the Performance of DSTA-Based Beamforming The CDFs of UT positioning accuracy when ITDOA = 3, 4, 5 (I = 16, 21, 26) are shown in Fig. 6, and it can be found that a more signiﬁcant number of visible satellites can contribute to a considerable improvement in positioning performance. As shown in Table III, when the number of satellites serving the UT increases from 3 to 5, the positioning accuracy with DSTA improves by 29.8%. This phenomenon is expected because more good-quality signals can be measured, and better network topology geometry can be obtained. To verify the performance gain of our proposal, we list the accuracy performance under different beamforming schemes and ITDOA in Table III. Fig. 6. CDFs of positioning accuracy with DSTA-based beamforming under different numbers of visible satellites when P = 26 dBw. Fig. 7. CDFs of UT positioning accuracy under different beam scheduling schemes when I = 21, ITDOA = 4, and P = 26 dBw. TABLE IV AVERAGE UT POSITIONING ACCURACY UNDER DIFFERENT BEAM SCHEDULING SCHEMES WHEN I = 21, ITDOA = 4, AND P = 26 DBW. (M)

learning for next generation satellite broadband systems,” IEEE Trans. Broadcast., vol. 66, no. 3, pp. 630–646, Sep. 2020. C. Zhang, X. Zhao, and G. Zhang, “Joint precoding schemes for ﬂexible resource allocation in high throughput satellite systems based on beam hopping,” China Commun., vol. 18, no. 9, pp. 48–61, Sep. 2021. Z. Yin et al., “Multi-domain resource multiplexing based secure transmisCommun., vol. 22, no. 11, pp. 7319–7330, Nov. 2023. Z. Yin, N. Cheng, T. H. Luan, Y. Hui, and W. Wang, “Green interference based symbiotic security in integrated satellite-terrestrial communications,” IEEE Trans. Wireless Commun., vol. 21, no. 11, pp. 9962–9973, Nov. 2022. Z. Yin, N. Cheng, T. H. Luan, and P. Wang, “Physical layer security in cybertwin-enabled integrated satellite-terrestrial vehicle networks,” IEEE Trans. Veh. Technol., vol. 71, no. 5, pp. 4561–4572, May 2022. C. D. Lima et al., “Convergent communication, sensing and localization in

r A novel multi-beam LEO satellite network scenario for cooperative UT positioning is considered, where each satellite can generate multiple beams using a planar antenna array, and each UT can receive positioning signals sent by beams from numerous satellites. Using CRLB to characterize the TDOA positioning accuracy of a single UT, we formulate the problem of joint satellite beam scheduling and beamforming design, aiming at optimizing UT positioning accuracy under per-beam transmission power constraint and the constraint on the number of serving beams for each UT. r To deal with the non-convex mixed-integer problem, it is decomposed into an inner beamforming design problem and an outer beam scheduling problem. For the former, we proposeaUTSINRthresholdadjustment basedbeamforming algorithm with the SDR technique, which is inspired by the monotonic relationship between the positioning accuracy of a single UT and its perceived SINR. For the latter, a fast and efﬁcient greedy heuristic beam scheduling algorithm that changes the value of a 0-1 variable from 0 to 1 in each round of iteration is developed, considering the trade-off between channel correlation and UT-satellite topology geometry. r Extensive numerical evaluations are carried out, where our proposal is compared with conventional beamforming and GDOP-based beam scheduling schemes under different beam transmission powers and the numbers of visible satellites. It is shown that average user positioning accuracy can be improved by 17.1% and 55.9%, respectively. The remainder of the paper is organized as follows. Section II presents the system model and the concerned positioning accuracy optimization problem. Section III details the design of the beamforming algorithm. In Section IV, the beam scheduling

are summarized in Table I. We use the following notation throughout this paper: X is a matrix; x is a vector; x is a scalar; X(:, j) is the j-th column Authorized licensed use limited to: Tsinghua University. Downloaded on September 02,2024 at 10:51:33 UTC from IEEE Xplore.  Restrictions apply. 5278 IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 73, NO. 4, APRIL 2024 Fig. 1. Multi-beam LEO satellite system scenario for cooperative UT positioning. of X; X(i, j) is the element in the i-th row and j-th column of X; The transpose and conjugate transpose of X are represented by XT and XH, respectively; IN is the N × N identity matrix; rank(X) denotes the rank of X; X−1 is the inverse of X; λi(X) denotes the i-th eigenvalue of X; tr(X) indicates the trace of X; ||x||2 is 2-norm of x; Cm×n denotes an m by n dimensional complex space; Kronecker product is denoted by ⊗; E is the expectation operator; ∂f ∂x is used to denote the partial derivative of function f with respect to x.

tr(X2) ≤tr(X)2 for positive deﬁnite matrix X , we have the following inequality uT c  AT c V−1 c Ac −2 uc ≤∥uc∥2 2tr  AT c V−1 c Ac −2 ≤∥uc∥2 2tr  AT c V−1 c Ac −12 . (24) Since ai,c represents the difference between two unit vectors as shown in Fig. 2, we can get ∥ai,c∥2 < 2 and ∥uc∥2 2 ≤ 1 1 +  i∈Ic σ2 i,c  i∈Ic 1 σ4 i,c tr  AcAT c  ≤  i∈Ic 1 σ4 i,c  i∈Ic 1 v2 aT i,cai,c ≤ 4I2 TDOA mini σ4 i,cv2 . (25) By substituting (24) and (25) into (23), we can get 0 ≤Fc −Fc ≤4I2 TDOAσ2 0,c mini σ4 i,cv2 F 2 c , (26) which indicates that when σ0,c is small enough, Fc = tr

(AT c V−1 c Ac) −1 =tr ⎛ ⎝   i∈Ic ai,caT i,c σ2 i,c −1⎞ ⎠can approximate Fc. ■ Proposition 2 gives an approximation of UT positioning accuracy and further reveals its intrinsic relationship with beam scheduling result indicated by Ic that is the set of satellites serving UT c. On the one hand, beam scheduling inﬂuences inter-beam/inter-user interference and hence σ2 i,c via SINRi,c. On the other hand, beam scheduling directly determines the relative positions among UTs and satellites, which impacts ai,c. Inspired by these observations, a low-complexity heuristic beam scheduling algorithm is designed incorporating two steps. In the ﬁrst step, we focus on degrading inter-UT interference to achieve higher SINRi,c, and the following metric ρi,c is deﬁned to measure the similarity between hi,c and the elements in {hi,c′}c′∈Ci, which is given by ρi,c =  c′∈Ci∪c hT i,chi,c′ hT i,c′hi,c′ . (27) Such metric is originally derived for ZF beamforming to ﬁnd the users with minimum mutual interference . In the second step, we consider the inﬂuence of beam schedulingonFc viaai,c,andthemetricμi,c isdeﬁnedtocoarselyreﬂect the impact of ai,c on Fc as μi,c = tr ⎛ ⎝   i′∈Ic∪i ai′,caT i′,c −1⎞ ⎠−tr ⎛ ⎝  i′∈Ic ai′,caT i′,c −1⎞ ⎠ =  r 1 λr  i′∈Ic∪i ai′,caT i′,c −  r 1 λr  i′∈Ic ai′,caT i′,c , (28) where λr(X) denotes the r-th eigenvalue of X. To reduce the complexity of computing the eigenvalues in (28), we further

proposed heuristic beam scheduling (HBS) algorithm is given in Algorithm 2, whose complexity is O(C · ITDOA · I · K). Overall, we design a low-complexity joint beamforming and beam scheduling algorithm with the help of Proposition 1 and Proposition 2, which essentially reveal the correlation of positioning performance with SINR and GDOP. Compared with the genetic algorithms , HBS-DSTA need not feed the output of the beamformer back to the scheduler with the complexity of O(I · N 3.5 · K4.5 · T) + O(C · ITDOA · I · K).

In this paper, positioning-oriented beam scheduling and beamforming have been studied in multi-beam LEO satellite networks. As user positioning performance suffers from severe inter-beam interference and improper UT-satellite topology geometry, based on the monotonic relationship between user positioning accuracy and perceived SINR, we have designed a dynamic SINR adjustment based beamforming algorithm with SDR technique and also a fast heuristic beam scheduling algorithm that takes channel correlation among users and satelliteuser topology geometric property into account. By simulation, it has been shown that average user positioning accuracy can be improved by 17.1% and 55.9%, compared to conventional beamforming and beam scheduling schemes, respectively.

W. Jiang, B. Han, M. A. Habibi, and H. D. Schotten, “The road towards 6G: A comprehensive survey,” IEEE Open J. Commun. Soc., vol. 2, no. 2, pp. 334–366, Feb. 2021. Y. Sun, M. Peng, S. Zhang, G. Lin, and P. Zhang, “Integrated satelliteterrestrial networks: Architectures, key techniques, and experimental progress,” IEEE Netw., vol. 36, no. 6, pp. 191–198, Nov./Dec. 2022. C. Ding, J.-B. Wang, M. Cheng, M. Lin, and J. Cheng, “Dynamic transmission and computation resource optimization for dense LEO satellite assisted mobile-edge computing,” IEEE Trans. Commun., vol. 71, no. 5, pp. 3087–3102, May 2023. T. Janssen, A. Koppert, R. Berkvens, and M. Weyn, “A survey on IoT positioning leveraging LPWAN, GNSS, and LEO-PNT,” IEEE Internet Things J., vol. 10, no. 13, pp. 11135–11159, Jul. 2023. G. Xu, F. Tan, Y. Ran, Y. Zhao, and J. Luo, “Joint beam-hopping scheduling and coverage control in multibeam satellite systems,” IEEE Wirel. Commun. Lett., vol. 12, no. 2, pp. 267–271, Feb. 2023. Y. Sun and M. Peng, “Edge intelligence assisted resource management for satellite communication,” China Commun., vol. 19, no. 8, pp. 31–40, Aug. 2022. Y. Sun and M. Peng, “Low earth orbit satellite communication supporting direct connection with mobile phones: Key technologies, recent progressandfuturedirections,”Telecommun.Sci.,vol.39,no.2,pp. 25–36, Jan. 2023. L. Chen, V. N. Ha, E. Lagunas, L. Wu, S. Chatzinotas, and B. Ottersten, “The next generation of beam hopping satellite systems: Dynamic beam illumination with selective precoding,” IEEE Trans. Wireless Commun., vol. 22, no. 4, pp. 2666–2682, Apr. 2023. G. Cocco, T. d. Cola, M. Angelone, Z. Katona, and S. Erl, “Radio resource management optimization of ﬂexible satellite payloads for DVB-S2 systems,” IEEE Trans. Broadcast., vol. 64, no. 2, pp. 266–280, Oct. 2018. X. Hu, Y. Zhang, X. Liao, Z. Liu, W. Wang, and F. M. Ghannouchi, “Dy